jQuery(document).ready(function(s){var t,n=!1,c=5,a=5,i=s("#awp_resend_otp_btn"),r=s("#awp_resend_timer"),l=s("#billing_phone_field"),p=s("#awp_otp_popup"),u=s("#user_phone_number"),o=s("form.woocommerce-checkout"),d=s(".otp-input");s("#verification_message");function _(){r.text(" ("+c+"s)")}function f(e,o){var o=o?"custom-message-success":"custom-message-error",t=l.next(".woocommerce-message.custom-message"),t=(0===t.length&&(t=s('<div class="woocommerce-message custom-message"></div>'),l.after(t)),t.removeClass("custom-message-success custom-message-error").addClass(o).text(e).show(),p.find(".awp-popup-message"));0===t.length&&(t=s('<div class="awp-popup-message"></div>'),p.find(".awp-otp-content").prepend(t)),t.removeClass("custom-message-success custom-message-error").addClass(o).text(e).show()}async function m(e,o){try{(await s.post({url:otpAjax.ajaxurl,data:{action:"send_otp",phone_number:e,first_name:o,security:otpAjax.nonce}})).success?(console.log("OTP sent successfully"),f(awp_translations.otp_sent_success,!0),p.show(),n=!0,i.prop("disabled",!0),_(),t=setInterval(function(){c--,_(),c<=0&&(clearInterval(t),i.prop("disabled",!1),r.text(""),c=a)},1e3)):(console.log("Failed to send OTP"),f(awp_translations.otp_sent_failure,!1))}catch(e){console.log("Error in sending OTP",e),f(awp_translations.otp_sent_failure,!1)}}async function h(){var e="";d.each(function(){e+=s(this).val()});try{(await s.post({url:otpAjax.ajaxurl,dataType:"json",data:{action:"verify_otp",otp:e,security:otpAjax.nonce}})).success?(console.log("OTP verified successfully"),f(awp_translations.otp_verified_success,!0),p.hide(),o.submit()):(console.log("Incorrect OTP"),f(awp_translations.otp_incorrect,!1))}catch(e){console.log("Error in verifying OTP",e),f(awp_translations.otp_incorrect,!1)}}function e(){d.val("").prop("disabled",!0).css({"background-color":"#cacaca",border:"#cacaca"}),d.first().prop("disabled",!1).css("background-color","white")}s(document).on("click","#place_order",async function(e){var o;!n&&p.is(":hidden")&&(e.preventDefault(),e=s("#billing_phone").val(),o=s("#billing_first_name").val(),u.text(e),m(e,o),p.show(),d.first().focus())}),s(document).on("click",".awp-otp-popup-close",function(){p.hide(),n=!1,e()}),d.on("input",function(){s(this).val().length===this.maxLength&&s(this).next(".otp-input").prop("disabled",!1).css("background-color","white").focus(),d.each(function(){""===s(this).val()?s(this).css({"background-color":"#cacaca",border:"#cacaca"}):s(this).css({"background-color":"white",border:"1px solid #ccc"})}),0===d.filter(function(){return""===s(this).val()}).length&&h()}),d.on("keydown",function(e){"Backspace"===e.key&&0===s(this).val().length&&s(this).prev(".otp-input").focus()}),d.on("paste",function(e){var o=e.originalEvent.clipboardData.getData("text");d.each(function(e){s(this).val(o[e]||"")}),0===d.filter(function(){return""===s(this).val()}).length&&h()}),s(document).on("click","#awp_verify_otp_btn",h),s(document).on("click","#awp_resend_otp_btn",function(){m(s("#billing_phone").val(),s("#billing_first_name").val()),c+=5,_()}),s(document).on("click","#awp_edit_phone_btn",function(){p.hide(),n=!1,s("#billing_phone").focus()}),e()});
//# sourceMappingURL=../maps/automation-web-platform/checkout-325-beta-8.min.js.map
