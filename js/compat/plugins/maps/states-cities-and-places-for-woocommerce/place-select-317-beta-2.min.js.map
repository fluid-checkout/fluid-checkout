{"version":3,"file":"../../states-cities-and-places-for-woocommerce/place-select-317-beta-2.min.js","sources":["states-cities-and-places-for-woocommerce/place-select-317-beta-2.js"],"sourcesContent":["jQuery( function($) {\r\n\r\n  // wc_city_select_params is required to continue, ensure the object exists\r\n  // wc_country_select_params is used for select2 texts. This one is added by WC\r\n  if ( typeof wc_country_select_params === 'undefined' || typeof wc_city_select_params === 'undefined' ) {\r\n    return false;\r\n  }\r\n\r\n  function getEnhancedSelectFormatString() {\r\n    var formatString = {\r\n      formatMatches: function( matches ) {\r\n        if ( 1 === matches ) {\r\n          return wc_country_select_params.i18n_matches_1;\r\n        }\r\n\r\n        return wc_country_select_params.i18n_matches_n.replace( '%qty%', matches );\r\n      },\r\n      formatNoMatches: function() {\r\n        return wc_country_select_params.i18n_no_matches;\r\n      },\r\n      formatAjaxError: function() {\r\n        return wc_country_select_params.i18n_ajax_error;\r\n      },\r\n      formatInputTooShort: function( input, min ) {\r\n        var number = min - input.length;\r\n\r\n        if ( 1 === number ) {\r\n          return wc_country_select_params.i18n_input_too_short_1;\r\n        }\r\n\r\n        return wc_country_select_params.i18n_input_too_short_n.replace( '%qty%', number );\r\n      },\r\n      formatInputTooLong: function( input, max ) {\r\n        var number = input.length - max;\r\n\r\n        if ( 1 === number ) {\r\n          return wc_country_select_params.i18n_input_too_long_1;\r\n        }\r\n\r\n        return wc_country_select_params.i18n_input_too_long_n.replace( '%qty%', number );\r\n      },\r\n      formatSelectionTooBig: function( limit ) {\r\n        if ( 1 === limit ) {\r\n          return wc_country_select_params.i18n_selection_too_long_1;\r\n        }\r\n\r\n        return wc_country_select_params.i18n_selection_too_long_n.replace( '%qty%', limit );\r\n      },\r\n      formatLoadMore: function() {\r\n        return wc_country_select_params.i18n_load_more;\r\n      },\r\n      formatSearching: function() {\r\n        return wc_country_select_params.i18n_searching;\r\n      }\r\n    };\r\n\r\n    return formatString;\r\n  }\r\n\r\n  // Select2 Enhancement if it exists\r\n  if ( $().select2 ) {\r\n    var wc_city_select_select2 = function() {\r\n      $( 'select.city_select:visible' ).each( function() {\r\n        var select2_args = $.extend({\r\n          placeholderOption: 'first',\r\n          width: '100%'\r\n        }, getEnhancedSelectFormatString() );\r\n\r\n        $( this ).select2( select2_args );\r\n      });\r\n    };\r\n\r\n    wc_city_select_select2();\r\n\r\n    $( document.body ).bind( 'city_to_select', function() {\r\n      wc_city_select_select2();\r\n    });\r\n\r\n    // CHANGE: Trigger city field update on `updated_checkout` event\r\n    $( document.body ).bind( 'updated_checkout', wc_city_select_select2 );\r\n  }\r\n\r\n  /* City select boxes */\r\n  var cities_json = wc_city_select_params.cities.replace( /&quot;/g, '\"' );\r\n  var cities = $.parseJSON( cities_json );\r\n\r\n  $( 'body' ).on( 'country_to_state_changing', function(e, country, $container) {\r\n    // CHANGE: Add selector for fields without a section prefix\r\n    var $statebox = $container.find( '#billing_state, #shipping_state, #calc_shipping_state, #state' );\r\n    var state = $statebox.val();\r\n    $( document.body ).trigger( 'state_changing', [country, state, $container ] );\r\n  });\r\n\r\n  // CHANGE: Add selector for fields without a section prefix, and add the event object as a parameter\r\n  $( 'body' ).on( 'change', 'select.state_select, #calc_shipping_state, #state', function( e ) {\r\n    // CHANGE: Trigger change event after a delay to ensure the field is updated\r\n    requestAnimationFrame( function() {\r\n      var $field = $( e.target );\r\n\r\n      // CHANGE: Use address group selector instead of `div` to find the fields container element\r\n      var $container = $field.closest( '.woocommerce-shipping-fields, .woocommerce-billing-fields, .woocommerce-address-fields' );\r\n      \r\n      // CHANGE: Add selector for fields without a section prefix\r\n      var country = $container.find( '#billing_country, #shipping_country, #calc_shipping_country, #country' ).val();\r\n      var state = $field.val();\r\n      \r\n      \r\n      $( document.body ).trigger( 'state_changing', [country, state, $container ] );\r\n    } );\r\n  });\r\n\r\n  $( 'body' ).on( 'state_changing', function(e, country, state, $container) {\r\n    // CHANGE: Add selector for fields without a section prefix\r\n    var $citybox = $container.find( '#billing_city, #shipping_city, #calc_shipping_city, #city' );\r\n\r\n    // CHANGE: Set class `state_to_city` to the state field\r\n    var $statebox = $container.find( '#billing_state, #shipping_state, #calc_shipping_state, #state' );\r\n    $statebox.addClass( 'state_to_city' );\r\n\r\n    // CHANGE: Maybe destroy TomSelect fields before replacing options\r\n    if ( $citybox.length > 0 && $citybox[ 0 ].tomselect ) {\r\n      $citybox[ 0 ].tomselect.destroy();\r\n    }\r\n\r\n    if ( cities[ country ] ) {\r\n      /* if the country has no states */\r\n      if( cities[country] instanceof Array) {\r\n        cityToSelect( $citybox, cities[ country ] );\r\n      } else if ( state ) {\r\n        if ( cities[ country ][ state ] ) {\r\n          cityToSelect( $citybox, cities[ country ][ state ] );\r\n        } else {\r\n          cityToInput( $citybox );\r\n        }\r\n      } else {\r\n        // CHANGE: Convert field to input for better presentation when no state is selected\r\n        cityToInput( $citybox );\r\n\r\n        disableCity( $citybox );\r\n      }\r\n    } else {\r\n      cityToInput( $citybox );\r\n    }\r\n  });\r\n\r\n  /* Ajax replaces .cart_totals (child of .cart-collaterals) on shipping calculator */\r\n  if ( $( '.cart-collaterals' ).length && $( '#calc_shipping_state' ).length ) {\r\n    var calc_observer = new MutationObserver( function() {\r\n      $( '#calc_shipping_state' ).change();\r\n    });\r\n    calc_observer.observe( document.querySelector( '.cart-collaterals' ), { childList: true });\r\n  }\r\n\r\n  function cityToInput( $citybox ) {\r\n    if ( $citybox.is('input') ) {\r\n      $citybox.prop( 'disabled', false );\r\n      return;\r\n    }\r\n\r\n    var input_name = $citybox.attr( 'name' );\r\n    var input_id = $citybox.attr( 'id' );\r\n    var placeholder = $citybox.attr( 'placeholder' );\r\n\r\n    $citybox.parent().find( '.select2-container' ).remove();\r\n\r\n    $citybox.replaceWith( '<input type=\"text\" class=\"input-text\" name=\"' + input_name + '\" id=\"' + input_id + '\" placeholder=\"' + placeholder + '\" />' );\r\n\r\n    // CHANGE: Clear validation status if Fluid Checkout checkout validation script is available\r\n    if ( window.CheckoutValidation && $citybox.length > 0 ) {\r\n      CheckoutValidation.clearValidationResults( $citybox[ 0 ], $citybox[ 0 ].closest( '.form-row' ) );\r\n    }\r\n  }\r\n\r\n  function disableCity( $citybox ) {\r\n    $citybox.val( '' ).change();\r\n    $citybox.prop( 'disabled', true );\r\n\r\n    // CHANGE: Clear validation status if Fluid Checkout checkout validation script is available\r\n    if ( window.CheckoutValidation ) {\r\n      CheckoutValidation.clearValidationResults( $citybox[ 0 ], $citybox[ 0 ].closest( '.form-row' ) );\r\n    }\r\n  }\r\n\r\n  function cityToSelect( $citybox, current_cities ) {\r\n    var value = $citybox.val();\r\n\r\n    if ( $citybox.is('input') ) {\r\n      var input_name = $citybox.attr( 'name' );\r\n      var input_id = $citybox.attr( 'id' );\r\n      var placeholder = $citybox.attr( 'placeholder' );\r\n\r\n      $citybox.replaceWith( '<select name=\"' + input_name + '\" id=\"' + input_id + '\" class=\"city_select\" placeholder=\"' + placeholder + '\"></select>' );\r\n      //we have to assign the new object, because of replaceWith\r\n      $citybox = $('#'+input_id);\r\n    } else {\r\n      $citybox.prop( 'disabled', false );\r\n    }\r\n\r\n    var options = '';\r\n    for( var index in current_cities ) {\r\n      if ( current_cities.hasOwnProperty( index ) ) {\r\n        var cityName = current_cities[ index ];\r\n        options = options + '<option value=\"' + cityName + '\">' + cityName + '</option>';\r\n      }\r\n    }\r\n\r\n    $citybox.html( '<option value=\"\">' + wc_city_select_params.i18n_select_city_text + '</option>' + options );\r\n\r\n    if ( $('option[value=\"'+value+'\"]', $citybox).length ) {\r\n      $citybox.val( value ).change();\r\n    } else {\r\n      $citybox.val( '' ).change();\r\n    }\r\n\r\n    // CHANGE: Clear validation status if Fluid Checkout checkout validation script is available\r\n    if ( window.CheckoutValidation && ( ! value || ! $('option[value=\"'+value+'\"]', $citybox).length ) ) {\r\n      CheckoutValidation.clearValidationResults( $citybox[ 0 ], $citybox[ 0 ].closest( '.form-row' ) );\r\n    }\r\n\r\n    $( document.body ).trigger( 'city_to_select' );\r\n  }\r\n});\r\n"],"names":["jQuery","$","wc_country_select_params","wc_city_select_params","select2","wc_city_select_select2","each","select2_args","extend","placeholderOption","width","formatMatches","matches","i18n_matches_1","i18n_matches_n","replace","formatNoMatches","i18n_no_matches","formatAjaxError","i18n_ajax_error","formatInputTooShort","input","min","number","length","i18n_input_too_short_1","i18n_input_too_short_n","formatInputTooLong","max","i18n_input_too_long_1","i18n_input_too_long_n","formatSelectionTooBig","limit","i18n_selection_too_long_1","i18n_selection_too_long_n","formatLoadMore","i18n_load_more","formatSearching","i18n_searching","this","document","body","bind","cities_json","cities","parseJSON","cityToInput","$citybox","input_name","input_id","placeholder","is","prop","attr","parent","find","remove","replaceWith","window","CheckoutValidation","clearValidationResults","closest","cityToSelect","current_cities","index","cityName","value","val","options","hasOwnProperty","html","i18n_select_city_text","change","trigger","on","e","country","$container","state","requestAnimationFrame","$field","target","addClass","tomselect","destroy","Array","MutationObserver","observe","querySelector","childList"],"mappings":"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"}