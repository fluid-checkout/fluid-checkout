{"version":3,"file":"../../states-cities-and-places-for-woocommerce/place-select-318.min.js","sources":["states-cities-and-places-for-woocommerce/place-select-318.js"],"sourcesContent":["jQuery( function($) {\r\n\r\n  // wc_city_select_params is required to continue, ensure the object exists\r\n  // wc_country_select_params is used for select2 texts. This one is added by WC\r\n  if ( typeof wc_country_select_params === 'undefined' || typeof wc_city_select_params === 'undefined' ) {\r\n    return false;\r\n  }\r\n\r\n  function getEnhancedSelectFormatString() {\r\n    var formatString = {\r\n      formatMatches: function( matches ) {\r\n        if ( 1 === matches ) {\r\n          return wc_country_select_params.i18n_matches_1;\r\n        }\r\n\r\n        return wc_country_select_params.i18n_matches_n.replace( '%qty%', matches );\r\n      },\r\n      formatNoMatches: function() {\r\n        return wc_country_select_params.i18n_no_matches;\r\n      },\r\n      formatAjaxError: function() {\r\n        return wc_country_select_params.i18n_ajax_error;\r\n      },\r\n      formatInputTooShort: function( input, min ) {\r\n        var number = min - input.length;\r\n\r\n        if ( 1 === number ) {\r\n          return wc_country_select_params.i18n_input_too_short_1;\r\n        }\r\n\r\n        return wc_country_select_params.i18n_input_too_short_n.replace( '%qty%', number );\r\n      },\r\n      formatInputTooLong: function( input, max ) {\r\n        var number = input.length - max;\r\n\r\n        if ( 1 === number ) {\r\n          return wc_country_select_params.i18n_input_too_long_1;\r\n        }\r\n\r\n        return wc_country_select_params.i18n_input_too_long_n.replace( '%qty%', number );\r\n      },\r\n      formatSelectionTooBig: function( limit ) {\r\n        if ( 1 === limit ) {\r\n          return wc_country_select_params.i18n_selection_too_long_1;\r\n        }\r\n\r\n        return wc_country_select_params.i18n_selection_too_long_n.replace( '%qty%', limit );\r\n      },\r\n      formatLoadMore: function() {\r\n        return wc_country_select_params.i18n_load_more;\r\n      },\r\n      formatSearching: function() {\r\n        return wc_country_select_params.i18n_searching;\r\n      }\r\n    };\r\n\r\n    return formatString;\r\n  }\r\n\r\n  // Select2 Enhancement if it exists\r\n  if ( $().select2 ) {\r\n    var wc_city_select_select2 = function() {\r\n      $( 'select.city_select:visible' ).each( function() {\r\n        var select2_args = $.extend({\r\n          placeholderOption: 'first',\r\n          width: '100%'\r\n        }, getEnhancedSelectFormatString() );\r\n\r\n        $( this ).select2( select2_args );\r\n      });\r\n    };\r\n\r\n    wc_city_select_select2();\r\n\r\n    $( document.body ).bind( 'city_to_select', function() {\r\n      wc_city_select_select2();\r\n    });\r\n\r\n    // CHANGE: Trigger city field update on `updated_checkout` event\r\n    $( document.body ).bind( 'updated_checkout', wc_city_select_select2 );\r\n  }\r\n\r\n  /* City select boxes */\r\n  var cities_json = wc_city_select_params.cities.replace( /&quot;/g, '\"' );\r\n  var cities = $.parseJSON( cities_json );\r\n\r\n  $( 'body' ).on( 'country_to_state_changing', function(e, country, $container) {\r\n    // CHANGE: Add selector for fields without a section prefix\r\n    var $statebox = $container.find( '#billing_state, #shipping_state, #calc_shipping_state, #state' );\r\n    var state = $statebox.val();\r\n    $( document.body ).trigger( 'state_changing', [country, state, $container ] );\r\n  });\r\n\r\n  // CHANGE: Add selector for fields without a section prefix, and add the event object as a parameter\r\n  $( 'body' ).on( 'change', 'select.state_select, #calc_shipping_state, #state', function( e ) {\r\n    // CHANGE: Run after a delay to ensure fields are updated\r\n    requestAnimationFrame( function() {\r\n      var $field = $( e.target );\r\n\r\n      // CHANGE: Use address group selector instead of `div` to find the fields container element\r\n      var $container = $field.closest( '.woocommerce-shipping-fields, .woocommerce-billing-fields, .woocommerce-address-fields' );\r\n      \r\n      // CHANGE: Add selector for fields without a section prefix\r\n      var country = $container.find( '#billing_country, #shipping_country, #calc_shipping_country, #country' ).val();\r\n      var state = $field.val();\r\n      \r\n      \r\n      $( document.body ).trigger( 'state_changing', [country, state, $container ] );\r\n    } );\r\n  });\r\n\r\n  // CHANGE: Add `state_to_city` class to the state field when updating checkout fragments\r\n  var add_state_to_city_class = function() {\r\n    var $state_fields = $( '#billing_state, #shipping_state, #calc_shipping_state, #state' );\r\n    $state_fields.addClass( 'state_to_city' );\r\n  };\r\n  $( document.body ).on( 'updated_checkout', add_state_to_city_class );\r\n\r\n  $( 'body' ).on( 'state_changing', function(e, country, state, $container) {\r\n    // CHANGE: Add selector for fields without a section prefix\r\n    var $citybox = $container.find( '#billing_city, #shipping_city, #calc_shipping_city, #city' );\r\n\r\n    // CHANGE: Set class `state_to_city` to the state field\r\n    var $statebox = $container.find( '#billing_state, #shipping_state, #calc_shipping_state, #state' );\r\n    $statebox.addClass( 'state_to_city' );\r\n\r\n    // CHANGE: Maybe destroy TomSelect fields before replacing options\r\n    if ( $citybox.length > 0 && $citybox[ 0 ].tomselect ) {\r\n      $citybox[ 0 ].tomselect.destroy();\r\n    }\r\n\r\n    if ( cities[ country ] ) {\r\n      /* if the country has no states */\r\n      if( cities[country] instanceof Array) {\r\n        cityToSelect( $citybox, cities[ country ] );\r\n      } else if ( state ) {\r\n        if ( cities[ country ][ state ] ) {\r\n          cityToSelect( $citybox, cities[ country ][ state ] );\r\n        } else {\r\n          cityToInput( $citybox );\r\n        }\r\n      } else {\r\n        // CHANGE: Convert field to input for better presentation when no state is selected\r\n        cityToInput( $citybox );\r\n\r\n        disableCity( $citybox );\r\n      }\r\n    } else {\r\n      cityToInput( $citybox );\r\n    }\r\n  });\r\n\r\n  /* Ajax replaces .cart_totals (child of .cart-collaterals) on shipping calculator */\r\n  if ( $( '.cart-collaterals' ).length && $( '#calc_shipping_state' ).length ) {\r\n    var calc_observer = new MutationObserver( function() {\r\n      $( '#calc_shipping_state' ).change();\r\n    });\r\n    calc_observer.observe( document.querySelector( '.cart-collaterals' ), { childList: true });\r\n  }\r\n\r\n  function cityToInput( $citybox ) {\r\n    if ( $citybox.is('input') ) {\r\n      $citybox.prop( 'disabled', false );\r\n      return;\r\n    }\r\n\r\n    var input_name = $citybox.attr( 'name' );\r\n    var input_id = $citybox.attr( 'id' );\r\n    var placeholder = $citybox.attr( 'placeholder' );\r\n\r\n    $citybox.parent().find( '.select2-container' ).remove();\r\n\r\n    $citybox.replaceWith( '<input type=\"text\" class=\"input-text\" name=\"' + input_name + '\" id=\"' + input_id + '\" placeholder=\"' + placeholder + '\" />' );\r\n\r\n    // CHANGE: Clear validation status if Fluid Checkout checkout validation script is available\r\n    if ( window.CheckoutValidation && $citybox.length > 0 ) {\r\n      CheckoutValidation.clearValidationResults( $citybox[ 0 ], $citybox[ 0 ].closest( '.form-row' ) );\r\n    }\r\n  }\r\n\r\n  function disableCity( $citybox ) {\r\n    $citybox.val( '' ).change();\r\n    $citybox.prop( 'disabled', true );\r\n\r\n    // CHANGE: Clear validation status if Fluid Checkout checkout validation script is available\r\n    if ( window.CheckoutValidation ) {\r\n      CheckoutValidation.clearValidationResults( $citybox[ 0 ], $citybox[ 0 ].closest( '.form-row' ) );\r\n    }\r\n  }\r\n\r\n  function cityToSelect( $citybox, current_cities ) {\r\n    var value = $citybox.val();\r\n\r\n    // CHANGE: Get fallback value from element attributes\r\n    if ( ! value && $citybox.attr( 'data-fallback-value' ) ) {\r\n      value = $citybox.attr( 'data-fallback-value' );\r\n    }\r\n\r\n    if ( $citybox.is('input') ) {\r\n      var input_name = $citybox.attr( 'name' );\r\n      var input_id = $citybox.attr( 'id' );\r\n      var placeholder = $citybox.attr( 'placeholder' );\r\n\r\n      $citybox.replaceWith( '<select name=\"' + input_name + '\" id=\"' + input_id + '\" class=\"city_select\" placeholder=\"' + placeholder + '\"></select>' );\r\n      //we have to assign the new object, because of replaceWith\r\n      $citybox = $('#'+input_id);\r\n    } else {\r\n      $citybox.prop( 'disabled', false );\r\n    }\r\n\r\n    var options = '';\r\n    for( var index in current_cities ) {\r\n      if ( current_cities.hasOwnProperty( index ) ) {\r\n        var cityName = current_cities[ index ];\r\n        options = options + '<option value=\"' + cityName + '\">' + cityName + '</option>';\r\n      }\r\n    }\r\n\r\n    $citybox.html( '<option value=\"\">' + wc_city_select_params.i18n_select_city_text + '</option>' + options );\r\n\r\n    // CHANGE: If there isn't a case sensitive matching value in the options,\r\n    // try comparing select field values against available options both in lowercase,\r\n    // then use the value from the matching option from the select field.\r\n    if ( $citybox[ 0 ].type.indexOf( 'select' ) > -1 && null !== value && ! $citybox[ 0 ].querySelector( 'option[value=\"' + value + '\"]' ) ) {\r\n      // Get available field options\r\n      var options = $citybox[ 0 ].options;\r\n\r\n      // Iterate field options\r\n      for ( var j = 0; j < options.length; j++ ) {\r\n        // Skip if values do not match\r\n        if ( options[ j ].value.toLowerCase() != value.toLowerCase() ) { continue; }\r\n\r\n        // Update value to the matching option value\r\n        value = options[ j ].value;\r\n\r\n        break;\r\n      }\r\n    }\r\n\r\n    if ( $('option[value=\"'+value+'\"]', $citybox).length ) {\r\n      $citybox.val( value ).change();\r\n    } else {\r\n      $citybox.val( '' ).change();\r\n    }\r\n\r\n    // CHANGE: Clear validation status if Fluid Checkout checkout validation script is available\r\n    if ( window.CheckoutValidation && ( ! value || ! $('option[value=\"'+value+'\"]', $citybox).length ) ) {\r\n      CheckoutValidation.clearValidationResults( $citybox[ 0 ], $citybox[ 0 ].closest( '.form-row' ) );\r\n    }\r\n\r\n    // CHANGE: Trigger event after a delay to ensure fields are updated\r\n    $( document.body ).trigger( 'city_to_select' );\r\n  }\r\n});\r\n"],"names":["jQuery","$","wc_country_select_params","wc_city_select_params","select2","wc_city_select_select2","each","select2_args","extend","placeholderOption","width","formatMatches","matches","i18n_matches_1","i18n_matches_n","replace","formatNoMatches","i18n_no_matches","formatAjaxError","i18n_ajax_error","formatInputTooShort","input","min","number","length","i18n_input_too_short_1","i18n_input_too_short_n","formatInputTooLong","max","i18n_input_too_long_1","i18n_input_too_long_n","formatSelectionTooBig","limit","i18n_selection_too_long_1","i18n_selection_too_long_n","formatLoadMore","i18n_load_more","formatSearching","i18n_searching","this","document","body","bind","cities_json","cities","parseJSON","on","e","country","$container","state","find","val","trigger","requestAnimationFrame","$field","target","closest","cityToInput","$citybox","input_name","input_id","placeholder","is","prop","attr","parent","remove","replaceWith","window","CheckoutValidation","clearValidationResults","cityToSelect","current_cities","index","cityName","value","options","hasOwnProperty","html","i18n_select_city_text","type","indexOf","querySelector","j","toLowerCase","change","addClass","tomselect","destroy","Array","MutationObserver","observe","childList"],"mappings":"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"}