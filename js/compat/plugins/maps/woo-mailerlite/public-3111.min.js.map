{"version":3,"file":"../../woo-mailerlite/public-3111.min.js","sources":["woo-mailerlite/public-3111.js"],"sourcesContent":["jQuery(document).ready(function(a) {\r\n\tvar _xhr = null;\r\n\t// CHANGE: Replace field variables with selectors variables\r\n\tvar _emailFieldSelector = '#billing_email';\r\n\tvar _firstNameFieldSelector = '#billing_first_name';\r\n\tvar _lastNameFieldSelector = '#billing_last_name';\r\n\tvar _signupSelector = '#woo_ml_subscribe';\r\n \r\n\tif (jQuery('#woo_ml_preselect_enabled')?.val() == 'yes') {\r\n\t    // CHANGE: Use selector variable, instead of declaring the selector directly\r\n\t    jQuery( _signupSelector ).prop('checked', true);\r\n\t}\r\n \r\n\t// CHANGE: Remove event handler declarations as they are replaced with captured events at bottom\r\n \r\n\tfunction validateMLSub() {\r\n\t    // CHANGE: Get fields dinamically\r\n\t    const email = document.querySelector( _emailFieldSelector );\r\n \r\n\t    if(email !== null && email.value.length > 0) {\r\n\t\t   checkoutMLSub();\r\n\t    }\r\n\t}\r\n \r\n\tfunction checkoutMLSub() {\r\n\t    /** set cookie before sending request to server\r\n\t\t* since multiple checkout update requests can be sent\r\n\t\t* and server cookies won't get updated, so send the saved\r\n\t\t* cookie as a request parameter\r\n\t    **/\r\n \r\n\t    if (!getCookie('mailerlite_checkout_token')) {\r\n\t\t   var now = new Date();\r\n\t\t   now.setTime(now.getTime() + 48 * 3600 * 1000);\r\n\t\t   document.cookie = `mailerlite_checkout_token=${(+new Date).toString()}; expires=${now.toUTCString()}; path=/`;\r\n\t    }\r\n \r\n\t    // CHANGE: Use selector variable, instead of declaring the selector directly\r\n\t    const accept_marketing = document.querySelector( _signupSelector ).checked;\r\n \r\n\t    // CHANGE: Get fields dinamically\r\n\t    const email = document.querySelector( _emailFieldSelector );\r\n\t    const first_name_field = document.querySelector( _firstNameFieldSelector );\r\n\t    const last_name_field = document.querySelector( _lastNameFieldSelector );\r\n \r\n\t    let first_name = '';\r\n\t    let last_name = '';\r\n \r\n\t    if (first_name_field !== null) {\r\n\t\t   first_name = first_name_field.value;\r\n\t    }\r\n \r\n\t    if (last_name_field !== null) {\r\n\t\t   last_name = last_name_field.value;\r\n\t    }\r\n \r\n\t    // CHANGE: Bail if an ajax request is already running\r\n\t    if ( _xhr !== null ) { return; }\r\n \r\n\t    _xhr = jQuery.ajax({\r\n\t\t   url: woo_ml_public_post.ajax_url,\r\n\t\t   type: \"post\",\r\n\t\t   data: {\r\n\t\t\t  action: \"post_woo_ml_email_cookie\",\r\n\t\t\t  email: email.value,\r\n\t\t\t  signup: accept_marketing,\r\n\t\t\t  language: woo_ml_public_post.language,\r\n\t\t\t  first_name: first_name,\r\n\t\t\t  last_name: last_name,\r\n\t\t\t  cookie_mailerlite_checkout_token:getCookie('mailerlite_checkout_token')\r\n\t\t   },\r\n\t\t   // CHANGE: Set the xhr variable to null when the request is complete\r\n\t\t   complete: function() {\r\n\t\t\t  _xhr = null;\r\n\t\t   },\r\n\t    })\r\n\t}\r\n \r\n\t// CHANGE: Use captured event handlers instead of events attached to specific elements\r\n\tvar handleBlur = function( e ) {\r\n\t    // EMAIL, FIRST NAME, LAST NAME\r\n\t    if ( e.target.matches( _emailFieldSelector ) || e.target.matches( _firstNameFieldSelector ) || e.target.matches( _lastNameFieldSelector ) ) {\r\n\t\t   validateMLSub();\r\n\t    }\r\n\t};\r\n\tvar handleChange = function( e ) {\r\n\t    // SIGNUP\r\n\t    if ( e.target.matches( _signupSelector ) ) {\r\n\t\t   validateMLSub();\r\n\t    }\r\n\t}\r\n\tdocument.addEventListener( 'blur', handleBlur, true );\r\n\tdocument.addEventListener( 'change', handleChange, true );\r\n\t// CHANGE: END - Use captured event handlers instead of events attached to specific elements\r\n \r\n });\r\n \r\n function getCookie(name) {\r\n\tconst value = `; ${document.cookie}`;\r\n\tconst parts = value.split(`; ${name}=`);\r\n\tif (parts.length === 2) {\r\n\t    return parts.pop().split(';').shift()\r\n\t}\r\n\treturn null;\r\n }"],"names":["getCookie","name","parts","document","cookie","split","length","pop","shift","jQuery","ready","a","_xhr","_emailFieldSelector","_firstNameFieldSelector","_lastNameFieldSelector","_signupSelector","validateMLSub","email","querySelector","value","checkoutMLSub","now","Date","setTime","getTime","toString","toUTCString","accept_marketing","checked","first_name_field","last_name_field","let","first_name","last_name","ajax","url","woo_ml_public_post","ajax_url","type","data","action","signup","language","cookie_mailerlite_checkout_token","complete","val","prop","addEventListener","e","target","matches"],"mappings":"AAiGC,SAASA,UAAUC,GAEbC,GADQ,KAAKC,SAASC,QACRC,WAAWJ,IAAO,EACtC,OAAqB,IAAjBC,EAAMI,OACCJ,EAAMK,IAAI,EAAEF,MAAM,GAAG,EAAEG,MAAM,EAEjC,IACP,CAxGDC,OAAON,QAAQ,EAAEO,MAAM,SAASC,GAC/B,IAAIC,EAAO,KAEPC,EAAsB,iBACtBC,EAA0B,sBAC1BC,EAAyB,qBACzBC,EAAkB,oBAStB,SAASC,IAEL,IAAMC,EAAQf,SAASgB,cAAeN,CAAoB,EAE1D,GAAa,OAAVK,GAAuC,EAArBA,EAAME,MAAMd,OACjCe,CAWKrB,UAAU,2BAA2B,KACtCsB,EAAM,IAAIC,MACVC,QAAQF,EAAIG,QAAQ,EAAI,MAAgB,EAC5CtB,SAASC,qCAAsC,CAAE,IAAImB,MAAMG,SAAS,cAAcJ,EAAIK,YAAY,aAIlG,IAAMC,EAAmBzB,SAASgB,cAAeH,CAAgB,EAAEa,QAG7DX,EAAQf,SAASgB,cAAeN,CAAoB,EACpDiB,EAAmB3B,SAASgB,cAAeL,CAAwB,EACnEiB,EAAkB5B,SAASgB,cAAeJ,CAAuB,EAEvEiB,IAAIC,EAAa,GACbC,EAAY,GAES,OAArBJ,IACJG,EAAaH,EAAiBV,OAGN,OAApBW,IACJG,EAAYH,EAAgBX,OAId,OAATR,IAELA,EAAOH,OAAO0B,KAAK,CACnBC,IAAKC,mBAAmBC,SACxBC,KAAM,OACNC,KAAM,CACNC,OAAQ,2BACRvB,MAAOA,EAAME,MACbsB,OAAQd,EACRe,SAAUN,mBAAmBM,SAC7BV,WAAYA,EACZC,UAAWA,EACXU,iCAAiC5C,UAAU,2BAA2B,CACtE,EAEA6C,SAAU,WACVjC,EAAO,IACP,CACA,CAAC,EAvDa,CAElB,CAdkD,OAA9CH,OAAO,2BAA2B,GAAGqC,IAAI,GAEzCrC,OAAQO,CAAgB,EAAE+B,KAAK,UAAW,CAAA,CAAI,EAiFlD5C,SAAS6C,iBAAkB,OAZV,SAAUC,IAElBA,EAAEC,OAAOC,QAAStC,CAAoB,GAAKoC,EAAEC,OAAOC,QAASrC,CAAwB,GAAKmC,EAAEC,OAAOC,QAASpC,CAAuB,IACxIE,EAAc,CAElB,EAO+C,CAAA,CAAK,EACpDd,SAAS6C,iBAAkB,SAPR,SAAUC,GAEpBA,EAAEC,OAAOC,QAASnC,CAAgB,GACvCC,EAAc,CAElB,EAEmD,CAAA,CAAK,CAGxD,CAAC"}