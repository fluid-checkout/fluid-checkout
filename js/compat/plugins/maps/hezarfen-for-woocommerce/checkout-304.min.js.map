{"version":3,"file":"../../hezarfen-for-woocommerce/checkout-304.min.js","sources":["hezarfen-for-woocommerce/checkout-304.js"],"sourcesContent":["var wc_hezarfen_checkout = {\n    mbgb_plugin_active: typeof wc_hezarfen_mbgb_backend !== 'undefined',\n    should_notify_neighborhood_changed: function (type) {\n        return this.mbgb_plugin_active && (wc_hezarfen_mbgb_backend.address_source === type || (wc_hezarfen_mbgb_backend.address_source === 'shipping' && !this.ship_to_different_checked()))\n    },\n    ship_to_different_checked: function () {\n        return jQuery('#ship-to-different-address input').is(':checked');\n    }\n};\n\njQuery(function ($) {\n    // CHANGE: Move initialization function to a named reusable function\n    function init() {\n        for (const type of ['billing', 'shipping']) {\n            let wrapper = $('.woocommerce-' + type + '-fields');\n            let mahalle_helper = new hezarfen_mahalle_helper(wrapper, type, 'checkout');\n\n            let current_country_code = mahalle_helper.get_country_field().val();\n\n            if (!current_country_code || current_country_code === 'TR') {\n                mahalle_helper.convert_fields_to_selectwoo();\n            }\n\n            if (current_country_code === 'TR') {\n                mahalle_helper.add_event_handlers();\n                add_checkout_event_handlers(type, wrapper);\n            }\n        }\n\n        $(document.body).on('country_to_state_changing', function (event, country_code, wrapper) {\n            let type = wrapper.hasClass('woocommerce-billing-fields') ? 'billing' : 'shipping';\n            new hezarfen_mahalle_helper(wrapper, type, 'checkout').on_country_change(country_code, get_additional_classes(type));\n            country_on_change(type, country_code, wrapper);\n        });\n\n        $('#hezarfen_invoice_type').on('change', function () {\n            var invoice_type = $(this).val();\n\n            if (invoice_type == 'person') {\n                $('#hezarfen_TC_number_field').removeClass('hezarfen-hide-form-field');\n                $('#hezarfen_tax_number_field, #hezarfen_tax_office_field, #billing_company_field').addClass('hezarfen-hide-form-field');\n            } else if (invoice_type == 'company') {\n                $('#hezarfen_TC_number_field').addClass('hezarfen-hide-form-field');\n                $('#hezarfen_tax_number_field, #hezarfen_tax_office_field, #billing_company_field').removeClass('hezarfen-hide-form-field');\n            }\n        });\n    }\n    // CHANGE: END - Move initialization function to a named reusable function\n\n    // CHANGE: Call initialization function when the page is ready and after every checkout update\n    $(document).ready( init );\n    $(document).on( 'updated_checkout', init );\n\n    function add_checkout_event_handlers(type, wrapper) {\n        // prevent adding event handlers multiple times.\n        $('#' + type + '_address_1').off('select2:select.hezarfen');\n        $('#ship-to-different-address input').off('change.hezarfen');\n\n        $('#' + type + '_address_1').on(\"select2:select.hezarfen\", function (e) {\n            neighborhood_on_change($(this).val(), type, wrapper);\n        });\n\n        $('#ship-to-different-address input').on('change.hezarfen', function () {\n            ship_to_different_on_change(this);\n        });\n    }\n\n    function country_on_change(type, country_code, wrapper) {\n        if (country_code === 'TR') {\n            add_checkout_event_handlers(type, wrapper);\n        }\n    }\n\n    function neighborhood_on_change(neighborhood, type, checkout_fields_wrapper) {\n        if (wc_hezarfen_checkout.should_notify_neighborhood_changed(type)) {\n            let province_plate_number = checkout_fields_wrapper.find('#' + type + '_state').val();\n            let district = checkout_fields_wrapper.find('#' + type + '_city').val();\n\n            notify_neighborhood_changed(province_plate_number, district, neighborhood, type);\n        }\n    }\n\n    function ship_to_different_on_change(checkbox) {\n        if (wc_hezarfen_checkout.mbgb_plugin_active && wc_hezarfen_mbgb_backend.address_source === 'shipping') {\n            let address_type = $(checkbox).is(':checked') ? 'shipping' : 'billing';\n            let neighborhood_select = $(`#${address_type}_address_1`);\n\n            // set a small timeout to prevent conflict with the Woocommerce's \"update_checkout\" trigger.\n            setTimeout(() => {\n                neighborhood_select.trigger('select2:select');\n            }, 300);\n        }\n    }\n\n    function notify_neighborhood_changed(province_plate_number, district, neighborhood, type) {\n        if (!province_plate_number || !district || !neighborhood) {\n            return;\n        }\n\n        var data = {\n            'action': 'wc_hezarfen_neighborhood_changed',\n            'security': wc_hezarfen_ajax_object.mahalleio_nonce,\n            'cityPlateNumber': province_plate_number,\n            'district': district,\n            'neighborhood': neighborhood,\n            'type': type\n        };\n\n        jQuery.post(wc_hezarfen_ajax_object.ajax_url, data, function (response) {\n            if (response.update_checkout)\n                jQuery('body').trigger('update_checkout');\n        }, 'json');\n    }\n\n    function get_additional_classes(type) {\n        return {\n            district: type === 'billing' ? wc_hezarfen_ajax_object.billing_district_field_classes : wc_hezarfen_ajax_object.shipping_district_field_classes,\n            neighborhood: type === 'billing' ? wc_hezarfen_ajax_object.billing_neighborhood_field_classes : wc_hezarfen_ajax_object.shipping_neighborhood_field_classes\n        };\n    }\n});\n"],"names":["wc_hezarfen_checkout","mbgb_plugin_active","wc_hezarfen_mbgb_backend","should_notify_neighborhood_changed","type","this","address_source","ship_to_different_checked","jQuery","is","$","init","let","wrapper","mahalle_helper","hezarfen_mahalle_helper","current_country_code","get_country_field","val","convert_fields_to_selectwoo","add_event_handlers","add_checkout_event_handlers","document","body","on","event","country_code","hasClass","on_country_change","district","wc_hezarfen_ajax_object","billing_district_field_classes","shipping_district_field_classes","neighborhood","billing_neighborhood_field_classes","shipping_neighborhood_field_classes","invoice_type","removeClass","addClass","off","e","neighborhood_on_change","province_plate_number","checkout_fields_wrapper","find","data","action","security","mahalleio_nonce","cityPlateNumber","post","ajax_url","response","update_checkout","trigger","ship_to_different_on_change","checkbox","address_type","neighborhood_select","setTimeout","ready"],"mappings":"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"}