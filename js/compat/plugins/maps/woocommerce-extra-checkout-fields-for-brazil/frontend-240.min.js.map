{"version":3,"file":"../../woocommerce-extra-checkout-fields-for-brazil/frontend-240.min.js","sources":["woocommerce-extra-checkout-fields-for-brazil/frontend-240.js"],"sourcesContent":["/* global wcbcf_public_params */\n/*jshint devel: true */\njQuery( function( $ ) {\n\n\t/**\n\t * Frontend actions\n\t */\n\tvar wc_ecfb_frontend = {\n\n\t\t/**\n\t\t * Initialize frontend actions\n\t\t */\n\t\tinit: function() {\n\t\t\tif ( '0' === wcbcf_public_params.sort_state_country ) {\n\t\t\t\t$( document.body ).on( 'country_to_state_changing', this.country_to_state_changing );\n\t\t\t}\n\n\t\t\tif ( '0' !== wcbcf_public_params.person_type ) {\n\t\t\t\tthis.person_type_fields();\n\t\t\t}\n\n\t\t\tif ( 'yes' === wcbcf_public_params.maskedinput ) {\n\t\t\t\t$( document.body ).on( 'change', '#billing_country', function() {\n\t\t\t\t\tif ( 'BR' === $( this ).val() ) {\n\t\t\t\t\t\twc_ecfb_frontend.maskBilling();\n\t\t\t\t\t} else {\n\t\t\t\t\t\twc_ecfb_frontend.unmaskBilling();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t$( document.body ).on( 'change', '#shipping_country', function() {\n\t\t\t\t\tif ( 'BR' === $( this ).val() ) {\n\t\t\t\t\t\twc_ecfb_frontend.maskShipping();\n\t\t\t\t\t} else {\n\t\t\t\t\t\twc_ecfb_frontend.unmaskShipping();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.maskGeneral();\n\t\t\t}\n\n\t\t\tif ( 'yes' === wcbcf_public_params.mailcheck ) {\n\t\t\t\tthis.emailCheck();\n\t\t\t}\n\n\t\t\t// Check if select2 exists.\n\t\t\tif ( $().select2 ) {\n\t\t\t\t$( '.wc-ecfb-select' ).select2();\n\t\t\t}\n\t\t\tif ($('#billing_country').val() === 'BR' ) {\n\t\t\t\twc_ecfb_frontend.maskBilling();\n\t\t\t}\n\t\t\t// CHANGE: Also mask shipping when initializing\n\t\t\tif ($('#shipping_country').val() === 'BR' ) {\n\t\t\t\twc_ecfb_frontend.maskShipping();\n\t\t\t}\n\n\t\t\t// CHANGE: Apply billing country changes to fields on initialization\n\t\t\t$( document.body ).on( 'updated_checkout', wc_ecfb_frontend.billing_country_change );\n\t\t},\n\n\t\t/**\n\t\t * Country to state changing.\n\t\t * Fix the fields order.\n\t\t */\n\t\tcountry_to_state_changing: function() {\n\t\t\t// Billing.\n\t\t\t$( '#billing_state_field label' ).html( wcbcf_public_params.state + ' <abbr class=\"required\" title=\"' + wcbcf_public_params.required + '\">*</abbr>' );\n\t\t\t$( '#billing_postcode_field' ).insertAfter( '#billing_country_field' );\n\n\t\t\t// Shipping.\n\t\t\tif ( $( '#shipping_state_field' ).length ) {\n\t\t\t\t$( '#shipping_state_field label' ).html( wcbcf_public_params.state + ' <abbr class=\"required\" title=\"' + wcbcf_public_params.required + '\">*</abbr>' );\n\t\t\t\t$( '#shipping_postcode_field' ).insertAfter( '#shipping_country_field' );\n\t\t\t}\n\t\t},\n\n\t\t// CHANGE: Move billing country change handler function to a named function that can be reused\n\t\tbilling_country_change: function () {\n\t\t\t// CHANGE: Get value from the field element directly, instead of using reference from `this` keyword\n\t\t\tvar current = $( '#billing_country' ).val();\n\n\t\t\tif ( 'BR' === current ) {\n\t\t\t\t$( '.person-type-field label .required' ).remove();\n\t\t\t\t$( '.person-type-field' ).addClass( 'validate-required' );\n\t\t\t\t$( '.person-type-field label' ).append( ' <abbr class=\"required\" title=\"' + wcbcf_public_params.required + '\">*</abbr>' );\n\t\t\t} else {\n\t\t\t\t$( '.person-type-field' ).removeClass( 'validate-required' );\n\t\t\t\t$( '.person-type-field label .required' ).remove();\n\t\t\t}\n\n\t\t\t// CHANGE: Do not trigger field `change` event after updating the field attributes\n\t\t\t// to prevent an infinite loop where the `change` event triggers the `update_checkout` event,\n\t\t\t// which in turn, would run this code again and trigger the field `change` event, and so on.\n\t\t},\n\n\t\tperson_type_fields: function() {\n\t\t\t// Required fields.\n\t\t\tif ( 'no' === wcbcf_public_params.only_brazil ) {\n\t\t\t\t$( '.person-type-field label .required' ).remove();\n\t\t\t\t$( '.person-type-field' ).addClass( 'validate-required' );\n\t\t\t\t$( '.person-type-field label' ).append( ' <abbr class=\"required\" title=\"' + wcbcf_public_params.required + '\">*</abbr>' );\n\t\t\t} else {\n\t\t\t\t// CHANGE: Use billing country change handler from named function\n\t\t\t\t$( '#billing_country' ).on( 'change', wc_ecfb_frontend.billing_country_change );\n\t\t\t}\n\n\t\t\tif ( '1' === wcbcf_public_params.person_type ) {\n\t\t\t\t$( '#billing_persontype' ).on( 'change', function () {\n\t\t\t\t\tvar current = $( this ).val();\n\n\t\t\t\t\t$( '#billing_cpf_field' ).hide();\n\t\t\t\t\t$( '#billing_rg_field' ).hide();\n\t\t\t\t\t$( '#billing_company_field' ).hide();\n\t\t\t\t\t$( '#billing_cnpj_field' ).hide();\n\t\t\t\t\t$( '#billing_ie_field' ).hide();\n\n\t\t\t\t\tif ( '1' === current ) {\n\t\t\t\t\t\t$( '#billing_cpf_field' ).show();\n\t\t\t\t\t\t$( '#billing_rg_field' ).show();\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( '2' === current ) {\n\t\t\t\t\t\t$( '#billing_company_field' ).show();\n\t\t\t\t\t\t$( '#billing_cnpj_field' ).show();\n\t\t\t\t\t\t$( '#billing_ie_field' ).show();\n\n\t\t\t\t\t\t// CHANGE: Maybe make company field `required` on the frontend in cases which\n\t\t\t\t\t\t// the company field is validated as required on the server-side.\n\t\t\t\t\t\tvar currentCountry = $( '#billing_country' ).val();\n\t\t\t\t\t\t$( '#billing_company_field label .optional' ).remove();\n\t\t\t\t\t\t$( '#billing_company_field label .required' ).remove();\n\t\t\t\t\t\tif ( 'no' === wcbcf_public_params.only_brazil || 'BR' === currentCountry ) {\n\t\t\t\t\t\t\t$( '#billing_company_field' ).addClass( 'validate-required' );\n\t\t\t\t\t\t\t$( '#billing_company_field label' ).append( ' <abbr class=\"required\" title=\"' + wcbcf_public_params.required + '\">*</abbr>' );\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t$( '#billing_company_field' ).removeClass( 'validate-required' );\n\t\t\t\t\t\t\t$( '#billing_company_field label' ).append( '<span class=\"optional\">(' + wcbcf_public_params.optional + ')</span>' );\n\n\t\t\t\t\t\t\t// Maybe clear Fluid Checkout inline validation results for the company field\n\t\t\t\t\t\t\tif ( window.CheckoutValidation ) {\n\t\t\t\t\t\t\t\tCheckoutValidation.clearValidationResults( document.querySelector( '#billing_company' ), document.querySelector( '#billing_company_field' ) );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}).change();\n\t\t\t}\n\t\t},\n\n\t\tmaskBilling: function() {\n\t\t\twc_ecfb_frontend.maskPhone( '#billing_phone, #billing_cellphone' );\n\t\t\t$( '#billing_birthdate' ).mask( '00/00/0000' );\n\t\t\t$( '#billing_postcode' ).mask( '00000-000' );\n\t\t\t$( '#billing_phone, #billing_cellphone, #billing_birthdate, #billing_postcode' ).attr( 'type', 'tel' );\n\t\t},\n\n\t\tunmaskBilling: function() {\n\t\t\t$( '#billing_phone, #billing_cellphone, #billing_birthdate, #billing_postcode' ).unmask().attr( 'type', 'text' );\n\t\t},\n\n\t\tmaskShipping: function() {\n\t\t\t// CHANGE: Add mask to shipping phone if field exists\n\t\t\twc_ecfb_frontend.maskPhone( '#shipping_phone' );\n\t\t\t$( '#shipping_postcode' ).mask( '00000-000' ).attr( 'type', 'tel' );\n\t\t},\n\n\t\tunmaskShipping: function() {\n\t\t\t// CHANGE: Remove mask from shipping phone if field exists\n\t\t\t$( '#shipping_postcode', '#shipping_phone' ).unmask().attr( 'type', 'text' );\n\t\t},\n\n\t\tmaskGeneral: function() {\n\t\t\t$( '#billing_cpf, #credit-card-cpf' ).mask( '000.000.000-00' );\n\t\t\t$( '#billing_cnpj' ).mask( '00.000.000/0000-00' );\n\t\t\twc_ecfb_frontend.maskPhone( '#credit-card-phone' );\n\t\t},\n\n\t\tmaskPhone: function(selector) {\n\t\t\tvar $element = $(selector),\n\t\t\t\t\tMaskBehavior = function(val) {\n\t\t\t\t\t\treturn val.replace(/\\D/g, '').length === 11 ? '(00) 00000-0000' : '(00) 0000-00009';\n\t\t\t\t\t},\n\t\t\t\t\tmaskOptions = {\n\t\t\t\t\t\tonKeyPress: function(val, e, field, options) {\n\t\t\t\t\t\t\tfield.mask(MaskBehavior.apply({}, arguments), options);\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t$element.mask(MaskBehavior, maskOptions);\n\t\t},\n\n\t\temailCheck: function() {\n\t\t\tif ( $( '#wcbcf-mailsuggest' ).length < 1 ) {\n\t\t\t\t$( '#billing_email' ).after( '<div id=\"wcbcf-mailsuggest\"></div>' );\n\t\t\t}\n\n\t\t\t$( '#billing_email' ).on( 'blur', function () {\n\t\t\t\t$( '#wcbcf-mailsuggest' ).html( '' );\n\t\t\t\t$( this ).mailcheck({\n\t\t\t\t\tsuggested: function( element, suggestion ) {\n\t\t\t\t\t\t$( '#wcbcf-mailsuggest' ).html( 'VocÃª quis dizer: ' + suggestion.full + '?' );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t$( '#wcbcf-mailsuggest' ).css({\n\t\t\t\tcolor: '#c00',\n\t\t\t\tfontSize: 'small'\n\t\t\t});\n\t\t}\n\t};\n\n\twc_ecfb_frontend.init();\n\n\t// CHANGE: Also run initialization after every checkout update as sections with affected fields might have have been replaced\n\t$( document.body ).on( 'updated_checkout', function() { wc_ecfb_frontend.init() } );\n});\n"],"names":["jQuery","$","wc_ecfb_frontend","init","wcbcf_public_params","sort_state_country","document","body","on","this","country_to_state_changing","person_type","person_type_fields","maskedinput","val","maskBilling","unmaskBilling","maskShipping","unmaskShipping","maskGeneral","mailcheck","emailCheck","select2","billing_country_change","html","state","required","insertAfter","length","remove","addClass","append","removeClass","only_brazil","current","hide","show","currentCountry","optional","window","CheckoutValidation","clearValidationResults","querySelector","change","maskPhone","mask","attr","unmask","selector","MaskBehavior","replace","$element","onKeyPress","e","field","options","apply","arguments","after","suggested","element","suggestion","full","css","color","fontSize"],"mappings":"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"}