{"version":3,"file":"../../woocommerce-extra-checkout-fields-for-brazil/frontend-327-beta-4.min.js","sources":["woocommerce-extra-checkout-fields-for-brazil/frontend-327-beta-4.js"],"sourcesContent":["/* global bmwPublicParams */\r\njQuery(function ($) {\r\n\t/**\r\n\t * Frontend actions\r\n\t */\r\n\tconst bmwFrontEnd = {\r\n\t\t/**\r\n\t\t * Initialize frontend actions\r\n\t\t */\r\n\t\tinit() {\r\n\t\t\tif ('0' !== bmwPublicParams.person_type) {\r\n\t\t\t\t// CHANGE: Fix refence to function in main object\r\n\t\t\t\tbmwFrontEnd.person_type_fields();\r\n\t\t\t}\r\n\r\n\t\t\tif ('yes' === bmwPublicParams.maskedinput) {\r\n\t\t\t\t$(document.body).on('change', '#billing_country', function () {\r\n\t\t\t\t\tif ('BR' === $(this).val()) {\r\n\t\t\t\t\t\tbmwFrontEnd.maskBilling();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbmwFrontEnd.unmaskBilling();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$(document.body).on('change', '#shipping_country', function () {\r\n\t\t\t\t\tif ('BR' === $(this).val()) {\r\n\t\t\t\t\t\tbmwFrontEnd.maskShipping();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbmwFrontEnd.unmaskShipping();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif ('BR' === $('#billing_country').val()) {\r\n\t\t\t\t\tbmwFrontEnd.maskBilling();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ('BR' === $('#shipping_country').val()) {\r\n\t\t\t\t\tbmwFrontEnd.maskShipping();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// CHANGE: Fix refence to function in main object\r\n\t\t\t\tbmwFrontEnd.maskGeneral();\r\n\t\t\t}\r\n\r\n\t\t\t// CHANGE: Remove code of the Mailcheck feature from Brazilian Market plugin as it is already provided by Fluid Checkout\r\n\r\n\t\t\t// Check if select2 exists.\r\n\t\t\tif ($().select2) {\r\n\t\t\t\t$('.wc-ecfb-select').select2();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tperson_type_fields() {\r\n\t\t\t/**\r\n\t\t\t * Control person type fields\r\n\t\t\t *\r\n\t\t\t * @param {string}  personType\r\n\t\t\t * @param {boolean} checkCountry\r\n\t\t\t */\r\n\t\t\tconst handleFields = function (personType, checkCountry = false) {\r\n\t\t\t\tlet country = 'BR';\r\n\r\n\t\t\t\tif (checkCountry) {\r\n\t\t\t\t\tcountry = $('#billing_country').val();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$('.person-type-field')\r\n\t\t\t\t\t.hide()\r\n\t\t\t\t\t.removeClass(\r\n\t\t\t\t\t\t'validate-required is-active woocommerce-validated'\r\n\t\t\t\t\t);\r\n\t\t\t\t$('#billing_persontype_field').show().addClass('is-active');\r\n\r\n\t\t\t\tif ('1' === personType) {\r\n\t\t\t\t\tif ('BR' === country) {\r\n\t\t\t\t\t\t$('#billing_cpf_field')\r\n\t\t\t\t\t\t\t.addClass(\r\n\t\t\t\t\t\t\t\t'validate-required is-active woocommerce-validated'\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t.show();\r\n\t\t\t\t\t\t$('#billing_rg_field')\r\n\t\t\t\t\t\t\t.addClass(\r\n\t\t\t\t\t\t\t\t'validate-required is-active woocommerce-validated'\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t.show();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$('#billing_cpf_field').show().addClass('is-active');\r\n\t\t\t\t\t\t$('#billing_rg_field').show().addClass('is-active');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ('2' === personType) {\r\n\t\t\t\t\tif ('BR' === country) {\r\n\t\t\t\t\t\t$('#billing_company_field label .optional').remove();\r\n\t\t\t\t\t\t$('#billing_company_field')\r\n\t\t\t\t\t\t\t.addClass(\r\n\t\t\t\t\t\t\t\t'validate-required is-active woocommerce-validated'\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t.show();\r\n\t\t\t\t\t\t$('#billing_cnpj_field')\r\n\t\t\t\t\t\t\t.addClass(\r\n\t\t\t\t\t\t\t\t'validate-required is-active woocommerce-validated'\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t.show();\r\n\t\t\t\t\t\t$('#billing_ie_field')\r\n\t\t\t\t\t\t\t.addClass(\r\n\t\t\t\t\t\t\t\t'validate-required is-active woocommerce-validated'\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t.show();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$('#billing_company_field')\r\n\t\t\t\t\t\t\t.addClass('is-active')\r\n\t\t\t\t\t\t\t.show();\r\n\t\t\t\t\t\t$('#billing_cnpj_field').addClass('is-active').show();\r\n\t\t\t\t\t\t$('#billing_ie_field').addClass('is-active').show();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ('BR' === country) {\r\n\t\t\t\t\t$('.person-type-field label .required').remove();\r\n\t\t\t\t\t$('.person-type-field label').append(\r\n\t\t\t\t\t\t' <abbr class=\"required\" title=\"' +\r\n\t\t\t\t\t\t\tbmwPublicParams.required +\r\n\t\t\t\t\t\t\t'\">*</abbr>'\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t/**\r\n\t\t\t * Maybe run handle fields\r\n\t\t\t *\r\n\t\t\t * @param {boolean} checkCountry\r\n\t\t\t * @return {void}\r\n\t\t\t */\r\n\t\t\tconst maybeRunHandleFields = function (checkCountry = false) {\r\n\t\t\t\tif ('1' === bmwPublicParams.person_type) {\r\n\t\t\t\t\t$('#billing_persontype')\r\n\t\t\t\t\t\t.on('change', function () {\r\n\t\t\t\t\t\t\tconst personType = $(this).val();\r\n\r\n\t\t\t\t\t\t\thandleFields(personType, checkCountry);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t// CHANGE: Do not trigger `change` event for the field, as it might cause other plugins to behave errorneusly\r\n\r\n\t\t\t\t\t// CHANGE: Run the function `handleFields` directly, to handle the field changes without triggering the `change` event remove above\r\n\t\t\t\t\thandleFields( '1', checkCountry );\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// Required fields.\r\n\t\t\tif ('no' === bmwPublicParams.only_brazil) {\r\n\t\t\t\t$('.person-type-field label .required').remove();\r\n\t\t\t\t$('.person-type-field label').append(\r\n\t\t\t\t\t' <abbr class=\"required\" title=\"' +\r\n\t\t\t\t\t\tbmwPublicParams.required +\r\n\t\t\t\t\t\t'\">*</abbr>'\r\n\t\t\t\t);\r\n\r\n\t\t\t\tmaybeRunHandleFields();\r\n\t\t\t} else {\r\n\t\t\t\t// CHANGE: Extract anonymous function to a named function that can be reused\r\n\t\t\t\tvar updateBillingPersonFieldArgs = function () {\r\n\t\t\t\t\t$('.person-type-field').removeClass(\r\n\t\t\t\t\t\t'validate-required is-active woocommerce-validated'\r\n\t\t\t\t\t);\r\n\t\t\t\t\t$('.person-type-field label .required').remove();\r\n\t\t\t\t\tmaybeRunHandleFields(true);\r\n\r\n\t\t\t\t\t// CHANGE: Get field directly as referencing it with `this` do not work in this context\r\n\t\t\t\t\tconst current = $('#billing_country').val();\r\n\r\n\t\t\t\t\t\tif ('BR' === current) {\r\n\t\t\t\t\t\t\t$('.person-type-field label .required').remove();\r\n\t\t\t\t\t\t\t$('.person-type-field').addClass(\r\n\t\t\t\t\t\t\t\t'validate-required'\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t$('.person-type-field label').append(\r\n\t\t\t\t\t\t\t\t' <abbr class=\"required\" title=\"' +\r\n\t\t\t\t\t\t\t\t\tbmwPublicParams.required +\r\n\t\t\t\t\t\t\t\t\t'\">*</abbr>'\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$('.person-type-field').removeClass(\r\n\t\t\t\t\t\t\t\t'validate-required is-active woocommerce-validated'\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t$('.person-type-field label .required').remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\t// CHANGE: Replace `change` event trigger with calling the function directly\r\n\t\t\t\t$('#billing_country').on('change', updateBillingPersonFieldArgs);\r\n\t\t\t\tupdateBillingPersonFieldArgs();\r\n\t\t\t}\r\n\r\n\t\t\tif ('1' === bmwPublicParams.person_type) {\r\n\t\t\t\t// CHANGE: Extract anonymous function to a named function that can be reused\r\n\t\t\t\tvar updateBillingFieldsArgs = function () {\r\n\t\t\t\t\t// CHANGE: Get field directly as referencing it with `this` do not work in this context\r\n\t\t\t\t\tconst current = $('#billing_persontype').val();\r\n\r\n\t\t\t\t\t$('#billing_cpf_field').hide();\r\n\t\t\t\t\t$('#billing_rg_field').hide();\r\n\t\t\t\t\t$('#billing_company_field').hide();\r\n\t\t\t\t\t$('#billing_cnpj_field').hide();\r\n\t\t\t\t\t$('#billing_ie_field').hide();\r\n\r\n\t\t\t\t\tif ('1' === current) {\r\n\t\t\t\t\t\t$('#billing_cpf_field').show();\r\n\t\t\t\t\t\t$('#billing_rg_field').show();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ('2' === current) {\r\n\t\t\t\t\t\t$('#billing_company_field').show();\r\n\t\t\t\t\t\t$('#billing_cnpj_field').show();\r\n\t\t\t\t\t\t$('#billing_ie_field').show();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\t// CHANGE: Replace `change` event trigger with calling the function directly\r\n\t\t\t\t$('#billing_persontype').on( 'change', updateBillingFieldsArgs );\r\n\t\t\t\tupdateBillingFieldsArgs();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tmaskBilling() {\r\n\t\t\t// CHANGE: Maybe do not mask phone fields\r\n\t\t\tif ( 'yes' === bmwPublicParams.maskedinput_phone ) {\r\n\t\t\t\tbmwFrontEnd.maskPhone('#billing_phone, #billing_cellphone');\r\n\t\t\t}\r\n\r\n\t\t\t$('#billing_birthdate').mask('00/00/0000');\r\n\t\t\t$('#billing_postcode').mask('00000-000');\r\n\t\t\t$(\r\n\t\t\t\t'#billing_phone, #billing_cellphone, #billing_birthdate, #billing_postcode'\r\n\t\t\t).attr('type', 'tel');\r\n\t\t},\r\n\r\n\t\tunmaskBilling() {\r\n\t\t\t$(\r\n\t\t\t\t'#billing_phone, #billing_cellphone, #billing_birthdate, #billing_postcode'\r\n\t\t\t)\r\n\t\t\t\t.unmask()\r\n\t\t\t\t.attr('type', 'text');\r\n\t\t},\r\n\r\n\t\tmaskShipping() {\r\n\t\t\t// CHANGE: Maybe mask shipping phone field\r\n\t\t\tif ( 'yes' === bmwPublicParams.maskedinput_phone ) {\r\n\t\t\t\tbmwFrontEnd.maskPhone( '#shipping_phone' );\r\n\t\t\t}\r\n\r\n\t\t\t$('#shipping_postcode').mask('00000-000').attr('type', 'tel');\r\n\t\t},\r\n\r\n\t\tunmaskShipping() {\r\n\t\t\t$('#shipping_postcode').unmask().attr('type', 'text');\r\n\r\n\t\t\t// CHANGE: Unmask shipping phone field, but do not change type attribute\r\n\t\t\t$( '#shipping_phone' ).unmask();\r\n\t\t},\r\n\r\n\t\tmaskGeneral() {\r\n\t\t\t$('#billing_cpf, #credit-card-cpf').mask('000.000.000-00');\r\n\t\t\t$('#billing_cnpj').mask('00.000.000/0000-00');\r\n\t\t\tbmwFrontEnd.maskPhone('#credit-card-phone');\r\n\t\t},\r\n\r\n\t\tmaskPhone(selector) {\r\n\t\t\tconst $element = $(selector),\r\n\t\t\t\tMaskBehavior = function (val) {\r\n\t\t\t\t\treturn val.replace(/\\D/g, '').length === 11\r\n\t\t\t\t\t\t? '(00) 00000-0000'\r\n\t\t\t\t\t\t: '(00) 0000-00009';\r\n\t\t\t\t},\r\n\t\t\t\tmaskOptions = {\r\n\t\t\t\t\tonKeyPress(val, e, field, options) {\r\n\t\t\t\t\t\tfield.mask(MaskBehavior.apply({}, arguments), options);\r\n\t\t\t\t\t},\r\n\t\t\t\t};\r\n\r\n\t\t\t$element.mask(MaskBehavior, maskOptions);\r\n\t\t},\r\n\r\n\t\t// CHANGE: Remove code of the Mailcheck feature from Brazilian Market plugin as it is already provided by Fluid Checkout\r\n\t};\r\n\r\n\tbmwFrontEnd.init();\r\n\r\n\t// CHANGE: Also run initialization after every checkout update as sections with affected fields might have have been replaced\r\n\t$( document.body ).on( 'updated_checkout', bmwFrontEnd.init );\r\n});\r\n"],"names":["jQuery","$","bmwFrontEnd","init","bmwPublicParams","person_type","person_type_fields","maskedinput","document","body","on","this","val","maskBilling","unmaskBilling","maskShipping","unmaskShipping","maskGeneral","select2","handleFields","personType","checkCountry","let","country","hide","removeClass","show","addClass","remove","append","required","maybeRunHandleFields","updateBillingFieldsArgs","only_brazil","updateBillingPersonFieldArgs","current","maskedinput_phone","maskPhone","mask","attr","unmask","selector","MaskBehavior","replace","length","$element","maskOptions","onKeyPress","e","field","options","apply","arguments"],"mappings":"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"}