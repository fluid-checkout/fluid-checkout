{"version":3,"file":"../../woocommerce-extra-checkout-fields-for-brazil/frontend-209-beta-2.min.js","sources":["woocommerce-extra-checkout-fields-for-brazil/frontend-209-beta-2.js"],"sourcesContent":["/* global wcbcf_public_params */\r\n/*jshint devel: true */\r\njQuery( function( $ ) {\r\n\r\n\t/**\r\n\t * Frontend actions\r\n\t */\r\n\tvar wc_ecfb_frontend = {\r\n\r\n\t\t/**\r\n\t\t * Initialize frontend actions\r\n\t\t */\r\n\t\tinit: function() {\r\n\t\t\tif ( '0' === wcbcf_public_params.sort_state_country ) {\r\n\t\t\t\t$( document.body ).on( 'country_to_state_changing', this.country_to_state_changing );\r\n\t\t\t}\r\n\r\n\t\t\tif ( '0' !== wcbcf_public_params.person_type ) {\r\n\t\t\t\tthis.person_type_fields();\r\n\t\t\t}\r\n\r\n\t\t\tif ( 'yes' === wcbcf_public_params.maskedinput ) {\r\n\t\t\t\t$( document.body ).on( 'change', '#billing_country', function() {\r\n\t\t\t\t\tif ( 'BR' === $( this ).val() ) {\r\n\t\t\t\t\t\twc_ecfb_frontend.maskBilling();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\twc_ecfb_frontend.unmaskBilling();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$( document.body ).on( 'change', '#shipping_country', function() {\r\n\t\t\t\t\tif ( 'BR' === $( this ).val() ) {\r\n\t\t\t\t\t\twc_ecfb_frontend.maskShipping();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\twc_ecfb_frontend.unmaskShipping();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.maskGeneral();\r\n\t\t\t}\r\n\r\n\t\t\tif ( 'yes' === wcbcf_public_params.mailcheck ) {\r\n\t\t\t\tthis.emailCheck();\r\n\t\t\t}\r\n\r\n\t\t\t// Check if select2 exists.\r\n\t\t\tif ( $().select2 ) {\r\n\t\t\t\t$( '.wc-ecfb-select' ).select2();\r\n\t\t\t}\r\n\t\t\tif ($('#billing_country').val() === 'BR' ) {\r\n\t\t\t\twc_ecfb_frontend.maskBilling();\r\n\t\t\t}\r\n\t\t\t// CHANGE: Also mask shipping when initializing\r\n\t\t\tif ($('#shipping_country').val() === 'BR' ) {\r\n\t\t\t\twc_ecfb_frontend.maskShipping();\r\n\t\t\t}\r\n\r\n\t\t\t// CHANGE: Apply billing country changes to fields on initialization\r\n\t\t\t$( document.body ).on( 'updated_checkout', wc_ecfb_frontend.billing_country_change );\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Country to state changing.\r\n\t\t * Fix the fields order.\r\n\t\t */\r\n\t\tcountry_to_state_changing: function() {\r\n\t\t\t// Billing.\r\n\t\t\t$( '#billing_state_field label' ).html( wcbcf_public_params.state + ' <abbr class=\"required\" title=\"' + wcbcf_public_params.required + '\">*</abbr>' );\r\n\t\t\t$( '#billing_postcode_field' ).insertAfter( '#billing_country_field' );\r\n\r\n\t\t\t// Shipping.\r\n\t\t\tif ( $( '#shipping_state_field' ).length ) {\r\n\t\t\t\t$( '#shipping_state_field label' ).html( wcbcf_public_params.state + ' <abbr class=\"required\" title=\"' + wcbcf_public_params.required + '\">*</abbr>' );\r\n\t\t\t\t$( '#shipping_postcode_field' ).insertAfter( '#shipping_country_field' );\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// CHANGE: Move billing country change handler function to a named function that can be reused\r\n\t\tbilling_country_change: function () {\r\n\t\t\t// CHANGE: Get value from the field element directly, instead of using reference from `this` keyword\r\n\t\t\tvar current = $( '#billing_country' ).val();\r\n\r\n\t\t\tif ( 'BR' === current ) {\r\n\t\t\t\t$( '.person-type-field label .required' ).remove();\r\n\t\t\t\t$( '.person-type-field' ).addClass( 'validate-required' );\r\n\t\t\t\t$( '.person-type-field label' ).append( ' <abbr class=\"required\" title=\"' + wcbcf_public_params.required + '\">*</abbr>' );\r\n\t\t\t} else {\r\n\t\t\t\t$( '.person-type-field' ).removeClass( 'validate-required' );\r\n\t\t\t\t$( '.person-type-field label .required' ).remove();\r\n\t\t\t}\r\n\r\n\t\t\t// CHANGE: Do not trigger field `change` event after updating the field attributes\r\n\t\t\t// to prevent an infinite loop where the `change` event triggers the `update_checkout` event,\r\n\t\t\t// which in turn, would run this code again and trigger the field `change` event, and so on.\r\n\t\t},\r\n\r\n\t\tperson_type_fields: function() {\r\n\t\t\t// Required fields.\r\n\t\t\tif ( 'no' === wcbcf_public_params.only_brazil ) {\r\n\t\t\t\t$( '.person-type-field label .required' ).remove();\r\n\t\t\t\t$( '.person-type-field' ).addClass( 'validate-required' );\r\n\t\t\t\t$( '.person-type-field label' ).append( ' <abbr class=\"required\" title=\"' + wcbcf_public_params.required + '\">*</abbr>' );\r\n\t\t\t} else {\r\n\t\t\t\t// CHANGE: Use billing country change handler from named function\r\n\t\t\t\t$( '#billing_country' ).on( 'change', wc_ecfb_frontend.billing_country_change );\r\n\t\t\t}\r\n\r\n\t\t\tif ( '1' === wcbcf_public_params.person_type ) {\r\n\t\t\t\t$( '#billing_persontype' ).on( 'change', function () {\r\n\t\t\t\t\tvar current = $( this ).val();\r\n\r\n\t\t\t\t\t$( '#billing_cpf_field' ).hide();\r\n\t\t\t\t\t$( '#billing_rg_field' ).hide();\r\n\t\t\t\t\t$( '#billing_company_field' ).hide();\r\n\t\t\t\t\t$( '#billing_cnpj_field' ).hide();\r\n\t\t\t\t\t$( '#billing_ie_field' ).hide();\r\n\r\n\t\t\t\t\tif ( '1' === current ) {\r\n\t\t\t\t\t\t$( '#billing_cpf_field' ).show();\r\n\t\t\t\t\t\t$( '#billing_rg_field' ).show();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( '2' === current ) {\r\n\t\t\t\t\t\t$( '#billing_company_field' ).show();\r\n\t\t\t\t\t\t$( '#billing_cnpj_field' ).show();\r\n\t\t\t\t\t\t$( '#billing_ie_field' ).show();\r\n\r\n\t\t\t\t\t\t// CHANGE: Maybe make company field `required` on the frontend in cases which\r\n\t\t\t\t\t\t// the company field is validated as required on the server-side.\r\n\t\t\t\t\t\tvar currentCountry = $( '#billing_country' ).val();\r\n\t\t\t\t\t\t$( '#billing_company_field label .optional' ).remove();\r\n\t\t\t\t\t\t$( '#billing_company_field label .required' ).remove();\r\n\t\t\t\t\t\tif ( 'no' === wcbcf_public_params.only_brazil || 'BR' === currentCountry ) {\r\n\t\t\t\t\t\t\t$( '#billing_company_field' ).addClass( 'validate-required' );\r\n\t\t\t\t\t\t\t$( '#billing_company_field label' ).append( ' <abbr class=\"required\" title=\"' + wcbcf_public_params.required + '\">*</abbr>' );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t$( '#billing_company_field' ).removeClass( 'validate-required' );\r\n\t\t\t\t\t\t\t$( '#billing_company_field label' ).append( '<span class=\"optional\">(' + wcbcf_public_params.optional + ')</span>' );\r\n\r\n\t\t\t\t\t\t\t// Maybe clear Fluid Checkout inline validation results for the company field\r\n\t\t\t\t\t\t\tif ( window.CheckoutValidation ) {\r\n\t\t\t\t\t\t\t\tCheckoutValidation.clearValidationResults( document.querySelector( '#billing_company' ), document.querySelector( '#billing_company_field' ) );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}c\r\n\t\t\t\t\t}\r\n\t\t\t\t}).change();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tmaskBilling: function() {\r\n\t\t\twc_ecfb_frontend.maskPhone( '#billing_phone, #billing_cellphone' );\r\n\t\t\t$( '#billing_birthdate' ).mask( '00/00/0000' );\r\n\t\t\t$( '#billing_postcode' ).mask( '00000-000' );\r\n\t\t\t$( '#billing_phone, #billing_cellphone, #billing_birthdate, #billing_postcode' ).attr( 'type', 'tel' );\r\n\t\t},\r\n\r\n\t\tunmaskBilling: function() {\r\n\t\t\t$( '#billing_phone, #billing_cellphone, #billing_birthdate, #billing_postcode' ).unmask().attr( 'type', 'text' );\r\n\t\t},\r\n\r\n\t\tmaskShipping: function() {\r\n\t\t\t// CHANGE: Add mask to shipping phone if field exists\r\n\t\t\twc_ecfb_frontend.maskPhone( '#shipping_phone' );\r\n\t\t\t$( '#shipping_postcode' ).mask( '00000-000' ).attr( 'type', 'tel' );\r\n\t\t},\r\n\r\n\t\tunmaskShipping: function() {\r\n\t\t\t// CHANGE: Remove mask from shipping phone if field exists\r\n\t\t\t$( '#shipping_postcode', '#shipping_phone' ).unmask().attr( 'type', 'text' );\r\n\t\t},\r\n\r\n\t\tmaskGeneral: function() {\r\n\t\t\t$( '#billing_cpf, #credit-card-cpf' ).mask( '000.000.000-00' );\r\n\t\t\t$( '#billing_cnpj' ).mask( '00.000.000/0000-00' );\r\n\t\t\twc_ecfb_frontend.maskPhone( '#credit-card-phone' );\r\n\t\t},\r\n\r\n\t\tmaskPhone: function(selector) {\r\n\t\t\tvar $element = $(selector),\r\n\t\t\t\t\tMaskBehavior = function(val) {\r\n\t\t\t\t\t\treturn val.replace(/\\D/g, '').length === 11 ? '(00) 00000-0000' : '(00) 0000-00009';\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmaskOptions = {\r\n\t\t\t\t\t\tonKeyPress: function(val, e, field, options) {\r\n\t\t\t\t\t\t\tfield.mask(MaskBehavior.apply({}, arguments), options);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t$element.mask(MaskBehavior, maskOptions);\r\n\t\t},\r\n\r\n\t\temailCheck: function() {\r\n\t\t\tif ( $( '#wcbcf-mailsuggest' ).length < 1 ) {\r\n\t\t\t\t$( '#billing_email' ).after( '<div id=\"wcbcf-mailsuggest\"></div>' );\r\n\t\t\t}\r\n\r\n\t\t\t$( '#billing_email' ).on( 'blur', function () {\r\n\t\t\t\t$( '#wcbcf-mailsuggest' ).html( '' );\r\n\t\t\t\t$( this ).mailcheck({\r\n\t\t\t\t\tsuggested: function( element, suggestion ) {\r\n\t\t\t\t\t\t$( '#wcbcf-mailsuggest' ).html( 'VocÃª quis dizer: ' + suggestion.full + '?' );\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\t$( '#wcbcf-mailsuggest' ).css({\r\n\t\t\t\tcolor: '#c00',\r\n\t\t\t\tfontSize: 'small'\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\twc_ecfb_frontend.init();\r\n\r\n\t// CHANGE: Also run initialization after every checkout update as sections with affected fields might have have been replaced\r\n\t$( document.body ).on( 'updated_checkout', function() { wc_ecfb_frontend.init() } );\r\n});\r\n"],"names":["jQuery","$","wc_ecfb_frontend","init","wcbcf_public_params","sort_state_country","document","body","on","this","country_to_state_changing","person_type","person_type_fields","maskedinput","val","maskBilling","unmaskBilling","maskShipping","unmaskShipping","maskGeneral","mailcheck","emailCheck","select2","billing_country_change","html","state","required","insertAfter","length","remove","addClass","append","removeClass","only_brazil","current","hide","show","currentCountry","optional","window","CheckoutValidation","clearValidationResults","querySelector","c","change","maskPhone","mask","attr","unmask","selector","MaskBehavior","replace","$element","onKeyPress","e","field","options","apply","arguments","after","suggested","element","suggestion","full","css","color","fontSize"],"mappings":"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"}