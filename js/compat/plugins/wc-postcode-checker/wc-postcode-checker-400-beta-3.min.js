jQuery(function(a){let l={},_={};"undefined"!=typeof wc_myparcel_frontend&&void 0!==wc_myparcel_frontend.isUsingSplitAddressFields&&(window.myparcel_is_using_split_address_fields=wc_myparcel_frontend.isUsingSplitAddressFields=!0),"undefined"!=typeof wcmp_display_settings&&void 0!==wcmp_display_settings.isUsingSplitAddressFields&&(window.myparcel_is_using_split_address_fields=wcmp_display_settings.isUsingSplitAddressFields=!0,window.postnl_is_using_split_address_fields=!0),a.each(["billing","shipping"],function(e,i){0==a("#"+i+"_country").length&&0<a(".woocommerce-"+i+"-fields").length&&a(".woocommerce-"+i+"-fields").append('<input id="'+i+'_country" class="country_to_state" value="NL" type="hidden">')});function o(e,i,r){var o,t,n,s,d,l,_,c;-1!==a.inArray(i,wpo_wcnlpc.postcode_field_countries)?("NL"==i?("hide"!=wpo_wcnlpc.street_city_visibility&&"readonly"!=wpo_wcnlpc.street_city_visibility||r.find("#billing_street_name_field, #shipping_street_name_field, #billing_city_field, #shipping_city_field").find("input").attr("readonly",!0),"hide"==wpo_wcnlpc.street_city_visibility&&r.find("#billing_street_name_field, #shipping_street_name_field, #billing_city_field, #shipping_city_field").hide()):(r.find("#billing_street_name_field, #shipping_street_name_field, #billing_city_field, #shipping_city_field").show().find("input").attr("readonly",!1),r.find(".wcnlpc-error, .wcnlpc-address, .wcnlpc-manual").remove()),o=r.find("#billing_postcode_field, #shipping_postcode_field"),t=r.find("#billing_city_field, #shipping_city_field"),r.find("#billing_state_field, #shipping_state_field"),r.find("#billing_email_field"),r.find("#billing_phone_field"),n=r.find("#billing_address_1_field, #shipping_address_1_field"),r.find("#billing_address_2_field, #shipping_address_2_field"),s=r.find("#billing_street_name_field, #shipping_street_name_field"),d=r.find("#billing_house_number_field, #shipping_house_number_field"),l=r.find("#billing_house_number_suffix_field, #shipping_house_number_suffix_field"),_=r.find("#shipping_postcode_field").length?"shipping":"billing",o.removeClass("form-row-first form-row-last form-row-wide").addClass(wpo_wcnlpc.field_classes[_].postcode),d.removeClass("form-row-first form-row-last form-row-quart-first form-row-quart").addClass(wpo_wcnlpc.field_classes[_].house_number),l.removeClass("form-row-first form-row-last form-row-quart-first form-row-quart").addClass(wpo_wcnlpc.field_classes[_].house_number_suffix),a("#order_comments_field").addClass("form-row-wide"),o.insertBefore(n),"NL"==i?(d.insertAfter(o),l.insertAfter(d),s.insertBefore(t),t.data("priority")&&(i=Math.min(t.data("priority"),t.attr("data-priority")),s.data("priority",i-1).attr("data-priority",i-1)),n.data("priority")&&(c=n.data("priority"),o.data("priority",c-3).attr("data-priority",c-3),d.data("priority",c-2).attr("data-priority",c-2),l.data("priority",c-1).attr("data-priority",c-1))):(d.insertAfter(s),l.insertAfter(d),o.insertAfter(l),n.data("priority")&&(c=n.data("priority"),d.data("priority",c-3).attr("data-priority",c-3),l.data("priority",c-2).attr("data-priority",c-2),o.data("priority",c-1).attr("data-priority",c-1)),"one_line"==wpo_wcnlpc.checkout_layout&&o.removeClass("form-row-first").addClass("form-row-last")),s.removeClass("form-row-first form-row-last").addClass(wpo_wcnlpc.field_classes[_].street_name)):(r.find("#billing_city_field, #shipping_city_field").show().find("input").attr("readonly",!1),r.find(".wcnlpc-error, .wcnlpc-address, .wcnlpc-manual").remove()),a(".wcnlpc-error, .wcnlpc-address, .wcnlpc-manual").each(function(e){var i=a("#"+a(this).data("position_before"));i.length&&i.before(a(this))})}a(document.body).on("country_to_state_changing",o).on("updated_checkout",function(){a("#billing_postcode_field, #shipping_postcode_field").each(function(e){var i=a(this).closest(".form-row").parent(),r=a(this).closest(".form-row").parent().find("#billing_country, #shipping_country").val();o(0,r,i)})}).on("init_checkout",function(){a("#billing_country, #shipping_country, .country_to_state").trigger("change")}).on("change","#ship-to-different-address input",function(){a(this).is(":checked")&&a("#shipping_postcode_field input").trigger("get_postcode")}),a("#billing_country, #shipping_country, .country_to_state").trigger("change");let n={},t=(a(document).on("keydown paste change get_postcode","#billing_postcode_field input, #shipping_postcode_field input, #billing_house_number_field input, #shipping_house_number_field input, #billing_house_number_suffix_field input, #shipping_house_number_suffix_field input",function(t){var e=-1<t.target.id.indexOf("billing")?"billing":"shipping",i="keydown"==t.type?1e3:0;e in n&&clearTimeout(n[e]),n[e]=setTimeout(function(){var e=t,i=(window.myparcel_checkout_updating=!0,-1<e.target.id.indexOf("billing")?"billing_":"shipping_"),e=a("#"+e.target.id).closest(".form-row").parent(),r=a("#"+i+"country").val();if("NL"==r){"show"!=wpo_wcnlpc.street_city_visibility&&"readonly"!=wpo_wcnlpc.street_city_visibility||(e=>{"show"==wpo_wcnlpc.street_city_visibility&&a(e).attr("readonly",!0),a(e).addClass("wcnlpc_spinner")})("#"+i+"street_name, #"+i+"city");var r=a("#"+i+"postcode").val(),o=a("#"+i+"house_number").val(),n=a("#"+i+"house_number_suffix").val();if(a(e).hasClass("wpo_wcnlpc_disabled"))a(e).find("#billing_postcode_field, #shipping_postcode_field, #billing_house_number_field, #shipping_house_number_field").removeClass("woocommerce-invalid woocommerce-invalid-required-field").addClass("woocommerce-validated"),p("#"+i+"street_name, #"+i+"city");else if(void 0!==r&&void 0!==o&&(0<r.length&&0<o.length)){a(e).find(".wcnlpc-error").length<1&&(s=a("#"+i+"postcode").closest(".form-row"),d=a('<div class="wcnlpc-error" style="color: red;"></div>').data("position_before",s.attr("id")),s.before(d));var s={security:wpo_wcnlpc.nonce,postcode:r,house_number:o,house_number_suffix:n},d={form_parent:e,form_prefix:i};let t=s.postcode+s.house_number+s.house_number_suffix;void 0!==_[t]?c(_[t],d):l[i]=a.ajax({type:"POST",url:wpo_wcnlpc.ajaxurl+"?action=wpo_wcnlpc_api_request",data:s,dataType:"json",context:d,timeout:wpo_wcnlpc.xhr_timeout,beforeSend:function(){void 0!==l[this.form_prefix]&&l[this.form_prefix].abort(),a("#"+this.form_prefix+"street_name_field, #"+this.form_prefix+"city_field").removeClass("wcnlpc-validated wcnlpc-not-found")},success:function(e,i,r){var o;c(e,this),_[t]=e,wpo_wcnlpc.current_user_is_admin&&!1===e.success&&(e='<div class="woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout"><ul class="woocommerce-error" role="alert"><li><strong>'+wpo_wcnlpc.response_error_labels.message+":</strong> "+e.data.message+"</li><li><strong>"+wpo_wcnlpc.response_error_labels.error_code+":</strong> "+e.data.error_code+"</li></ul></div>",(o=a("body").find("form.checkout")).closest(".woocommerce").find(".woocommerce-NoticeGroup").remove(),a(e).prependTo(o))},error:function(e,i,r){"abort"!=i&&("show"!=wpo_wcnlpc.street_city_visibility&&"readonly"!=wpo_wcnlpc.street_city_visibility||p("#"+this.form_prefix+"street_name, #"+this.form_prefix+"city"),m(this.form_prefix),"hide"!=wpo_wcnlpc.street_city_visibility&&"readonly"!=wpo_wcnlpc.street_city_visibility||f(this.form_prefix))}})}else p("#"+i+"street_name, #"+i+"city")}},i)}),{});function c(e,i){if("show"!=wpo_wcnlpc.street_city_visibility&&"readonly"!=wpo_wcnlpc.street_city_visibility||p("#"+i.form_prefix+"street_name, #"+i.form_prefix+"city"),"hide"!=wpo_wcnlpc.street_city_visibility&&"readonly"!=wpo_wcnlpc.street_city_visibility||s(i.form_prefix),e)if(a(i.form_parent).hasClass("wpo_wcnlpc_disabled"))a(i.form_parent).find("#billing_postcode_field, #shipping_postcode_field, #billing_house_number_field, #shipping_house_number_field").removeClass("woocommerce-invalid woocommerce-invalid-required-field").addClass("woocommerce-validated");else{var r,o;if(void 0!==e.success&&!0===e.success)a(i.form_parent).find(".wcnlpc-error, .wcnlpc-manual").remove(),a("#"+i.form_prefix+"postcode_field, #"+i.form_prefix+"house_number_field").removeClass("woocommerce-invalid woocommerce-invalid-required-field").addClass("woocommerce-validated"),a("#"+i.form_prefix+"street_name").val(e.data.street),a("#"+i.form_prefix+"street_name").trigger("keydown").trigger("change"),a("#"+i.form_prefix+"city").val(e.data.city),a("#"+i.form_prefix+"city").trigger("keydown").trigger("change"),a("#"+i.form_prefix+"street_name_field, #"+i.form_prefix+"city_field").addClass("wcnlpc-validated"),"hide"==wpo_wcnlpc.street_city_visibility&&(a(i.form_parent).find(".wcnlpc-address").length<1&&(o=a("#"+i.form_prefix+"street_name").closest(".form-row"),r=a('<p class="wcnlpc-address" style="clear:both;"></p>').data("position_before",o.attr("id")),o.before(r)),o=d(i.form_prefix),a(i.form_parent).find(".wcnlpc-address").html(o+", "+e.data.city)),m(i.form_prefix);else if(void 0!==e.success&&!1===e.success){switch(a(i.form_parent).find(".wcnlpc-address").remove(),a(i.form_parent).find(".wcnlpc-error").html(""),e.data.error_code){case"Postcode_Invalid":a("#"+i.form_prefix+"postcode_field").removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-required-field"),a("#"+i.form_prefix+"postcode_field").parent().find(".wcnlpc-error").html(e.data.message);break;case"Number_Invalid":a("#"+i.form_prefix+"house_number_field").removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-required-field"),a("#"+i.form_prefix+"postcode_field").parent().find(".wcnlpc-error").html(e.data.message);break;case"Address_Not_Found":a("#"+i.form_prefix+"postcode_field").removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-required-field"),a("#"+i.form_prefix+"house_number_field").removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-required-field");break;case"Connection_Error":case"undefined":a("#"+i.form_prefix+"postcode_field, #"+i.form_prefix+"house_number_field").removeClass("woocommerce-invalid woocommerce-invalid-required-field").addClass("woocommerce-validated");break;default:a("#"+i.form_prefix+"postcode_field").removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-required-field"),a("#"+i.form_prefix+"house_number_field").removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-required-field"),a("#"+i.form_prefix+"postcode_field").parent().find(".wcnlpc-error").html(e.data.message)}a("#"+i.form_prefix+"street_name_field, #"+i.form_prefix+"city_field").addClass("wcnlpc-not-found"),m(i.form_prefix),"Postcode_Invalid"!=e.data.error_code&&"Number_Invalid"!=e.data.error_code?(a(i.form_parent).find(".wcnlpc-manual").length<1&&(r=a("#"+i.form_prefix+"street_name").closest(".form-row"),o=a('<p class="wcnlpc-manual" style="clear:both"></p>').data("position_before",r.attr("id")),r.before(o)),a(i.form_parent).find(".wcnlpc-manual ").html(wpo_wcnlpc.manual),f(i.form_prefix)):(a(i.form_parent).find(".wcnlpc-manual").remove(),"hide"!=wpo_wcnlpc.street_city_visibility&&"readonly"!=wpo_wcnlpc.street_city_visibility||s(i.form_prefix))}else a(i.form_parent).find(".wcnlpc-address").remove(),a(i.form_parent).find(".wcnlpc-error").html(""),a("#"+i.form_prefix+"postcode_field, #"+i.form_prefix+"house_number_field").removeClass("woocommerce-invalid woocommerce-invalid-required-field").addClass("woocommerce-validated");a("body").trigger("wpo_wcnlpc_fields_updated")}}function p(e){"show"==wpo_wcnlpc.street_city_visibility&&a(e).attr("readonly",!1),a(e).removeClass("wcnlpc_spinner")}function f(e){a("#"+e+"street_name_field, #"+e+"city_field").show().find("input").val("").attr("readonly",!1)}function s(e){a("#"+e+"street_name_field, #"+e+"city_field").find("input").attr("readonly",!0),"hide"==wpo_wcnlpc.street_city_visibility&&a("#"+e+"street_name_field, #"+e+"city_field").hide()}function d(e){var i=a("#"+e+"street_name").val(),r=a("#"+e+"house_number").val(),e=a("#"+e+"house_number_suffix").val();let o=i+" "+r;return o=e?o+"-"+e:o}function m(e){window.myparcel_checkout_updating=!1,void 0!==window.update_myparcel_settings?window.update_myparcel_settings():"undefined"!=typeof wc_myparcel_frontend&&void 0!==wc_myparcel_frontend.isUsingSplitAddressFields||"undefined"!=typeof wcmp_display_settings&&void 0!==wcmp_display_settings.isUsingSplitAddressFields?a("#"+e+"address_1").trigger("input"):"undefined"!=typeof MyParcelFrontend&&MyParcelFrontend.hasSplitAddressFields()&&MyParcelFrontend.updateAddress()}a(document).on("keydown paste change recombine_pc_fields","#billing_street_name_field input, #shipping_street_name_field input",function(r){var e=-1<r.target.id.indexOf("billing")?"billing":"shipping",i="keydown"==r.type?250:0;e in n&&clearTimeout(t[e]),t[e]=setTimeout(function(){var e,i;e=-1<(e=r).target.id.indexOf("billing")?"billing_":"shipping_",i=d(e),a("#"+e+"address_1").val(i)},i)}),a("#billing_postcode_field input").trigger("get_postcode"),a("#ship-to-different-address").find("input").is(":checked")&&a("#shipping_postcode_field input").trigger("get_postcode")});