((e,t)=>{"function"==typeof define&&define.amd?define([],t()):"object"==typeof exports?module.exports=t():e.FCEnhancedSelect=t()})("undefined"!=typeof global?global:this.window||this.global,function(e){function t(){return s(this).each(function(e,t){a.enhanceFields(t)}),this}function r(){this.focus_node.setAttribute("autocomplete","off-"+Date.now())}function i(){var e;FCUtils.isCurrentBreakpointOrSmaller("phablet")&&(e=this.focus_node.closest(d.formRowSelector))&&FCUtils.scrollToElement(e,null,30)}function n(e){e.target.closest(d.inputFieldSelector)&&(e=e.target.closest(d.wrapperElementSelector).parentNode.querySelector("select"),p(e))}function l(e){e.target.closest(d.inputFieldSelector)&&(e=e.target.closest(d.wrapperElementSelector).parentNode.querySelector("select"),m(e))}function o(e){var t;e.target.closest(d.wrapperElementSelector)&&(e=e.target.closest(d.wrapperElementSelector).parentNode.querySelector("select")).tomselect&&(e=e)&&(t=f(e),e.tomselect.setValue(t,!0))}function c(e){var t,n;e.target.closest(d.wrapperElementSelector)&&(e=e.target.closest(d.wrapperElementSelector).parentNode.querySelector("select"),t=e)&&t.tomselect&&(n=t.tomselect.isOpen,requestAnimationFrame(function(){(n?m:p)(t)}))}var s=jQuery,u=!1,a={},d={bodyClass:"has-fc-enhanced-select",formRowSelector:".form-row.fc-select2-field",selectFieldSelector:".fc-select2-field select",wrapperElementSelector:".ts-wrapper",inputFieldSelector:".ts-control > input",fieldSettings:{maxOptions:999999,create:!1,diacritics:!0,openOnFocus:!1},fieldPluginsSingle:[],fieldPluginsMulti:["remove_button"]},f=(null!=s&&(s.fn.select2=t,s.fn.selectWoo=t),function(e){if(e&&e.options){for(var t,n=[],l=e.options,o=0;o<l.length;o++)(t=l[o]).selected&&n.push(t.value||t.text);return n=1===n.length?n[0]:n}}),p=function(e){e&&e.tomselect&&!(e=e.tomselect).isOpen&&e.open()},m=function(e){e&&e.tomselect&&(e=e.tomselect).isOpen&&e.close()};a.enhanceFields=function(e,t){if("undefined"!=typeof TomSelect&&("string"==typeof(e=null==e?d.selectFieldSelector:e)||"object"==typeof e&&e.matches("select"))){null==t&&(t=d.fieldSettings);var n=[e];if("string"==typeof e)try{n=document.querySelectorAll(e)}catch(e){return void console.warn("Enhanced select: "+e.message)}for(var l=0;l<n.length;l++){var o=n[l],c=f(o),s=o.hasAttribute("multiple"),s=(o.tomselect&&o.tomselect.destroy(),t.plugins=s?d.fieldPluginsMulti:d.fieldPluginsSingle,new TomSelect(o,t));s.setValue(c,!0),s.on("focus",r),s.on("blur",r),s.on("dropdown_open",i)}}};return a.init=function(e){u||(d=FCUtils.extendObject(d,e),document.addEventListener("click",c,!0),document.addEventListener("change",o,!0),document.addEventListener("focus",n,!0),document.addEventListener("blur",l,!0),a.enhanceFields(),document.body.classList.add(d.bodyClass),u=!0)},a});