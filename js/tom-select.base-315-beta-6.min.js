!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).TomSelect=e()}(this,function(){"use strict";function n(t,e){t.split(/\s+/).forEach(t=>{e(t)})}class j{constructor(){this._events=void 0,this._events={}}on(t,i){n(t,t=>{var e=this._events[t]||[];e.push(i),this._events[t]=e})}off(t,i){var s=arguments.length;0===s?this._events={}:n(t,t=>{var e;1===s?delete this._events[t]:void 0!==(e=this._events[t])&&(e.splice(e.indexOf(i),1),this._events[t]=e)})}trigger(t,...e){var i=this;n(t,t=>{t=i._events[t];void 0!==t&&t.forEach(t=>{t.apply(i,e)})})}}const o=t=>{return(t=t.filter(Boolean)).length<2?t[0]||"":1==t.reduce((t,e)=>Math.max(t,q(e)),0)?"["+t.join("")+"]":"(?:"+t.join("|")+")"},l=i=>{if(t=i,new Set(t).size===t.length)return i.join("");var t;let s="",n=0;const r=()=>{1<n&&(s+="{"+n+"}")};return i.forEach((t,e)=>{t===i[e-1]?n++:(r(),s+=t,n=1)}),r(),s},a=t=>{t=e(t);return o(t)},O=t=>(t+"").replace(/([\$\(\)\*\+\.\?\[\]\^\{\|\}\\])/gu,"\\$1"),q=t=>e(t).length,e=t=>Array.from(t),r=i=>{if(1===i.length)return[[i]];let s=[];var t=i.substring(1);return r(t).forEach(function(t){let e=t.slice(0);e[0]=i.charAt(0)+e[0],s.push(e),(e=t.slice(0)).unshift(i.charAt(0)),s.push(e)}),s},D=[[0,65535]];let g,v;const i={};var s,t={"/":"⁄∕",0:"߀",a:"ⱥɐɑ",aa:"ꜳ",ae:"æǽǣ",ao:"ꜵ",au:"ꜷ",av:"ꜹꜻ",ay:"ꜽ",b:"ƀɓƃ",c:"ꜿƈȼↄ",d:"đɗɖᴅƌꮷԁɦ",e:"ɛǝᴇɇ",f:"ꝼƒ",g:"ǥɠꞡᵹꝿɢ",h:"ħⱨⱶɥ",i:"ɨı",j:"ɉȷ",k:"ƙⱪꝁꝃꝅꞣ",l:"łƚɫⱡꝉꝇꞁɭ",m:"ɱɯϻ",n:"ꞥƞɲꞑᴎлԉ",o:"øǿɔɵꝋꝍᴑ",oe:"œ",oi:"ƣ",oo:"ꝏ",ou:"ȣ",p:"ƥᵽꝑꝓꝕρ",q:"ꝗꝙɋ",r:"ɍɽꝛꞧꞃ",s:"ßȿꞩꞅʂ",t:"ŧƭʈⱦꞇ",th:"þ",tz:"ꜩ",u:"ʉ",v:"ʋꝟʌ",vy:"ꝡ",w:"ⱳ",y:"ƴɏỿ",z:"ƶȥɀⱬꝣ",hv:"ƕ"};for(s in t){var R=t[s]||"";for(let t=0;t<R.length;t++){var H=R.substring(t,t+1);i[H]=s}}const N=new RegExp(Object.keys(i).join("|")+"|[̀-ͯ·ʾʼ]","gu"),M=(t,e="NFKD")=>t.normalize(e),m=t=>e(t).reduce((t,e)=>t+z(e),""),z=t=>(t=M(t).toLowerCase().replace(N,t=>i[t]||""),M(t,"NFC"));const B=t=>{const n={};var e,i=(t,e)=>{var i=n[t]||new Set,s=new RegExp("^"+a(i)+"$","iu");e.match(s)||(i.add(O(e)),n[t]=i)};for(e of function*(t){for(var[e,i]of t)for(let t=e;t<=i;t++){var s=String.fromCharCode(t),n=m(s);n==s.toLowerCase()||3<n.length||0!=n.length&&(yield{folded:n,composed:s,code_point:t})}}(t))i(e.folded,e.folded),i(e.folded,e.composed);return n},K=t=>{var e,i=B(t),s={},n=[];for(e in i){var r=i[e];r&&(s[e]=a(r)),1<e.length&&n.push(O(e))}n.sort((t,e)=>e.length-t.length);t=o(n);return v=new RegExp("^"+t,"u"),s},Q=(t,s=1)=>(s=Math.max(s,t.length-1),o(r(t).map(t=>{{var[t,i=1]=[t,s];let e=0;return t=t.map(t=>(g[t]&&(e+=t.length),g[t]||t)),e>=i?l(t):""}}))),G=(t,n=!0)=>{let r=1<t.length?1:0;return o(t.map(e=>{var i=[],s=n?e.length():e.length()-1;for(let t=0;t<s;t++)i.push(Q(e.substrs[t]||"",r));return l(i)}))},J=(t,e)=>{for(const n of e)if(n.start==t.start&&n.end==t.end&&n.substrs.join("")===t.substrs.join("")){let i=t.parts;var s=n.parts.filter(t=>{for(const e of i){if(e.start===t.start&&e.substr===t.substr)return!1;if(1!=t.length&&1!=e.length){if(t.start<e.start&&t.end>e.start)return!0;if(e.start<t.start&&e.end>t.start)return!0}}return!1});if(!(0<s.length))return!0}return!1};class f{constructor(){this.parts=[],this.substrs=[],this.start=0,this.end=0}add(t){t&&(this.parts.push(t),this.substrs.push(t.substr),this.start=Math.min(t.start,this.start),this.end=Math.max(t.end,this.end))}last(){return this.parts[this.parts.length-1]}length(){return this.parts.length}clone(t,e){var i=new f,s=JSON.parse(JSON.stringify(this.parts)),n=s.pop();for(const r of s)i.add(r);s=e.substr.substring(0,t-n.start),e=s.length;return i.add({start:n.start,end:n.start+e,length:e,substr:s}),i}}const U=i=>{void 0===g&&(g=K(D)),i=m(i);let s="",n=[new f];for(let e=0;e<i.length;e++){var r=i.substring(e).match(v),o=i.substring(e,e+1),l=r?r[0]:null;let t=[];var a,d=new Set;for(const h of n){var c,p=h.last();!p||1==p.length||p.end<=e?l?(c=l.length,h.add({start:e,end:e+c,length:c,substr:l}),d.add("1")):(h.add({start:e,end:e+1,length:1,substr:o}),d.add("2")):l?(c=h.clone(e,p),p=l.length,c.add({start:e,end:e+p,length:p,substr:l}),t.push(c)):d.add("3")}if(0<t.length)for(var u of t=t.sort((t,e)=>t.length()-e.length()))J(u,n)||n.push(u);else 0<e&&1==d.size&&!d.has("3")&&(s+=G(n,!1),r=new f,(a=n[0])&&r.add(a.last()),n=[r])}return s+=G(n,!0)},W=(t,e)=>{if(t)return t[e]},X=(t,e)=>{if(t){for(var i,s=e.split(".");(i=s.shift())&&(t=t[i]););return t}},d=(t,e,i)=>{var s;return!t||null==e.regex||-1===(s=(t+="").search(e.regex))?0:(e=e.string.length/t.length,0===s&&(e+=.5),e*i)},c=(t,e)=>{var i=t[e];if("function"==typeof i)return i;i&&!Array.isArray(i)&&(t[e]=[i])},A=(t,e)=>{if(Array.isArray(t))t.forEach(e);else for(var i in t)t.hasOwnProperty(i)&&e(t[i],i)};class Y{constructor(t,e){this.items=void 0,this.settings=void 0,this.items=t,this.settings=e||{diacritics:!0}}tokenize(t,n,e){if(!t||!t.length)return[];const r=[];var o,t=t.split(/\s+/);return e&&(o=new RegExp("^("+Object.keys(e).map(O).join("|")+"):(.*)$")),t.forEach(t=>{let e,i=null,s=null;o&&(e=t.match(o))&&(i=e[1],t=e[2]),0<t.length&&(s=this.settings.diacritics?U(t)||null:O(t))&&n&&(s="\\b"+s),r.push({string:t,regex:s?new RegExp(s,"iu"):null,field:i})}),r}getScoreFunction(t,e){t=this.prepareSearch(t,e);return this._getScoreFunction(t)}_getScoreFunction(t){const n=t.tokens,r=n.length;if(!r)return function(){return 0};const s=t.options.fields,o=t.weights,e=s.length,l=t.getAttrFn;if(!e)return function(){return 1};const a=1===e?function(t,e){var i=s[0].field;return d(l(e,i),t,o[i]||1)}:function(i,s){var t,n=0;return i.field?(t=l(s,i.field),!i.regex&&t?n+=1/e:n+=d(t,i,1)):A(o,(t,e)=>{n+=d(l(s,e),i,t)}),n/e};return 1===r?function(t){return a(n[0],t)}:"and"===t.options.conjunction?function(t){var e,i,s=0;for(i of n){if((e=a(i,t))<=0)return 0;s+=e}return s/r}:function(e){var i=0;return A(n,t=>{i+=a(t,e)}),i/r}}getSortFunction(t,e){t=this.prepareSearch(t,e);return this._getSortFunction(t)}_getSortFunction(i){var t,r=[];const s=this,e=i.options,n=!i.query&&e.sort_empty?e.sort_empty:e.sort;if("function"==typeof n)return n.bind(this);function o(t,e){return"$score"===t?e.score:i.getAttrFn(s.items[e.id],t)}if(n)for(var l of n)!i.query&&"$score"===l.field||r.push(l);if(i.query){t=!0;for(var a of r)if("$score"===a.field){t=!1;break}t&&r.unshift({field:"$score",direction:"desc"})}else r=r.filter(t=>"$score"!==t.field);return r.length?function(t,e){var i;for(i of r){var s,n=i.field;if(s=("desc"===i.direction?-1:1)*(s=o(n,t),n=o(n,e),"number"==typeof s&&"number"==typeof n?n<s?1:s<n?-1:0:(s=m(s+"").toLowerCase(),(n=m(n+"").toLowerCase())<s?1:s<n?-1:0)))return s}return 0}:null}prepareSearch(t,e){const i={};e=Object.assign({},e);if(c(e,"sort"),c(e,"sort_empty"),e.fields){c(e,"fields");const s=[];e.fields.forEach(t=>{"string"==typeof t&&(t={field:t,weight:1}),s.push(t),i[t.field]="weight"in t?t.weight:1}),e.fields=s}return{options:e,query:t.toLowerCase().trim(),tokens:this.tokenize(t,e.respect_word_boundaries,i),total:0,items:[],weights:i,getAttrFn:e.nesting?X:W}}search(t,i){var s,n=this.prepareSearch(t,i);i=n.options,t=n.query;const r=i.score||this._getScoreFunction(n);t.length?A(this.items,(t,e)=>{s=r(t),(!1===i.filter||0<s)&&n.items.push({score:s,id:e})}):A(this.items,(t,e)=>{n.items.push({score:1,id:e})});t=this._getSortFunction(n);return t&&n.items.sort(t),n.total=n.items.length,"number"==typeof i.limit&&(n.items=n.items.slice(0,i.limit)),n}}const b=(t,e)=>{if(Array.isArray(t))t.forEach(e);else for(var i in t)t.hasOwnProperty(i)&&e(t[i],i)},p=t=>{var e;return t.jquery?t[0]:t instanceof HTMLElement?t:Z(t)?((e=document.createElement("template")).innerHTML=t.trim(),e.content.firstChild):document.querySelector(t)},Z=t=>"string"==typeof t&&-1<t.indexOf("<"),u=(t,e)=>{var i=document.createEvent("HTMLEvents");i.initEvent(e,!0,!1),t.dispatchEvent(i)},h=(t,e)=>{Object.assign(t.style,e)},w=(t,...e)=>{var i=tt(e);(t=et(t)).map(e=>{i.map(t=>{e.classList.add(t)})})},C=(t,...e)=>{var i=tt(e);(t=et(t)).map(e=>{i.map(t=>{e.classList.remove(t)})})},tt=t=>{var e=[];return b(t,t=>{"string"==typeof t&&(t=t.trim().split(/[\11\12\14\15\40]/)),Array.isArray(t)&&(e=e.concat(t))}),e.filter(Boolean)},et=t=>t=Array.isArray(t)?t:[t],I=(t,e,i)=>{if(!i||i.contains(t))for(;t&&t.matches;){if(t.matches(e))return t;t=t.parentNode}},it=(t,e=0)=>0<e?t[t.length-1]:t[0],st=(t,e)=>{if(!t)return-1;e=e||t.nodeName;for(var i=0;t=t.previousElementSibling;)t.matches(e)&&i++;return i},F=(i,t)=>{b(t,(t,e)=>{null==t?i.removeAttribute(e):i.setAttribute(e,""+t)})},y=(t,e)=>{t.parentNode&&t.parentNode.replaceChild(e,t)},nt=(t,n)=>{if(null===n)return;if("string"==typeof n){if(!n.length)return;n=new RegExp(n,"i")}const r=t=>{var e,i,s;return 3===t.nodeType?(s=(e=t).data.match(n))&&0<e.data.length?((i=document.createElement("span")).className="highlight",(e=e.splitText(s.index)).splitText(s[0].length),s=e.cloneNode(!0),i.appendChild(s),y(e,i),1):0:(1!==(s=t).nodeType||!s.childNodes||/(script|style)/i.test(s.tagName)||"highlight"===s.className&&"SPAN"===s.tagName||Array.from(s.childNodes).forEach(t=>{r(t)}),0)};r(t)},S="undefined"!=typeof navigator&&/Mac/.test(navigator.userAgent)?"metaKey":"ctrlKey";var rt={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:null,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,shouldOpen:null,maxOptions:50,maxItems:null,hideSelected:null,duplicates:!1,addPrecedence:!1,selectOnTab:!1,preload:null,allowEmptyOption:!1,refreshThrottle:300,loadThrottle:300,loadingClass:"loading",dataAttr:null,optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"ts-wrapper",controlClass:"ts-control",dropdownClass:"ts-dropdown",dropdownContentClass:"ts-dropdown-content",itemClass:"item",optionClass:"option",dropdownParent:null,controlInput:'<input type="text" autocomplete="off" size="1" />',copyClassesToDropdown:!1,placeholder:null,hidePlaceholder:null,shouldLoad:function(t){return 0<t.length},render:{}};const _=t=>null==t?null:x(t),x=t=>"boolean"==typeof t?t?"1":"0":t+"",L=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),ot=(e,i,t)=>{var s,n=e.trigger,r={};e.trigger=function(){var t=arguments[0];if(-1===i.indexOf(t))return n.apply(e,arguments);r[t]=arguments},t.apply(e,[]),e.trigger=n;for(s of i)s in r&&n.apply(e,r[s])},k=(t,e=!1)=>{t&&(t.preventDefault(),e)&&t.stopPropagation()},E=(t,e,i,s)=>{t.addEventListener(e,i,s)},T=(t,e)=>{return!!e&&!!e[t]&&1==(e.altKey?1:0)+(e.ctrlKey?1:0)+(e.shiftKey?1:0)+(e.metaKey?1:0)},P=(t,e)=>{var i=t.getAttribute("id");return i||(t.setAttribute("id",e),e)},lt=t=>t.replace(/[\\"']/g,"\\$&"),$=(t,e)=>{e&&t.append(e)};function at(t,e){var i,r=Object.assign({},rt,e),s=r.dataAttr,o=r.labelField,l=r.valueField,a=r.disabledField,d=r.optgroupField,c=r.optgroupLabelField,p=r.optgroupValueField,n=t.tagName.toLowerCase(),u=t.getAttribute("placeholder")||t.getAttribute("data-placeholder"),h=(u||r.allowEmptyOption||(i=t.querySelector('option[value=""]'))&&(u=i.textContent),{placeholder:u,options:[],optgroups:[],items:[],maxItems:null});if("select"===n){var g,v=h.options,m={},f=1;let n=0;var y=t=>{var t=Object.assign({},t.dataset),e=s&&t[s];return t="string"==typeof e&&e.length?Object.assign(t,JSON.parse(e)):t},O=(t,e)=>{var i,s=_(t.value);null!=s&&(s||r.allowEmptyOption)&&(m.hasOwnProperty(s)?e&&((i=m[s][d])?Array.isArray(i)?i.push(e):m[s][d]=[i,e]:m[s][d]=e):((i=y(t))[o]=i[o]||t.textContent,i[l]=i[l]||s,i[a]=i[a]||t.disabled,i[d]=i[d]||e,i.$option=t,i.$order=i.$order||++n,m[s]=i,v.push(i)),t.selected)&&h.items.push(s)};h.maxItems=t.hasAttribute("multiple")?null:1,b(t.children,t=>{var e,i,s;"optgroup"===(g=t.tagName.toLowerCase())?((s=y(e=t))[c]=s[c]||e.getAttribute("label")||"",s[p]=s[p]||f++,s[a]=s[a]||e.disabled,s.$order=s.$order||++n,h.optgroups.push(s),i=s[p],b(e.children,t=>{O(t,i)})):"option"===g&&O(t)})}else(i=t.getAttribute(s))?(h.options=JSON.parse(i),b(h.options,t=>{h.items.push(t[l])})):(i=t.value.trim()||"",(r.allowEmptyOption||i.length)&&(i=i.split(r.delimiter),b(i,t=>{var e={};e[o]=t,e[l]=t,h.options.push(e)}),h.items=i));return Object.assign({},rt,h,e)}var V,dt=0;class ct extends(V=j,V.plugins={},class extends V{constructor(...t){super(...t),this.plugins={names:[],settings:{},requested:{},loaded:{}}}static define(t,e){V.plugins[t]={name:t,fn:e}}initializePlugins(t){var e,i;const s=this,n=[];if(Array.isArray(t))t.forEach(t=>{"string"==typeof t?n.push(t):(s.plugins.settings[t.name]=t.options,n.push(t.name))});else if(t)for(e in t)t.hasOwnProperty(e)&&(s.plugins.settings[e]=t[e],n.push(e));for(;i=n.shift();)s.require(i)}loadPlugin(t){var e=this.plugins,i=V.plugins[t];if(!V.plugins.hasOwnProperty(t))throw new Error('Unable to find "'+t+'" plugin');e.requested[t]=!0,e.loaded[t]=i.fn.apply(this,[this.plugins.settings[t]||{}]),e.names.push(t)}require(t){var e=this.plugins;if(!this.plugins.loaded.hasOwnProperty(t)){if(e.requested[t])throw new Error('Plugin has circular dependency ("'+t+'")');this.loadPlugin(t)}return e.loaded[t]}}){constructor(t,e){super(),this.control_input=void 0,this.wrapper=void 0,this.dropdown=void 0,this.control=void 0,this.dropdown_content=void 0,this.focus_node=void 0,this.order=0,this.settings=void 0,this.input=void 0,this.tabIndex=void 0,this.is_select_tag=void 0,this.rtl=void 0,this.inputId=void 0,this._destroy=void 0,this.sifter=void 0,this.isOpen=!1,this.isDisabled=!1,this.isReadOnly=!1,this.isRequired=void 0,this.isInvalid=!1,this.isValid=!0,this.isLocked=!1,this.isFocused=!1,this.isInputHidden=!1,this.isSetup=!1,this.ignoreFocus=!1,this.ignoreHover=!1,this.hasOptions=!1,this.currentResults=void 0,this.lastValue="",this.caretPos=0,this.loading=0,this.loadedSearches={},this.activeOption=null,this.activeItems=[],this.optgroups={},this.options={},this.userOptions={},this.items=[],this.refreshTimeout=null,dt++;var i=p(t);if(i.tomselect)throw new Error("Tom Select already initialized on this element");i.tomselect=this;var s,t=(window.getComputedStyle&&window.getComputedStyle(i,null)).getPropertyValue("direction"),e=at(i,e),n=(this.settings=e,this.input=i,this.tabIndex=i.tabIndex||0,this.is_select_tag="select"===i.tagName.toLowerCase(),this.rtl=/rtl/i.test(t),this.inputId=P(i,"tomselect-"+dt),this.isRequired=i.required,this.sifter=new Y(this.options,{diacritics:e.diacritics}),e.mode=e.mode||(1===e.maxItems?"single":"multi"),"boolean"!=typeof e.hideSelected&&(e.hideSelected="multi"===e.mode),"boolean"!=typeof e.hidePlaceholder&&(e.hidePlaceholder="multi"!==e.mode),e.createFilter),t=("function"!=typeof n&&((n="string"==typeof n?new RegExp(n):n)instanceof RegExp?e.createFilter=t=>n.test(t):e.createFilter=t=>this.settings.duplicates||!this.options[t]),this.initializePlugins(e.plugins),this.setupCallbacks(),this.setupTemplates(),p("<div>")),r=p("<div>"),o=this._render("dropdown"),l=p('<div role="listbox" tabindex="-1">'),a=this.input.getAttribute("class")||"",d=e.mode;w(t,e.wrapperClass,a,d),w(r,e.controlClass),$(t,r),w(o,e.dropdownClass,d),e.copyClassesToDropdown&&w(o,a),w(l,e.dropdownContentClass),$(o,l),p(e.dropdownParent||t).appendChild(o),Z(e.controlInput)?(s=p(e.controlInput),A(["autocorrect","autocapitalize","autocomplete","spellcheck"],t=>{i.getAttribute(t)&&F(s,{[t]:i.getAttribute(t)})}),s.tabIndex=-1,r.appendChild(s),this.focus_node=s):e.controlInput?(s=p(e.controlInput),this.focus_node=s):(s=p("<input/>"),this.focus_node=r),this.wrapper=t,this.dropdown=o,this.dropdown_content=l,this.control=r,this.control_input=s,this.setup()}setup(){const i=this;var t=i.settings;const s=i.control_input,n=i.dropdown;var e=i.dropdown_content;const r=i.wrapper,o=i.control;var l,a,d,c=i.input,p=i.focus_node,u={passive:!0},h=i.inputId+"-ts-dropdown",h=(F(e,{id:h}),F(p,{role:"combobox","aria-haspopup":"listbox","aria-expanded":"false","aria-controls":h}),P(p,i.inputId+"-ts-control")),g="label[for='"+i.inputId.replace(/['"\\]/g,"\\$&")+"']";const v=document.querySelector(g),m=i.focus.bind(i),f=(v&&(E(v,"click",m),F(v,{for:h}),g=P(v,i.inputId+"-ts-label"),F(p,{"aria-labelledby":g}),F(e,{"aria-labelledby":g})),r.style.width=c.style.width,i.plugins.names.length&&(h="plugin-"+i.plugins.names.join(" plugin-"),w([r,n],h)),(null===t.maxItems||1<t.maxItems)&&i.is_select_tag&&F(c,{multiple:"multiple"}),t.placeholder&&F(s,{placeholder:t.placeholder}),!t.splitOn&&t.delimiter&&(t.splitOn=new RegExp("\\s*"+O(t.delimiter)+"+\\s*")),t.load&&t.loadThrottle&&(t.load=(l=t.load,a=t.loadThrottle,function(t,e){var i=this;d&&(i.loading=Math.max(i.loading-1,0),clearTimeout(d)),d=setTimeout(function(){d=null,i.loadedSearches[t]=!0,l.call(i,t,e)},a)})),E(n,"mousemove",()=>{i.ignoreHover=!1}),E(n,"mouseenter",t=>{var e=I(t.target,"[data-selectable]",n);e&&i.onOptionHover(t,e)},{capture:!0}),E(n,"click",t=>{var e=I(t.target,"[data-selectable]");e&&(i.onOptionSelect(t,e),k(t,!0))}),E(o,"click",t=>{var e=I(t.target,"[data-ts-item]",o);e&&i.onItemSelect(t,e)?k(t,!0):""==s.value&&(i.onClick(),k(t,!0))}),E(p,"keydown",t=>i.onKeyDown(t)),E(s,"keypress",t=>i.onKeyPress(t)),E(s,"input",t=>i.onInput(t)),E(p,"blur",t=>i.onBlur(t)),E(p,"focus",t=>i.onFocus(t)),E(s,"paste",t=>i.onPaste(t)),t=>{var e=t.composedPath()[0];r.contains(e)||n.contains(e)?e==s&&i.isOpen?t.stopPropagation():k(t,!0):(i.isFocused&&i.blur(),i.inputState())}),y=()=>{i.isOpen&&i.positionDropdown()};E(document,"mousedown",f),E(window,"scroll",y,u),E(window,"resize",y,u),this._destroy=()=>{document.removeEventListener("mousedown",f),window.removeEventListener("scroll",y),window.removeEventListener("resize",y),v&&v.removeEventListener("click",m)},this.revertSettings={innerHTML:c.innerHTML,tabIndex:c.tabIndex},c.tabIndex=-1,c.insertAdjacentElement("afterend",i.wrapper),i.sync(!1),t.items=[],delete t.optgroups,delete t.options,E(c,"invalid",()=>{i.isValid&&(i.isValid=!1,i.isInvalid=!0,i.refreshState())}),i.updateOriginalInput(),i.refreshItems(),i.close(!1),i.inputState(),i.isSetup=!0,c.disabled?i.disable():c.readOnly?i.setReadOnly(!0):i.enable(),i.on("change",this.onChange),w(c,"tomselected","ts-hidden-accessible"),i.trigger("initialize"),!0===t.preload&&i.preload()}setupOptions(t=[],e=[]){this.addOptions(t),A(e,t=>{this.registerOptionGroup(t)})}setupTemplates(){var i=this.settings.labelField,s=this.settings.optgroupLabelField;this.settings.render=Object.assign({},{optgroup:t=>{var e=document.createElement("div");return e.className="optgroup",e.appendChild(t.options),e},optgroup_header:(t,e)=>'<div class="optgroup-header">'+e(t[s])+"</div>",option:(t,e)=>"<div>"+e(t[i])+"</div>",item:(t,e)=>"<div>"+e(t[i])+"</div>",option_create:(t,e)=>'<div class="create">Add <strong>'+e(t.input)+"</strong>&hellip;</div>",no_results:()=>'<div class="no-results">No results found</div>',loading:()=>'<div class="spinner"></div>',not_loading:()=>{},dropdown:()=>"<div></div>"},this.settings.render)}setupCallbacks(){var t,e,i={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",item_select:"onItemSelect",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(t in i)(e=this.settings[i[t]])&&this.on(t,e)}sync(t=!0){var e=this,t=t?at(e.input,{delimiter:e.settings.delimiter}):e.settings;e.setupOptions(t.options,t.optgroups),e.setValue(t.items||[],!0),e.lastQuery=null}onClick(){var t=this;0<t.activeItems.length?(t.clearActiveItems(),t.focus()):t.isFocused&&t.isOpen?t.blur():t.focus()}onMouseDown(){}onChange(){u(this.input,"input"),u(this.input,"change")}onPaste(t){var e=this;e.isInputHidden||e.isLocked?k(t):e.settings.splitOn&&setTimeout(()=>{var t=e.inputValue();t.match(e.settings.splitOn)&&(t=t.trim().split(e.settings.splitOn),A(t,t=>{_(t)&&(this.options[t]?e.addItem(t):e.createItem(t))}))},0)}onKeyPress(t){var e,i=this;i.isLocked?k(t):(e=String.fromCharCode(t.keyCode||t.which),i.settings.create&&"multi"===i.settings.mode&&e===i.settings.delimiter&&(i.createItem(),k(t)))}onKeyDown(t){var e,i=this;if(i.ignoreHover=!0,i.isLocked)9!==t.keyCode&&k(t);else{switch(t.keyCode){case 65:if(T(S,t)&&""==i.control_input.value)return k(t),void i.selectAll();break;case 27:return i.isOpen&&(k(t,!0),i.close()),void i.clearActiveItems();case 40:return!i.isOpen&&i.hasOptions?i.open():i.activeOption&&(e=i.getAdjacent(i.activeOption,1))&&i.setActiveOption(e),void k(t);case 38:return i.activeOption&&(e=i.getAdjacent(i.activeOption,-1))&&i.setActiveOption(e),void k(t);case 13:return void(i.canSelect(i.activeOption)?(i.onOptionSelect(t,i.activeOption),k(t)):(i.settings.create&&i.createItem()||document.activeElement==i.control_input&&i.isOpen)&&k(t));case 37:return void i.advanceSelection(-1,t);case 39:return void i.advanceSelection(1,t);case 9:return void(i.settings.selectOnTab&&(i.canSelect(i.activeOption)&&(i.onOptionSelect(t,i.activeOption),k(t)),i.settings.create)&&i.createItem()&&k(t));case 8:case 46:return void i.deleteSelection(t)}i.isInputHidden&&!T(S,t)&&k(t)}}onInput(t){var e,i;this.isLocked||(e=this.inputValue(),this.lastValue!==e&&(""==(this.lastValue=e)?this._onInput():(this.refreshTimeout&&clearTimeout(this.refreshTimeout),this.refreshTimeout=(e=()=>{this.refreshTimeout=null,this._onInput()},0<(i=this.settings.refreshThrottle)?setTimeout(e,i):(e.call(null),null)))))}_onInput(){var t=this.lastValue;this.settings.shouldLoad.call(this,t)&&this.load(t),this.refreshOptions(),this.trigger("type",t)}onOptionHover(t,e){this.ignoreHover||this.setActiveOption(e,!1)}onFocus(t){var e=this,i=e.isFocused;e.isDisabled||e.isReadOnly?(e.blur(),k(t)):e.ignoreFocus||(e.isFocused=!0,"focus"===e.settings.preload&&e.preload(),i||e.trigger("focus"),e.activeItems.length||(e.inputState(),e.refreshOptions(!!e.settings.openOnFocus)),e.refreshState())}onBlur(t){var e,i;!1!==document.hasFocus()&&(e=this).isFocused&&(e.isFocused=!1,e.ignoreFocus=!1,i=()=>{e.close(),e.setActiveItem(),e.setCaret(e.items.length),e.trigger("blur")},e.settings.create&&e.settings.createOnBlur?e.createItem(null,i):i())}onOptionSelect(t,e){var i,s=this;e.parentElement&&e.parentElement.matches("[data-disabled]")||(e.classList.contains("create")?s.createItem(null,()=>{s.settings.closeAfterSelect&&s.close()}):void 0!==(i=e.dataset.value)&&(s.lastQuery=null,s.addItem(i),s.settings.closeAfterSelect&&s.close(),!s.settings.hideSelected)&&t.type&&/click/.test(t.type)&&s.setActiveOption(e))}canSelect(t){return!!(this.isOpen&&t&&this.dropdown_content.contains(t))}onItemSelect(t,e){return!this.isLocked&&"multi"===this.settings.mode&&(k(t),this.setActiveItem(e,t),!0)}canLoad(t){return!!this.settings.load&&!this.loadedSearches.hasOwnProperty(t)}load(t){var e,i=this;i.canLoad(t)&&(w(i.wrapper,i.settings.loadingClass),i.loading++,e=i.loadCallback.bind(i),i.settings.load.call(i,t,e))}loadCallback(t,e){var i=this;i.loading=Math.max(i.loading-1,0),i.lastQuery=null,i.clearActiveOption(),i.setupOptions(t,e),i.refreshOptions(i.isFocused&&!i.isInputHidden),i.loading||C(i.wrapper,i.settings.loadingClass),i.trigger("load",t,e)}preload(){var t=this.wrapper.classList;t.contains("preloaded")||(t.add("preloaded"),this.load(""))}setTextboxValue(t=""){var e=this.control_input;e.value!==t&&(e.value=t,u(e,"update"),this.lastValue=t)}getValue(){return this.is_select_tag&&this.input.hasAttribute("multiple")?this.items:this.items.join(this.settings.delimiter)}setValue(t,e){var i=e?[]:["change"];ot(this,i,()=>{this.clear(e),this.addItems(t,e)})}setMaxItems(t){this.settings.maxItems=t=0===t?null:t,this.refreshState()}setActiveItem(t,e){var i,s,n,r,o,l=this;if("single"!==l.settings.mode)if(t){if("click"===(i=e&&e.type.toLowerCase())&&T("shiftKey",e)&&l.activeItems.length){for(o=l.getLastActive(),o=Array.prototype.indexOf.call(l.control.children,o),(n=Array.prototype.indexOf.call(l.control.children,t))<o&&(r=o,o=n,n=r),s=o;s<=n;s++)t=l.control.children[s],-1===l.activeItems.indexOf(t)&&l.setActiveItemClass(t);k(e)}else"click"===i&&T(S,e)||"keydown"===i&&T("shiftKey",e)?t.classList.contains("active")?l.removeActiveItem(t):l.setActiveItemClass(t):(l.clearActiveItems(),l.setActiveItemClass(t));l.inputState(),l.isFocused||l.focus()}else l.clearActiveItems(),l.isFocused&&l.inputState()}setActiveItemClass(t){var e=this.control.querySelector(".last-active");e&&C(e,"last-active"),w(t,"active last-active"),this.trigger("item_select",t),-1==this.activeItems.indexOf(t)&&this.activeItems.push(t)}removeActiveItem(t){var e=this.activeItems.indexOf(t);this.activeItems.splice(e,1),C(t,"active")}clearActiveItems(){C(this.activeItems,"active"),this.activeItems=[]}setActiveOption(t,e=!0){t!==this.activeOption&&(this.clearActiveOption(),t)&&(this.activeOption=t,F(this.focus_node,{"aria-activedescendant":t.getAttribute("id")}),F(t,{"aria-selected":"true"}),w(t,"active"),e)&&this.scrollToOption(t)}scrollToOption(t,e){var i,s,n,r;t&&(s=(i=this.dropdown_content).clientHeight,n=i.scrollTop||0,r=t.offsetHeight,s+n<(t=t.getBoundingClientRect().top-i.getBoundingClientRect().top+n)+r?this.scroll(t-s+r,e):t<n&&this.scroll(t,e))}scroll(t,e){var i=this.dropdown_content;e&&(i.style.scrollBehavior=e),i.scrollTop=t,i.style.scrollBehavior=""}clearActiveOption(){this.activeOption&&(C(this.activeOption,"active"),F(this.activeOption,{"aria-selected":null})),this.activeOption=null,F(this.focus_node,{"aria-activedescendant":null})}selectAll(){const e=this;var t;"single"!==e.settings.mode&&(t=e.controlChildren()).length&&(e.inputState(),e.close(),e.activeItems=t,A(t,t=>{e.setActiveItemClass(t)}))}inputState(){var t=this;t.control.contains(t.control_input)&&(F(t.control_input,{placeholder:t.settings.placeholder}),0<t.activeItems.length||!t.isFocused&&t.settings.hidePlaceholder&&0<t.items.length?(t.setTextboxValue(),t.isInputHidden=!0):(t.settings.hidePlaceholder&&0<t.items.length&&F(t.control_input,{placeholder:""}),t.isInputHidden=!1),t.wrapper.classList.toggle("input-hidden",t.isInputHidden))}inputValue(){return this.control_input.value.trim()}focus(){var t=this;t.isDisabled||t.isReadOnly||(t.ignoreFocus=!0,(t.control_input.offsetWidth?t.control_input:t.focus_node).focus(),setTimeout(()=>{t.ignoreFocus=!1,t.onFocus()},0))}blur(){this.focus_node.blur(),this.onBlur()}getScoreFunction(t){return this.sifter.getScoreFunction(t,this.getSearchOptions())}getSearchOptions(){var t=this.settings,e=t.sortField;return"string"==typeof t.sortField&&(e=[{field:t.sortField}]),{fields:t.searchField,conjunction:t.searchConjunction,sort:e,nesting:t.nesting}}search(t){var e,i,s=this,n=this.getSearchOptions();if(s.settings.score&&"function"!=typeof(i=s.settings.score.call(s,t)))throw new Error('Tom Select "score" setting must be a function that returns a function');return t!==s.lastQuery?(s.lastQuery=t,e=s.sifter.search(t,Object.assign(n,{score:i})),s.currentResults=e):e=Object.assign({},s.currentResults),s.settings.hideSelected&&(e.items=e.items.filter(t=>{t=_(t.id);return!(t&&-1!==s.items.indexOf(t))})),e}refreshOptions(t=!0){var i,s,e,n,r,o,l,a,d;const c={},p=[];for(var u=this,h=u.inputValue(),g=h===u.lastQuery||""==h&&null==u.lastQuery,v=u.search(h),m=null,f=u.settings.shouldOpen||!1,y=u.dropdown_content,O=(g&&(m=u.activeOption)&&(a=m.closest("[data-group]")),e=v.items.length,0<(e="number"==typeof u.settings.maxOptions?Math.min(e,u.settings.maxOptions):e)&&(f=!0),0);O<e;O++){var b=v.items[O];if(b){var w=b.id,I=u.options[w];if(void 0!==I){b=x(w);let e=u.getOption(b,!0);for(u.settings.hideSelected||e.classList.toggle("selected",u.items.includes(b)),n=I[u.settings.optgroupField]||"",i=0,s=(r=Array.isArray(n)?n:[n])&&r.length;i<s;i++){n=r[i];let t=I.$order;var S=u.optgroups[n],[S,_]=(void 0===S?n="":t=S.$order,((t,e)=>{if(void 0!==(s=c[t])){var i=p[s];if(void 0!==i)return[s,i.fragment]}var i=document.createDocumentFragment(),s=p.length;return p.push({fragment:i,order:e,optgroup:t}),[s,i]})(n,t));0<i&&(e=e.cloneNode(!0),F(e,{id:I.$id+"-clone-"+i,"aria-selected":null}),e.classList.add("ts-cloned"),C(e,"active"),u.activeOption)&&u.activeOption.dataset.value==w&&a&&a.dataset.group===n.toString()&&(m=e),_.appendChild(e),""!=n&&(c[n]=S)}}}}u.settings.lockOptgroupOrder&&p.sort((t,e)=>t.order-e.order),o=document.createDocumentFragment(),A(p,t=>{var e,i,s=t.fragment,t=t.optgroup;s&&s.children.length&&(void 0!==(t=u.optgroups[t])?(e=document.createDocumentFragment(),i=u.render("optgroup_header",t),$(e,i),$(e,s),i=u.render("optgroup",{group:t,options:e}),$(o,i)):$(o,s))}),y.innerHTML="",$(y,o),u.settings.highlight&&(g=(g=y).querySelectorAll("span.highlight"),Array.prototype.forEach.call(g,function(t){var e=t.parentNode;e.replaceChild(t.firstChild,t),e.normalize()}),v.query.length)&&v.tokens.length&&A(v.tokens,t=>{nt(y,t.regex)});g=t=>{t=u.render(t,{input:h});return t&&(f=!0,y.insertBefore(t,y.firstChild)),t};if(u.loading?g("loading"):u.settings.shouldLoad.call(u,h)?0===v.items.length&&g("no_results"):g("not_loading"),(l=u.canCreate(h))&&(d=g("option_create")),u.hasOptions=0<v.items.length||l,f){if(0<v.items.length){if(m||"single"!==u.settings.mode||null==u.items[0]||(m=u.getOption(u.items[0])),!y.contains(m)){let t=0;d&&!u.settings.addPrecedence&&(t=1),m=u.selectable()[t]}}else d&&(m=d);t&&!u.isOpen&&(u.open(),u.scrollToOption(m,"auto")),u.setActiveOption(m)}else u.clearActiveOption(),t&&u.isOpen&&u.close(!1)}selectable(){return this.dropdown_content.querySelectorAll("[data-selectable]")}addOption(t,e=!1){var i,s=this;return Array.isArray(t)?(s.addOptions(t,e),!1):null!==(i=_(t[s.settings.valueField]))&&!s.options.hasOwnProperty(i)&&(t.$order=t.$order||++s.order,t.$id=s.inputId+"-opt-"+t.$order,s.options[i]=t,s.lastQuery=null,e&&(s.userOptions[i]=e,s.trigger("option_add",i,t)),i)}addOptions(t,e=!1){A(t,t=>{this.addOption(t,e)})}registerOption(t){return this.addOption(t)}registerOptionGroup(t){var e=_(t[this.settings.optgroupValueField]);return null!==e&&(t.$order=t.$order||++this.order,this.optgroups[e]=t,e)}addOptionGroup(t,e){e[this.settings.optgroupValueField]=t,(t=this.registerOptionGroup(e))&&this.trigger("optgroup_add",t,e)}removeOptionGroup(t){this.optgroups.hasOwnProperty(t)&&(delete this.optgroups[t],this.clearCache(),this.trigger("optgroup_remove",t))}clearOptionGroups(){this.optgroups={},this.clearCache(),this.trigger("optgroup_clear")}updateOption(t,e){var i=this,t=_(t),s=_(e[i.settings.valueField]);if(null!==t){var n=i.options[t];if(null!=n){if("string"!=typeof s)throw new Error("Value must be set in option data");var r=i.getOption(t),o=i.getItem(t);e.$order=e.$order||n.$order,delete i.options[t],i.uncacheValue(s),i.options[s]=e,r&&(i.dropdown_content.contains(r)&&(n=i._render("option",e),y(r,n),i.activeOption===r)&&i.setActiveOption(n),r.remove()),o&&(-1!==(n=i.items.indexOf(t))&&i.items.splice(n,1,s),r=i._render("item",e),o.classList.contains("active")&&w(r,"active"),y(o,r)),i.lastQuery=null}}}removeOption(t,e){var i=this;t=x(t),i.uncacheValue(t),delete i.userOptions[t],delete i.options[t],i.lastQuery=null,i.trigger("option_remove",t),i.removeItem(t,e)}clearOptions(t){const i=(t||this.clearFilter).bind(this),s=(this.loadedSearches={},this.userOptions={},this.clearCache(),{});A(this.options,(t,e)=>{i(t,e)&&(s[e]=t)}),this.options=this.sifter.items=s,this.lastQuery=null,this.trigger("option_clear")}clearFilter(t,e){return 0<=this.items.indexOf(e)}getOption(t,e=!1){t=_(t);if(null!==t){t=this.options[t];if(null!=t){if(t.$div)return t.$div;if(e)return this._render("option",t)}}return null}getAdjacent(e,i,t="option"){var s;if(e){s="item"==t?this.controlChildren():this.dropdown_content.querySelectorAll("[data-selectable]");for(let t=0;t<s.length;t++)if(s[t]==e)return 0<i?s[t+1]:s[t-1]}return null}getItem(t){return"object"==typeof t?t:null!==(t=_(t))?this.control.querySelector(`[data-value="${lt(t)}"]`):null}addItems(t,e){var i=this,t=Array.isArray(t)?t:[t];const s=(t=t.filter(t=>-1===i.items.indexOf(t)))[t.length-1];t.forEach(t=>{i.isPending=t!==s,i.addItem(t,e)})}addItem(o,l){var t=l?[]:["change","dropdown_close"];ot(this,t,()=>{var t,e,i,s=this,n=s.settings.mode,r=_(o);r&&-1!==s.items.indexOf(r)&&("single"===n&&s.close(),"single"===n||!s.settings.duplicates)||null!==r&&s.options.hasOwnProperty(r)&&("single"===n&&s.clear(l),"multi"===n&&s.isFull()||(i=s._render("item",s.options[r]),s.control.contains(i)&&(i=i.cloneNode(!0)),t=s.isFull(),s.items.splice(s.caretPos,0,r),s.insertAtCaret(i),s.isSetup&&(!s.isPending&&s.settings.hideSelected&&(e=s.getOption(r),e=s.getAdjacent(e,1))&&s.setActiveOption(e),s.isPending||s.settings.closeAfterSelect||s.refreshOptions(s.isFocused&&"single"!==n),0!=s.settings.closeAfterSelect&&s.isFull()?s.close():s.isPending||s.positionDropdown(),s.trigger("item_add",r,i),s.isPending||s.updateOriginalInput({silent:l})),s.isPending&&(t||!s.isFull()))||(s.inputState(),s.refreshState()))})}removeItem(t=null,e){var i,s,n,r=this;(t=r.getItem(t))&&(s=t.dataset.value,n=st(t),t.remove(),t.classList.contains("active")&&(i=r.activeItems.indexOf(t),r.activeItems.splice(i,1),C(t,"active")),r.items.splice(n,1),r.lastQuery=null,!r.settings.persist&&r.userOptions.hasOwnProperty(s)&&r.removeOption(s,e),n<r.caretPos&&r.setCaret(r.caretPos-1),r.updateOriginalInput({silent:e}),r.refreshState(),r.positionDropdown(),r.trigger("item_remove",s,t))}createItem(t=null,i=()=>{}){"function"!=typeof(i=3===arguments.length?arguments[2]:i)&&(i=()=>{});var s=this,n=s.caretPos;if(t=t||s.inputValue(),!s.canCreate(t))return i(),!1;s.lock();var r=!1,e=t=>{var e;return s.unlock(),!t||"object"!=typeof t||"string"!=typeof(e=_(t[s.settings.valueField]))?i():(s.setTextboxValue(),s.addOption(t,!0),s.setCaret(n),s.addItem(e),i(t),void(r=!0))},t="function"==typeof s.settings.create?s.settings.create.call(this,t,e):{[s.settings.labelField]:t,[s.settings.valueField]:t};return r||e(t),!0}refreshItems(){var t=this;t.lastQuery=null,t.isSetup&&t.addItems(t.items),t.updateOriginalInput(),t.refreshState()}refreshState(){var t=this,e=(t.refreshValidityState(),t.isFull()),i=t.isLocked,s=(t.wrapper.classList.toggle("rtl",t.rtl),t.wrapper.classList);s.toggle("focus",t.isFocused),s.toggle("disabled",t.isDisabled),s.toggle("readonly",t.isReadOnly),s.toggle("required",t.isRequired),s.toggle("invalid",!t.isValid),s.toggle("locked",i),s.toggle("full",e),s.toggle("input-active",t.isFocused&&!t.isInputHidden),s.toggle("dropdown-active",t.isOpen),s.toggle("has-options",(i=t.options,0===Object.keys(i).length)),s.toggle("has-items",0<t.items.length)}refreshValidityState(){var t=this;t.input.validity&&(t.isValid=t.input.validity.valid,t.isInvalid=!t.isValid)}isFull(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems}updateOriginalInput(t={}){const s=this;var e,i;const n=s.input.querySelector('option[value=""]');if(s.is_select_tag){const o=[],l=s.input.querySelectorAll("option:checked").length;function r(t,e,i){return(t=t||p('<option value="'+L(e)+'">'+L(i)+"</option>"))!=n&&s.input.append(t),o.push(t),(t!=n||0<l)&&(t.selected=!0),t}s.input.querySelectorAll("option:checked").forEach(t=>{t.selected=!1}),0==s.items.length&&"single"==s.settings.mode?r(n,"",""):s.items.forEach(t=>{e=s.options[t],i=e[s.settings.labelField]||"",o.includes(e.$option)?r(s.input.querySelector(`option[value="${lt(t)}"]:not(:checked)`),t,i):e.$option=r(e.$option,t,i)})}else s.input.value=s.getValue();s.isSetup&&!t.silent&&s.trigger("change",s.getValue())}open(){var t=this;t.isLocked||t.isOpen||"multi"===t.settings.mode&&t.isFull()||(t.isOpen=!0,F(t.focus_node,{"aria-expanded":"true"}),t.refreshState(),h(t.dropdown,{visibility:"hidden",display:"block"}),t.positionDropdown(),h(t.dropdown,{visibility:"visible",display:"block"}),t.focus(),t.trigger("dropdown_open",t.dropdown))}close(t=!0){var e=this,i=e.isOpen;t&&(e.setTextboxValue(),"single"===e.settings.mode)&&e.items.length&&e.inputState(),e.isOpen=!1,F(e.focus_node,{"aria-expanded":"false"}),h(e.dropdown,{display:"none"}),e.settings.hideSelected&&e.clearActiveOption(),e.refreshState(),i&&e.trigger("dropdown_close",e.dropdown)}positionDropdown(){var t,e,i;"body"===this.settings.dropdownParent&&(t=(e=this.control).getBoundingClientRect(),e=e.offsetHeight+t.top+window.scrollY,i=t.left+window.scrollX,h(this.dropdown,{width:t.width+"px",top:e+"px",left:i+"px"}))}clear(t){var e,i=this;i.items.length&&(e=i.controlChildren(),A(e,t=>{i.removeItem(t,!0)}),i.inputState(),t||i.updateOriginalInput(),i.trigger("clear"))}insertAtCaret(t){var e=this.caretPos,i=this.control;i.insertBefore(t,i.children[e]||null),this.setCaret(e+1)}deleteSelection(t){var e,i=this,s=t&&8===t.keyCode?-1:1,n={start:(n=i.control_input).selectionStart||0,length:(n.selectionEnd||0)-(n.selectionStart||0)};const r=[];if(i.activeItems.length)e=it(i.activeItems,s),e=st(e),0<s&&e++,A(i.activeItems,t=>r.push(t));else if((i.isFocused||"single"===i.settings.mode)&&i.items.length){var o=i.controlChildren();let t;s<0&&0===n.start&&0===n.length?t=o[i.caretPos-1]:0<s&&n.start===i.inputValue().length&&(t=o[i.caretPos]),void 0!==t&&r.push(t)}if(!i.shouldDelete(r,t))return!1;for(k(t,!0),void 0!==e&&i.setCaret(e);r.length;)i.removeItem(r.pop());return i.inputState(),i.positionDropdown(),i.refreshOptions(!1),!0}shouldDelete(t,e){t=t.map(t=>t.dataset.value);return!(!t.length||"function"==typeof this.settings.onDelete&&!1===this.settings.onDelete(t,e))}advanceSelection(t,e){var i,s=this;s.rtl&&(t*=-1),s.inputValue().length||(T(S,e)||T("shiftKey",e)?(i=(e=s.getLastActive(t))?e.classList.contains("active")?s.getAdjacent(e,t,"item"):e:0<t?s.control_input.nextElementSibling:s.control_input.previousElementSibling)&&(i.classList.contains("active")&&s.removeActiveItem(e),s.setActiveItemClass(i)):s.moveCaret(t))}moveCaret(t){}getLastActive(t){var e=this.control.querySelector(".last-active");return e||((e=this.control.querySelectorAll(".active"))?it(e,t):void 0)}setCaret(t){this.caretPos=this.items.length}controlChildren(){return Array.from(this.control.querySelectorAll("[data-ts-item]"))}lock(){this.setLocked(!0)}unlock(){this.setLocked(!1)}setLocked(t=this.isReadOnly||this.isDisabled){this.isLocked=t,this.refreshState()}disable(){this.setDisabled(!0),this.close()}enable(){this.setDisabled(!1)}setDisabled(t){this.focus_node.tabIndex=t?-1:this.tabIndex,this.isDisabled=t,this.input.disabled=t,this.control_input.disabled=t,this.setLocked()}setReadOnly(t){this.isReadOnly=t,this.input.readOnly=t,this.control_input.readOnly=t,this.setLocked()}destroy(){var t=this,e=t.revertSettings;t.trigger("destroy"),t.off(),t.wrapper.remove(),t.dropdown.remove(),t.input.innerHTML=e.innerHTML,t.input.tabIndex=e.tabIndex,C(t.input,"tomselected","ts-hidden-accessible"),t._destroy(),delete t.input.tomselect}render(t,e){var i,s,n=this;return"function"==typeof this.settings.render[t]&&(i=n.settings.render[t].call(this,e,L))?(i=p(i),"option"===t||"option_create"===t?e[n.settings.disabledField]?F(i,{"aria-disabled":"true"}):F(i,{"data-selectable":""}):"optgroup"===t&&(s=e.group[n.settings.optgroupValueField],F(i,{"data-group":s}),e.group[n.settings.disabledField])&&F(i,{"data-disabled":""}),"option"!==t&&"item"!==t||(s=x(e[n.settings.valueField]),F(i,{"data-value":s}),"item"===t?(w(i,n.settings.itemClass),F(i,{"data-ts-item":""})):(w(i,n.settings.optionClass),F(i,{role:"option",id:e.$id}),e.$div=i,n.options[s]=e)),i):null}_render(t,e){t=this.render(t,e);if(null==t)throw"HTMLElement expected";return t}clearCache(){A(this.options,t=>{t.$div&&(t.$div.remove(),delete t.$div)})}uncacheValue(t){t=this.getOption(t);t&&t.remove()}canCreate(t){return this.settings.create&&0<t.length&&this.settings.createFilter.call(this,t)}hook(i,t,s){var n=this,r=n[t];n[t]=function(){var t,e;return"after"===i&&(t=r.apply(n,arguments)),e=s.apply(n,arguments),"instead"===i?e:"before"===i?r.apply(n,arguments):t}}}return ct});var tomSelect=function(t,e){return new TomSelect(t,e)};
//# sourceMappingURL=maps/tom-select.base-315-beta-6.min.js.map
