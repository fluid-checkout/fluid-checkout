!function(e,t){"function"==typeof define&&define.amd?define([],t()):"object"==typeof exports?module.exports=t():e.FlyoutBlock=t()}("undefined"!=typeof global?global:this.window||this.global,function(e){"use strict";function n(e){if(!e)return!1;var t=e.getAttribute(r.targetElementAttribute);return t&&""!=t?document.querySelector(t):e.closest(r.flyoutWrapperSelector)}function s(e){var t,o;e.target.closest(r.toggleButtonSelector)?(e.preventDefault(),t=e.target.closest(r.toggleButtonSelector),o=n(t),i.toggle(o)):e.target.closest(r.flyoutToggleClassSelector)?(e.target.closest(r.flyoutTogglePassActionSelector)||e.preventDefault(),(o=function(e){if(!e)return!1;for(var t=0;t<e.classList.length;t++){var o=e.classList[t];if(0==o.indexOf(r.flyoutClassTogglePrefix)){o="#"+o.replace(r.flyoutClassTogglePrefix,"");return document.querySelector(o)}}return!1}(e.target.closest(r.flyoutToggleClassSelector)))&&i.toggle(o)):e.target.closest(r.openButtonSelector)?(e.preventDefault(),t=e.target.closest(r.openButtonSelector),o=n(t),i.open(o)):e.target.closest(r.closeButtonSelector)?(e.preventDefault(),t=e.target.closest(r.closeButtonSelector),o=n(t),i.close(o)):e.target.matches(r.flyoutWrapperSelector)?(o=n(e.target),i.close(o)):e.target.closest(r.overlaySelector)&&i.closeAll()}function l(e){27!=e.keyCode&&27!=e.which&&"Escape"!=e.key&&"Esc"!=e.key||i.closeAll()}function t(e){r=g(c,e);for(var t=document.querySelectorAll(r.flyoutWrapperSelector),o=0;o<t.length;o++)i.initializeElement(t[o]);(e=document.createElement("div")).innerHTML=r.overlayTemplate.trim(),document.body.appendChild(e.childNodes[0]),document.addEventListener("click",s),document.addEventListener("keydown",l,!0),document.body.classList.add(r.bodyHasFlyoutClass),a=!0}var a=!1,i={managers:[]},r={},c={flyoutWrapperSelector:"[data-flyout]",flyoutElementSelector:"[data-flyout-content]",toggleButtonSelector:"[data-flyout-toggle]",openButtonSelector:"[data-flyout-open]",closeButtonSelector:"[data-flyout-close]",overlaySelector:"[data-flyout-overlay]",flyoutTogglePassActionSelector:"[data-flyout-pass-action], .js-flyout-pass-action",flyoutToggleClassSelector:".js-flyout-toggle",flyoutClassTogglePrefix:"js-flyout-target-",idPrefix:"flyout-block",bodyHasFlyoutClass:"has-flyout",bodyHasFlyoutOpenClass:"has-flyout--open",isActivatedClass:"is-activated",isOpenClass:"is-open",openAnimationClass:"slide-in-up",closeAnimationClass:"slide-out-down",targetElementAttribute:"data-flyout-target",openAnimationClassAttribute:"data-flyout-open-animation-class",closeAnimationClassAttribute:"data-flyout-close-animation-class",overlayTemplate:'<div class="flyout-overlay" data-flyout-overlay></div>'},o="open",u="closed",g=function(){var o={},n=!1,e=0;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(n=arguments[0],e++);for(;e<arguments.length;e++)!function(e){for(var t in e)e.hasOwnProperty(t)&&(n&&"[object Object]"===Object.prototype.toString.call(e[t])?o[t]=g(o[t],e[t]):o[t]=e[t])}(arguments[e]);return o};return i.getState=function(e){e=i.getInstance(e);return!!e&&e.state},i.open=function(e){var t=i.getInstance(e);if(!t)return!1;AnimateHelper.doThenAnimate(e,t.settings.openAnimationClass,function(){t.state=o,t.element.classList.add(t.settings.isOpenClass),document.body.classList.add(t.settings.bodyHasFlyoutOpenClass),document.body.classList.add(t.settings.bodyHasFlyoutOpenClass+"-"+t.element.id)})},i.close=function(e){var t=i.getInstance(e);if(!t)return!1;AnimateHelper.doThenAnimate(e,t.settings.closeAnimationClass,function(){t.state=u,t.element.classList.remove(t.settings.isOpenClass),document.body.classList.remove(t.settings.bodyHasFlyoutOpenClass+"-"+t.element.id),i.hasAnyElementOpen()||document.body.classList.remove(t.settings.bodyHasFlyoutOpenClass)})},i.closeAll=function(){for(var e=0;e<i.managers.length;e++){var t=i.managers[e];i.getState(t.element)!=u&&i.close(t.element)}},i.toggle=function(e){i.getState(e)==u?i.open(e):i.close(e)},i.getInstance=function(e){for(var t,o=0;o<i.managers.length;o++){var n=i.managers[o];if(n.element==e){t=n;break}}return t},i.hasAnyElementOpen=function(){for(var e=0;e<i.managers.length;e++)if(i.managers[e].state==o)return!0;return!1},i.initializeElement=function(e){var t={};t.element=e,t.settings=g(r),t.state=u,t.element.id&&""!=t.element.id||(t.element.id=t.settings.idPrefix+"-"+i.managers.length);var o=t.element.getAttribute(t.settings.openAnimationClassAttribute),e=t.element.getAttribute(t.settings.closeAnimationClassAttribute);t.settings.openAnimationClass=o&&""!=o?o:r.openAnimationClass,t.settings.closeAnimationClass=e&&""!=e?e:r.closeAnimationClass,t.isActivated=!0,t.element.classList.add(t.settings.isActivatedClass),i.managers.push(t)},i.init=function(e){a||(window.AnimateHelper?t(e):window.RequireBundle&&RequireBundle.require(["animate-helper"],function(){t(e)}))},i});