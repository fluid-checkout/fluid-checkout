!function(t,e){"function"==typeof define&&define.amd?define([],e()):"object"==typeof exports?module.exports=e():t.StickyStates=e()}("undefined"!=typeof global?global:this.window||this.global,function(t){"use strict";function g(){var t={},e=!1,i=0;for("[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(e=arguments[0],i++);i<arguments.length;i++){n=void 0;var n,s=arguments[i];for(n in s)s.hasOwnProperty(n)&&(e&&"[object Object]"===Object.prototype.toString.call(s[n])?t[n]=g(t[n],s[n]):t[n]=s[n])}return t}function y(t,e){for(var i=0;t&&(!e||e!=t);)i+=t.offsetTop,t=t.offsetParent;return i}function r(t){var e=null,i=window.innerWidth;if(function(t){try{JSON.parse(t)}catch(t){return!1}return!0}(t))for(var n=Object.entries(JSON.parse(t)),s=0;s<n.length;s++){var o=n[s][1];if(i>=o.breakpointInitial&&i<=o.breakpointFinal){e=document.querySelector(o.selector);break}}else e=document.querySelector(t);return e}function d(){for(var t=window.pageYOffset||document.body.scrollTop,e=0;e<f.managers.length;e++){var i,n=f.managers[e],s=window.getComputedStyle(n.containerElement),o=window.getComputedStyle(n.stickyElement),s=parseInt(s.height.replace("px")),o=parseInt(o.height.replace("px")),r=o<s,l=t>=n.settings.threshold,a=0,c=t>=n.settings.endThreshold,m=n.stickyElement.hasAttribute(n.settings.staticAtEndAttribute);n.relativeElement&&!!((i=n.relativeElement).offsetWidth||i.offsetHeight||i.getClientRects().length)&&f.isStickyPosition(n.relativeElement)&&(a=n.relativeElement.getBoundingClientRect().height,l=t>=n.settings.threshold-a,c=t>=n.settings.endThreshold-a),l&&r&&!c?(i=window.getComputedStyle(n.innerElement).width,n.innerElement.style.top=0<a?a+"px":"",n.innerElement.style.width=i,n.stickyElement.style.height=o+"px",n.stickyElement.style.position="",n.stickyElement.classList.add(n.settings.isStickyClass,"top"==n.settings.position?n.settings.isStickyTopClass:n.settings.isStickyBottomClass),n.stickyElement.classList.remove(n.settings.isEndPositionClass)):c&&r&&!m?(l=y(n.stickyElement)-y(n.containerElement),n.innerElement.style.top=s-o-l+"px",n.stickyElement.style.height=o+"px",n.stickyElement.classList.remove(n.settings.isStickyClass,n.settings.isStickyTopClass,n.settings.isStickyBottomClass),n.stickyElement.classList.add(n.settings.isEndPositionClass)):(n.stickyElement.classList.remove(n.settings.isStickyClass,n.settings.isStickyTopClass,n.settings.isStickyBottomClass,n.settings.isEndPositionClass),n.stickyElement.style.height="",n.innerElement.style.width="",n.innerElement.style.top="")}}function h(){k(),window.requestAnimationFrame(h)}function u(){for(var t=0;t<f.managers.length;t++){var e=f.managers[t];e&&f.resetStickyLimits(e)}}var p,k,E=!1,f={managers:[]},v={},b={elementSelector:"[data-sticky-states]",innerElementSelector:"[data-sticky-states-inner]",isEndPositionClass:"is-end-position",isStickyClass:"is-sticky",isStickyTopClass:"is-sticky--top",isStickyBottomClass:"is-sticky--bottom",isActivatedClass:"is-activated",positionAttribute:"data-sticky-position",thresholdAttribute:"data-sticky-threshold",stickyRelativeToAttribute:"data-sticky-relative-to",staticAtEndAttribute:"data-sticky-static-at-end",containerAttribute:"data-sticky-container",position:"top",threshold:0,refreshRate:50};f.isStickyPosition=function(t){if(t.matches("."+v.isStickyClass))return!0;t=window.getComputedStyle(t).position;return"fixed"==t||"sticky"==t};return f.resetStickyLimits=function(t){var e,i=Math.max(document.documentElement.clientHeight,window.innerHeight||0),n=t.stickyElement.getAttribute(t.settings.thresholdAttribute),s=t.stickyElement.getBoundingClientRect(),o=y(t.stickyElement),o=(t.settings.threshold=isNaN(parseInt(n))?o:parseInt(n),"bottom"==t.settings.position&&(t.settings.threshold=Math.max(t.settings.threshold-i+s.height,0)),t.stickyElement.getAttribute(t.settings.stickyRelativeToAttribute)),n=(null!=o&&""!=o&&(t.relativeElement=r(o)),t.containerElement=t.stickyElement.parentNode,t.stickyElement.getAttribute(t.settings.containerAttribute));null!=n&&""!=n&&(t.containerElement=t.stickyElement.closest(n),t.containerElement||(t.containerElement=document.querySelector(n))),t.containerElement&&(o=parseInt(window.getComputedStyle(t.containerElement).height.replace("px")),n=parseInt(window.getComputedStyle(t.stickyElement).height.replace("px")),e=y(t.stickyElement)-y(t.containerElement),t.settings.endThreshold=t.settings.threshold+o-n-e,"bottom"==t.settings.position&&(o=y(t.stickyElement)-i+s.height)>t.settings.threshold&&(t.settings.endThreshold=o))},f.getInstance=function(t){for(var e,i=0;i<f.managers.length;i++){var n=f.managers[i];if(n.stickyElement==t){e=n;break}}return e=e||f.getInstanceFromInner(t)},f.getInstanceFromInner=function(t){for(var e,i=0;i<f.managers.length;i++){var n=f.managers[i];if(n.innerElement==t){e=n;break}}return e},f.initializeElement=function(t){var e={},t=(e.settings=g(v),e.stickyElement=t,e.innerElement=e.stickyElement.querySelector(e.settings.innerElementSelector),e.stickyElement.getAttribute(e.settings.positionAttribute));e.settings.position="top"==t||"bottom"==t?t:v.position,f.resetStickyLimits(e),p&&(p.observe(e.containerElement),p.observe(e.stickyElement),p.observe(e.innerElement)),e.isActivated=!0,e.stickyElement.classList.add(e.settings.isActivatedClass),f.managers.push(e)},f.init=function(t){if(!E){v=g(b,t),window.ResizeObserver&&(p=new ResizeObserver((n=u,s=v.refreshRate,function(){var t=this,e=arguments,i=o&&!r;clearTimeout(r),r=setTimeout(function(){r=null,o||n.apply(t,e)},s),i&&n.apply(t,e)})));for(var n,s,o,r,l,a,c,m,y,e=document.querySelectorAll(v.elementSelector),i=0;i<e.length;i++)f.initializeElement(e[i]);l=d,a=(a=v.refreshRate)||250,k=function(){var t=c||this,e=+new Date,i=arguments;m&&e<m+a?(clearTimeout(y),y=setTimeout(function(){m=e,l.apply(t,i)},a)):(m=e,l.apply(t,i))},requestAnimationFrame(h),E=!0}},f});