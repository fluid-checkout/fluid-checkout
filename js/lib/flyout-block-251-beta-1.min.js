!function(e,t){"function"==typeof define&&define.amd?define([],t()):"object"==typeof exports?module.exports=t():e.FlyoutBlock=t()}("undefined"!=typeof global?global:this.window||this.global,function(e){"use strict";function a(){var e={},t=!1,o=0;for("[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(t=arguments[0],o++);o<arguments.length;o++){n=void 0;var n,l=arguments[o];for(n in l)l.hasOwnProperty(n)&&(t&&"[object Object]"===Object.prototype.toString.call(l[n])?e[n]=a(e[n],l[n]):e[n]=l[n])}return e}function n(e){!e.defaultPrevented&&(e.key==t.ESC&&s.closeAll(),e.key==t.ENTER||e.key==t.SPACE)&&e.target.closest(i.triggerSelectors)&&f(e)}function l(e,t){if(e&&e.parentNode)for(var o=e;o.parentNode;)!function(t,o){var e;t&&t.parentNode&&("boolean"!=typeof o&&(o=!1),e=t.parentNode?t.parentNode.childNodes:null)&&Array.from(e).forEach(function(e){e!=t&&(e.inert=o)})}(o,t),o=o.parentNode}var r=!1,s={managers:[]},i={},c={flyoutWrapperSelector:"[data-flyout]",flyoutContentSelector:"[data-flyout-content]",toggleButtonSelector:"[data-flyout-toggle]",openButtonSelector:"[data-flyout-open]",closeButtonSelector:"[data-flyout-close]",overlaySelector:"[data-flyout-overlay]",flyoutTogglePassActionSelector:"[data-flyout-pass-action], .js-flyout-pass-action",autoFocusSelector:"[data-autofocus]",flyoutToggleClassSelector:".js-flyout-toggle",flyoutClassTogglePrefix:"js-flyout-target-",idPrefix:"flyout-block",headingsSelector:'h1, h2, h3, h4, h5, h6, [role="heading"]',bodyHasFlyoutClass:"has-flyout",bodyHasFlyoutOpenClass:"has-flyout--open",isActivatedClass:"is-activated",isOpenClass:"is-open",openAnimationClass:"fade-in-up",closeAnimationClass:"fade-out-down",targetElementAttribute:"data-flyout-target",openAnimationClassAttribute:"data-flyout-open-animation-class",closeAnimationClassAttribute:"data-flyout-close-animation-class",manualFocusAttribute:"data-flyout-manual-focus",descriptionAttribute:"data-flyout-description",autoFocusAttribute:"data-autofocus",focusableElementsSelector:'a[href], button:not([disabled]), input:not([disabled]):not([type="hidden"]), textarea:not([disabled]), select:not([disabled]), details, summary, iframe, object, embed, [contenteditable] [tabindex]:not([tabindex="-1"])',flyoutRoleAttribute:"data-flyout-role",overlayTemplate:'<div class="flyout-overlay" data-flyout-overlay></div>'},u="open",d="closed",t={TAB:"Tab",ENTER:"Enter",ESC:"Escape",SPACE:" "},g=function(e){var t;return!!e&&((t=e.getAttribute(i.targetElementAttribute))&&""!=t?document.querySelector(t):e.closest(i.flyoutWrapperSelector))},m=function(e){if(e)for(var t=0;t<e.classList.length;t++){var o=e.classList[t];if(0==o.indexOf(i.flyoutClassTogglePrefix))return o="#"+o.replace(i.flyoutClassTogglePrefix,""),document.querySelector(o)}return!1},f=function(e){var t,o,n;e.target.closest(i.toggleButtonSelector)?(e.preventDefault(),o=e.target.closest(i.toggleButtonSelector),n=g(o),s.toggle(n)):e.target.closest(i.flyoutToggleClassSelector)?(e.target.closest(i.flyoutTogglePassActionSelector)||e.preventDefault(),t=e.target.closest(i.flyoutToggleClassSelector),(n=m(t))&&s.toggle(n)):e.target.closest(i.openButtonSelector)?(e.preventDefault(),o=e.target.closest(i.openButtonSelector),n=g(o),s.open(n)):e.target.closest(i.closeButtonSelector)?(e.preventDefault(),o=e.target.closest(i.closeButtonSelector),n=g(o),s.close(n)):e.target.matches(i.flyoutWrapperSelector)?(n=g(e.target),s.close(n)):e.target.closest(i.overlaySelector)&&s.closeAll()};s.getState=function(e){e=s.getInstance(e);return!!e&&e.state},s.open=function(e){var o=s.getInstance(e);if(!o)return!1;o.previousActiveElement=document.activeElement,AnimateHelper.doThenAnimate(e,o.settings.openAnimationClass,function(){o.state=u,o.wasHidden=o.element.hasAttribute("hidden"),o.element.removeAttribute("hidden"),o.element.classList.add(o.settings.isOpenClass),document.body.classList.add(o.settings.bodyHasFlyoutOpenClass,o.settings.bodyHasFlyoutOpenClass+"-"+o.element.id);var e,t="alert"==o.element.getAttribute(o.settings.flyoutRoleAttribute)||"alertdialog"==o.element.getAttribute(o.settings.flyoutRoleAttribute)?"alertdialog":"dialog";o.contentElement.setAttribute("role",t),o.contentElement.setAttribute("tabindex",0),o.element.hasAttribute(o.settings.manualFocusAttribute)||(t=o.contentElement,(e=o.element.querySelector(o.settings.autoFocusSelector))?t=e:o.element.matches(o.settings.autoFocusSelector)&&0<(e=(e=Array.from((o.element||document).querySelectorAll(i.focusableElementsSelector))).filter(function(e){return!e.matches(o.settings.closeButtonSelector)})).length&&(t=e[0]),t.focus()),l(o.element,!0)})},s.close=function(e){var t=s.getInstance(e);if(!t)return!1;AnimateHelper.animateThenDo(e,t.settings.closeAnimationClass,function(){t.state=d,t.element.classList.remove(t.settings.isOpenClass),document.body.classList.remove(t.settings.bodyHasFlyoutOpenClass+"-"+t.element.id),t.contentElement.removeAttribute("role"),t.contentElement.removeAttribute("tabindex"),t.wasHidden&&t.element.setAttribute("hidden",""),t.element.wasHidden=void 0,s.hasAnyElementOpen()||document.body.classList.remove(t.settings.bodyHasFlyoutOpenClass),l(t.element,!1),t.previousActiveElement&&t.previousActiveElement.focus()})},s.closeAll=function(){for(var e=0;e<s.managers.length;e++){var t=s.managers[e];s.getState(t.element)!=d&&s.close(t.element)}},s.toggle=function(e){s.getState(e)==d?s.open(e):s.close(e)},s.getInstance=function(e){for(var t,o=0;o<s.managers.length;o++){var n=s.managers[o];if(n.element==e){t=n;break}}return t},s.hasAnyElementOpen=function(){for(var e=0;e<s.managers.length;e++)if(s.managers[e].state==u)return!0;return!1},s.initializeTrigger=function(e){e.removeAttribute("disabled"),e.removeAttribute("aria-hidden"),e.setAttribute("tabindex","0"),"BUTTON"!=e.tagName.toUpperCase()&&e.setAttribute("role","button");var t=e.getAttribute("href");null!=t&&""!=t&&"#"!=t&&0==t.indexOf("#")&&document.querySelector(t)&&e.setAttribute(i.targetElementAttribute,t),e.getAttribute(i.targetElementAttribute)&&e.removeAttribute("href")},s.initTriggers=function(){for(var e=document.querySelectorAll(i.triggerSelectors),t=0;t<e.length;t++)s.initializeTrigger(e[t])},s.initializeElement=function(e){var t={},e=(t.element=e,t.settings=a(i),t.state=d,t.element.id&&""!=t.element.id||(t.element.id=t.settings.idPrefix+"-"+s.managers.length),t.contentElement=t.element.querySelector(t.settings.flyoutContentSelector),t.element.getAttribute(t.settings.openAnimationClassAttribute)),o=t.element.getAttribute(t.settings.closeAnimationClassAttribute),e=(t.settings.openAnimationClass=e&&""!=e?e:i.openAnimationClass,t.settings.closeAnimationClass=o&&""!=o?o:i.closeAnimationClass,t.element.getAttribute("aria-label")),o=t.element.getAttribute("aria-labelledby"),e=(e&&""!=e||o&&""!=o||(e=t.contentElement.querySelector(t.settings.headingsSelector))&&(o=null!=e.id&&""!=e.id?e.id:t.element.id+"-heading",e.id=o,t.contentElement.setAttribute("aria-labelledby",o)),t.element.getAttribute("aria-describedby"));e&&""!=e||(o=t.contentElement.querySelector("["+t.settings.descriptionAttribute+"]"))&&(e=null!=o.id&&""!=o.id?o.id:t.element.id+"-description",o.id=e,t.contentElement.setAttribute("aria-describedby",e)),t.isActivated=!0,t.element.classList.add(t.settings.isActivatedClass),s.managers.push(t)};return s.init=function(e){if(!r)if(window.AnimateHelper&&(HTMLElement.prototype.hasOwnProperty("inert")||Element.prototype.hasOwnProperty("inert"))){(i=a(c,e)).triggerSelectors=i.toggleButtonSelector+", "+i.openButtonSelector+", "+i.closeButtonSelector;for(var t=document.querySelectorAll(i.flyoutWrapperSelector),o=0;o<t.length;o++)s.initializeElement(t[o]);s.initTriggers(),(e=document.createElement("div")).innerHTML=i.overlayTemplate.trim(),document.body.appendChild(e.childNodes[0]),document.addEventListener("click",f),document.addEventListener("keydown",n,!0),document.body.classList.add(i.bodyHasFlyoutClass),r=!0}else console.log("FlyoutBlock could not be initialized."),console.log("AnimateHelper loaded: "+!!window.AnimateHelper),console.log("HTMLElement has `inert` property: "+!!HTMLElement.prototype.hasOwnProperty("inert")),console.log("Element has `inert` property: "+!!Element.prototype.hasOwnProperty("inert"))},s});