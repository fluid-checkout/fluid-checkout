!function(t,e){"function"==typeof define&&define.amd?define([],e()):"object"==typeof exports?module.exports=e():t.StickyStates=e()}("undefined"!=typeof global?global:this.window||this.global,function(t){"use strict";function o(t){for(var e=0,i=0;t&&!isNaN(t.offsetLeft)&&!isNaN(t.offsetTop);)e+=t.offsetLeft-t.scrollLeft,i+=t.offsetTop-t.scrollTop,t=t.offsetParent;return{top:i,left:e}}var s=!1,c={managers:[]},n={},l={elementSelector:"[data-sticky-states]",innerElementSelector:"[data-sticky-states-inner]",isEndPositionClass:"is-end-position",isStickyClass:"is-sticky",isStickyTopClass:"is-sticky--top",isStickyBottomClass:"is-sticky--bottom",isActivatedClass:"is-activated",positionAttribute:"data-sticky-position",thresholdAttribute:"data-sticky-threshold",stickyRelativeToAttribute:"data-sticky-relative-to",staticAtEndAttribute:"data-sticky-static-at-end",containerAttribute:"data-sticky-container",position:"top",threshold:0},r=function(){var i={},s=!1,t=0;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(s=arguments[0],t++);for(;t<arguments.length;t++)!function(t){for(var e in t)t.hasOwnProperty(e)&&(s&&"[object Object]"===Object.prototype.toString.call(t[e])?i[e]=r(i[e],t[e]):i[e]=t[e])}(arguments[t]);return i};c.isStickyPosition=function(t){if(t.matches("."+n.isStickyClass))return!0;t=window.getComputedStyle(t).position;return"fixed"==t||"sticky"==t};var a=function(){!function(){for(var t,e=window.pageYOffset||document.body.scrollTop,i=0;i<c.managers.length;i++){var s,n=c.managers[i],o=e>=n.settings.threshold,l=0,r=e>=n.settings.endThreshold,a=n.stickyElement.hasAttribute(n.settings.staticAtEndAttribute);n.relativeElement&&!!((t=n.relativeElement).offsetWidth||t.offsetHeight||t.getClientRects().length)&&c.isStickyPosition(n.relativeElement)&&(l=n.relativeElement.getBoundingClientRect().height,o=e>=n.settings.threshold-l),o&&!r?(o=window.getComputedStyle(n.innerElement).width,s=window.getComputedStyle(n.stickyElement).height,n.innerElement.style.top=0<l?l+"px":"",n.innerElement.style.width=o,n.stickyElement.style.height=s,n.stickyElement.style.position="",n.stickyElement.classList.add(n.settings.isStickyClass,"top"==n.settings.position?n.settings.isStickyTopClass:n.settings.isStickyBottomClass),n.stickyElement.classList.remove(n.settings.isEndPositionClass)):r&&!a?(s=parseInt(window.getComputedStyle(n.containerElement).height.replace("px")),n.innerElement.style.top=s+"px",n.stickyElement.classList.remove(n.settings.isStickyClass,n.settings.isStickyTopClass,n.settings.isStickyBottomClass),n.stickyElement.classList.add(n.settings.isEndPositionClass)):(n.stickyElement.classList.remove(n.settings.isStickyClass,n.settings.isStickyTopClass,n.settings.isStickyBottomClass,n.settings.isEndPositionClass),n.stickyElement.style.height="",n.innerElement.style.width="",n.innerElement.style.top="")}}(),window.requestAnimationFrame(a)};return c.resetStickyLimits=function(t){var e=Math.max(document.documentElement.clientHeight,window.innerHeight||0),i=t.stickyElement.getAttribute(t.settings.thresholdAttribute),s=t.stickyElement.getBoundingClientRect(),n=o(t.stickyElement.parentNode).top;t.settings.threshold=isNaN(parseInt(i))?n:parseInt(i),"bottom"==t.settings.position&&(t.settings.threshold=Math.max(t.settings.threshold-e+s.height,0));i=t.stickyElement.getAttribute(t.settings.stickyRelativeToAttribute);null!=i&&""!=i&&(t.relativeElement=document.querySelector(i)),t.containerElement=t.stickyElement.parentNode;i=t.stickyElement.getAttribute(t.settings.containerAttribute);null!=i&&""!=i&&(t.containerElement=t.stickyElement.closest(i),t.containerElement||(t.containerElement=document.querySelector(i))),t.containerElement&&(i=parseInt(window.getComputedStyle(t.containerElement).height.replace("px")),t.settings.endThreshold=t.settings.threshold+i,"bottom"!=t.settings.position||(s=o(t.stickyElement).top-e+s.height)>t.settings.threshold&&(t.settings.endThreshold=s))},c.getInstance=function(t){for(var e,i=0;i<c.managers.length;i++){var s=c.managers[i];if(s.element==t){e=s;break}}return e},c.initializeElement=function(t){var e={};e.settings=r(n),e.stickyElement=t,e.innerElement=e.stickyElement.querySelector(e.settings.innerElementSelector);t=e.stickyElement.getAttribute(e.settings.positionAttribute);e.settings.position="top"==t||"bottom"==t?t:n.position,c.resetStickyLimits(e),window.addEventListener("resize",function(){c.resetStickyLimits(e)}),e.isActivated=!0,e.stickyElement.classList.add(e.settings.isActivatedClass),c.managers.push(e)},c.init=function(t){if(!s){n=r(l,t);for(var e=document.querySelectorAll(n.elementSelector),i=0;i<e.length;i++)c.initializeElement(e[i]);requestAnimationFrame(a),s=!0}},c});