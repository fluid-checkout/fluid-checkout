!function(e,t){"function"==typeof define&&define.amd?define([],t()):"object"==typeof exports?module.exports=t():e.FCFragmentsRefresh=t()}("undefined"!=typeof global?global:this.window||this.global,function(e){"use strict";function t(e,t){for(var o=document.querySelectorAll(d.sectionSelector),s=0;s<o.length;s++){var n=o[s],a=n.querySelector(d.sectionVisibleStateFieldSelector);a&&"no"===a.value?n.setAttribute(d.sectionVisibleStateAttribute,a.value):n.removeAttribute(d.sectionVisibleStateAttribute)}}function o(e){e.target&&e.target.matches(d.loadingInputSelector)&&(e=e.target.closest(d.formRowSelector))&&e.classList.add(d.loadingClass)}function s(e){o(e),e.target.matches(d.updateFieldsSelector)&&a()}function n(e){e.defaultPrevented||FCUtils.keyboardKeys.ESC!==e.key&&FCUtils.keyboardKeys.ENTER!==e.key&&FCUtils.keyboardKeys.TAB!==e.key&&FCUtils.keyboardKeys.CAPS!==e.key&&FCUtils.keyboardKeys.SHIFT!==e.key&&FCUtils.keyboardKeys.FUNCTION!==e.key&&FCUtils.keyboardKeys.CONTROL!==e.key&&FCUtils.keyboardKeys.COMMAND_OR_WINDOWS!==e.key&&FCUtils.keyboardKeys.ALT!==e.key&&FCUtils.keyboardKeys.ARROW_LEFT!==e.key&&FCUtils.keyboardKeys.ARROW_RIGHT!==e.key&&FCUtils.keyboardKeys.ARROW_UP!==e.key&&FCUtils.keyboardKeys.ARROW_DOWN!==e.key&&(o(e),e.target.matches(d.updateFieldsSelector))&&a()}var a,r=jQuery,l=null!=r,i=!1,c={},d={bodyClass:"has-fc-fragments-refresh",dataFormSelector:"div.woocommerce form",sectionSelector:".fc-section",messagesWrapperSelector:".woocommerce-notices-wrapper",formRowSelector:".form-row",updateFieldsSelector:".update_totals_on_change input.input-text, .update_totals_on_change select",loadingInputSelector:".loading_indicator_on_change input.input-text",sectionVisibleStateFieldSelector:'.fc-section-visible-state[type="hidden"]',sectionVisibleStateAttribute:"data-section-visible",loadingClass:"fc-loading",uiProcessingClass:"processing",updateFragmentsNonce:"",updateWaitTime:500},u=!1,f={};c.updateFragments=function(){u&&u.abort();var e=FCUtils.extendObject(void 0,{security:d.updateFragmentsNonce,post_data:r(d.dataFormSelector).serialize()});u=r.ajax({type:"POST",url:fcSettings.wcAjaxUrl.toString().replace("%%endpoint%%","fc_update_fragments"),data:e,success:function(e){if(e&&!0===e.reload)window.location.reload();else{FCUtils.setCurrentFocusedElementGlobalVariables(),e&&e.fragments&&(r.each(e.fragments,function(e,t){document.querySelector(e);var o=!0;!(o=t&&-1!==t.toString().indexOf("fc-fragment-always-replace")?!0:o)||f&&f[e]===t||(fcSettings.debugMode&&console.log("Replacing fragment: "+e),r(e).replaceWith(t)),r(e).unblock()}),f=e.fragments),FCUtils.maybeRefocusElement(window.fcCurrentFocusedElement,window.fcCurrentFocusedElementValue);for(var t=document.querySelectorAll(d.loadingInputSelector),o=0;o<t.length;o++){var s=t[o].closest(d.formRowSelector);s&&s.classList.remove(d.loadingClass)}e=document.querySelector(d.messagesWrapperSelector);e&&0<e.children.length&&window.FCUtils&&"function"==typeof FCUtils.scrollToElement&&FCUtils.scrollToElement(e),r(document.body).trigger("fc_fragments_refreshed")}}})},c.blockUI=function(e){r(e).addClass(d.uiProcessingClass).block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},c.unblockUI=function(e){r(e).removeClass(d.uiProcessingClass).unblock()};return c.init=function(e){i||(d=FCUtils.extendObject(d,e),a=FCUtils.debounce(c.updateFragments,d.updateWaitTime),l&&(r(document.body).on("fc_fragment_refresh",a),r(document.body).on("fc_fragments_refreshed",t)),window.addEventListener("change",s),document.addEventListener("keydown",n,!0),document.body.classList.add(d.bodyClass),i=!0)},c});
//# sourceMappingURL=maps/fc-fragments-refresh-315-beta-7.min.js.map
