{"version":3,"file":"../fc-utils-313.min.js","sources":["fc-utils-313.js"],"sourcesContent":["/**\r\n * Utility resources shared across the scripts of Fluid Checkout.\r\n */\r\n(function (root, factory) {\r\n\tif ( typeof define === 'function' && define.amd ) {\r\n\t\tdefine([], factory(root));\r\n\t} else if ( typeof exports === 'object' ) {\r\n\t\tmodule.exports = factory(root);\r\n\t} else {\r\n\t\troot.FCUtils = factory(root);\r\n\t}\r\n})(typeof global !== 'undefined' ? global : this.window || this.global, function (root) {\r\n\r\n\t'use strict';\r\n\r\n\tvar _publicMethods = { }\r\n\tvar _settings = {\r\n\t\tselect2FormRowSelector:                '.form-row.fc-select2-field',\r\n\t\tselect2FocusElementSelector:           '.select2-selection, input[type=\"text\"]',\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * PROPERTIES\r\n\t */\r\n\r\n\r\n\r\n\t/**\r\n\t * Mapping of keyboard keys based on and comparable with `event.key` values.\r\n\t */\r\n\t_publicMethods.keyboardKeys = {\r\n\t\tESC: 'Escape',\r\n\t\tENTER: 'Enter',\r\n\t\tSPACE: ' ',\r\n\t\tTAB: 'Tab',\r\n\t\tCAPS: 'CapsLock',\r\n\t\tSHIFT: 'Shift',\r\n\t\tFUNCTION: 'Fn',\r\n\t\tCONTROL: 'Control',\r\n\t\tCOMMAND_OR_WINDOWS: 'Meta', // This is the `Windows` logo key, or the `Command` or `âŒ˜` key on Mac keyboards.\r\n\t\tALT: 'Alt',\r\n\t\tARROW_LEFT: 'ArrowLeft',\r\n\t\tARROW_RIGHT: 'ArrowRight',\r\n\t\tARROW_UP: 'ArrowUp',\r\n\t\tARROW_DOWN: 'ArrowDown',\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Determine which `animationend` event is supported.\r\n\t */\r\n\t_publicMethods.animationEndEvent = window.whichAnimationEnd ? window.whichAnimationEnd() : 'animationend';\r\n\r\n\r\n\r\n\r\n\t/**\r\n\t * METHODS\r\n\t */\r\n\r\n\r\n\r\n\t/*!\r\n\t* Merge two or more objects together.\r\n\t* (c) 2017 Chris Ferdinandi, MIT License, https://gomakethings.com\r\n\t* @param   {Boolean}  deep     If true, do a deep (or recursive) merge [optional]\r\n\t* @param   {Object}   objects  The objects to merge together\r\n\t* @returns {Object}            Merged values of defaults and options\r\n\t*/\r\n\t_publicMethods.extendObject = function () {\r\n\t\t// Variables\r\n\t\tvar extended = {};\r\n\t\tvar deep = false;\r\n\t\tvar i = 0;\r\n\r\n\t\t// Check if a deep merge\r\n\t\tif ( Object.prototype.toString.call( arguments[0] ) === '[object Boolean]' ) {\r\n\t\t\tdeep = arguments[0];\r\n\t\t\ti++;\r\n\t\t}\r\n\r\n\t\t// Merge the object into the extended object\r\n\t\tvar merge = function (obj) {\r\n\t\t\tfor (var prop in obj) {\r\n\t\t\t\tif (obj.hasOwnProperty(prop)) {\r\n\t\t\t\t\t// If property is an object, merge properties\r\n\t\t\t\t\tif (deep && Object.prototype.toString.call(obj[prop]) === '[object Object]') {\r\n\t\t\t\t\t\textended[prop] = _publicMethods.extendObject(extended[prop], obj[prop]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\textended[prop] = obj[prop];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// Loop through each object and conduct a merge\r\n\t\tfor (; i < arguments.length; i++) {\r\n\t\t\tvar obj = arguments[i];\r\n\t\t\tmerge(obj);\r\n\t\t}\r\n\r\n\t\treturn extended;\r\n\t};\r\n\r\n\r\n\r\n\t/**\r\n\t * Returns a function, that, as long as it continues to be invoked, will not\r\n\t * be triggered. The function will be called after it stops being called for\r\n\t * N milliseconds. If `immediate` is passed, trigger the function on the\r\n\t * leading edge, instead of the trailing.\r\n\t *\r\n\t * @param   {[type]}  func       Function to be executed.\r\n\t * @param   {[type]}  wait       Wait time in milliseconds.\r\n\t * @param   {[type]}  immediate  Trigger the function on the leading edge.\r\n\t *\r\n\t * @return  function              Function to be executed, incapsulated in a timed function.\r\n\t */\r\n\t_publicMethods.debounce = function ( func, wait, immediate ) {\r\n\t\tvar timeout;\r\n\r\n\t\treturn function() {\r\n\t\t\tvar context = this, args = arguments;\r\n\t\t\tvar later = function() {\r\n\t\t\t\ttimeout = null;\r\n\t\t\t\tif (!immediate) func.apply( context, args );\r\n\t\t\t};\r\n\r\n\t\t\tvar callNow = immediate && !timeout;\r\n\t\t\tclearTimeout( timeout );\r\n\t\t\ttimeout = setTimeout( later, wait );\r\n\r\n\t\t\tif ( callNow ) func.apply( context, args );\r\n\t\t};\r\n\t};\r\n\r\n\r\n\r\n\r\n\r\n\t/**\r\n\t * Maybe set focus back to the element that was focused before an update.\r\n\t * \r\n\t * @param  {HTMLElement}  currentFocusedElement  The element that was currently focused before an update.\r\n\t * @param  {mixed}        currentValue           The value of the element in focus before an update.\r\n\t */\r\n\t_publicMethods.maybeRefocusElement = function( currentFocusedElement, currentValue ) {\r\n\t\t// Bail if no element to focus\r\n\t\tif ( null === currentFocusedElement ) { return; }\r\n\r\n\t\t// Bail if focus is set to the document body\r\n\t\tif ( document.body === currentFocusedElement ) { return; }\r\n\r\n\t\trequestAnimationFrame( function() {\r\n\t\t\tvar elementToFocus;\r\n\r\n\t\t\t// Try findind the `select2` focusable element\r\n\t\t\tif ( currentFocusedElement.closest( _settings.select2FormRowSelector ) ) {\r\n\t\t\t\tvar formRow = currentFocusedElement.closest( _settings.select2FormRowSelector );\r\n\t\t\t\telementToFocus = formRow.querySelector( _settings.select2FocusElementSelector );\r\n\t\t\t}\r\n\t\t\t// Try findind the the current focused element after updating updated element by ID\r\n\t\t\telse if ( currentFocusedElement.id ) {\r\n\t\t\t\telementToFocus = document.getElementById( currentFocusedElement.id );\r\n\t\t\t}\r\n\t\t\t// Try findind the updated element by name attribute\r\n\t\t\telse if ( currentFocusedElement.getAttribute( 'name' ) ) {\r\n\t\t\t\tvar nameAttr = currentFocusedElement.getAttribute( 'name' );\r\n\t\t\t\telementToFocus = document.querySelector( '[name=\"'+nameAttr+'\"]' );\r\n\t\t\t}\r\n\r\n\t\t\t// Try setting focus if element is found\r\n\t\t\tif ( elementToFocus ) {\r\n\t\t\t\telementToFocus.focus();\r\n\r\n\t\t\t\t// Try to set current value to the focused element\r\n\t\t\t\tif ( undefined !== currentValue && null !== currentValue && currentValue !== elementToFocus.value ) {\r\n\t\t\t\t\telementToFocus.value = currentValue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Set keyboard track position back to that previously to update\r\n\t\t\t\tsetTimeout( function(){\r\n\t\t\t\t\t// Try to set the same track position\r\n\t\t\t\t\tif( null !== elementToFocus.selectionStart && null !== elementToFocus.selectionEnd ) {\r\n\t\t\t\t\t\tif ( currentFocusedElement.selectionStart && currentFocusedElement.selectionEnd ) {\r\n\t\t\t\t\t\t\telementToFocus.selectionStart = currentFocusedElement.selectionStart;\r\n\t\t\t\t\t\t\telementToFocus.selectionEnd = currentFocusedElement.selectionEnd;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Otherwise try set the track position to the end of the field\r\n\t\t\t\t\t\t// @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/setSelectionRange\r\n\t\t\t\t\t\t// @see https://html.spec.whatwg.org/multipage/input.html#concept-input-apply\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\telementToFocus.selectionStart = elementToFocus.selectionEnd = 999999;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 0 );\r\n\t\t\t}\r\n\t\t} );\r\n\t};\r\n\r\n\r\n\r\n\r\n\r\n\t/**\r\n\t * Expose public APIs.\r\n\t */\r\n\treturn _publicMethods;\r\n\r\n});\r\n"],"names":["root","factory","define","amd","exports","module","FCUtils","global","this","window","_publicMethods","_settings","keyboardKeys","ESC","ENTER","SPACE","TAB","CAPS","SHIFT","FUNCTION","CONTROL","COMMAND_OR_WINDOWS","ALT","ARROW_LEFT","ARROW_RIGHT","ARROW_UP","ARROW_DOWN","animationEndEvent","whichAnimationEnd","extendObject","extended","deep","i","Object","prototype","toString","call","arguments","length","prop","obj","hasOwnProperty","debounce","func","wait","immediate","timeout","context","args","callNow","clearTimeout","setTimeout","apply","maybeRefocusElement","currentFocusedElement","currentValue","document","body","requestAnimationFrame","elementToFocus","nameAttr","closest","querySelector","id","getElementById","getAttribute","focus","undefined","value","selectionStart","selectionEnd"],"mappings":"AAGA,CAAA,SAAWA,EAAMC,GACO,YAAlB,OAAOC,QAAyBA,OAAOC,IAC3CD,OAAO,GAAID,EAAY,CAAC,EACM,UAAnB,OAAOG,QAClBC,OAAOD,QAAUH,EAAY,EAE7BD,EAAKM,QAAUL,EAAY,CAE5B,EAAoB,aAAlB,OAAOM,OAAyBA,OAASC,KAAKC,QAAUD,KAAKD,OAAQ,SAAUP,GAEjF,aAEA,IAAIU,EAAiB,GACjBC,EACoC,6BADpCA,EAEoC,yCAgMxC,OAlLAD,EAAeE,aAAe,CAC7BC,IAAK,SACLC,MAAO,QACPC,MAAO,IACPC,IAAK,MACLC,KAAM,WACNC,MAAO,QACPC,SAAU,KACVC,QAAS,UACTC,mBAAoB,OACpBC,IAAK,MACLC,WAAY,YACZC,YAAa,aACbC,SAAU,UACVC,WAAY,WACb,EAOAhB,EAAeiB,kBAAoBlB,OAAOmB,kBAAoBnB,OAAOmB,kBAAkB,EAAI,eAkB3FlB,EAAemB,aAAe,WAE7B,IAAIC,EAAW,GACXC,EAAO,CAAA,EACPC,EAAI,EAuBR,IApBwD,qBAAnDC,OAAOC,UAAUC,SAASC,KAAMC,UAAU,EAAG,IACjDN,EAAOM,UAAU,GACjBL,CAAC,IAkBKA,EAAIK,UAAUC,OAAQN,CAAC,GAAI,CAbxBO,EAAAA,KAAAA,EAcT,IAdSA,EADYC,EAeXH,UAAUL,GAdpB,IAASO,KAAQC,EACZA,EAAIC,eAAeF,CAAI,IAEtBR,GAAsD,oBAA9CE,OAAOC,UAAUC,SAASC,KAAKI,EAAID,EAAK,EACnDT,EAASS,GAAQ7B,EAAemB,aAAaC,EAASS,GAAOC,EAAID,EAAK,EAEtET,EAASS,GAAQC,EAAID,GAUzB,CAEA,OAAOT,CACR,EAgBApB,EAAegC,SAAW,SAAWC,EAAMC,EAAMC,GAChD,IAAIC,EAEJ,OAAO,WACN,IAAIC,EAAUvC,KAAMwC,EAAOX,UAMvBY,EAAUJ,GAAa,CAACC,EAC5BI,aAAcJ,CAAQ,EACtBA,EAAUK,WAPE,WACXL,EAAU,KACLD,GAAWF,EAAKS,MAAOL,EAASC,CAAK,CAC3C,EAI6BJ,CAAK,EAE7BK,GAAUN,EAAKS,MAAOL,EAASC,CAAK,CAC1C,CACD,EAYAtC,EAAe2C,oBAAsB,SAAUC,EAAuBC,GAEhE,OAASD,GAGTE,SAASC,OAASH,GAEvBI,sBAAuB,WACtB,IAKCC,EAQIC,EAVAN,EAAsBO,QAASlD,CAAiC,EAEpEgD,EADcL,EAAsBO,QAASlD,CAAiC,EACrDmD,cAAenD,CAAsC,EAGrE2C,EAAsBS,GAC/BJ,EAAiBH,SAASQ,eAAgBV,EAAsBS,EAAG,EAG1DT,EAAsBW,aAAc,MAAO,IAChDL,EAAWN,EAAsBW,aAAc,MAAO,EAC1DN,EAAiBH,SAASM,cAAe,UAAUF,EAAS,IAAK,GAI7DD,IACJA,EAAeO,MAAM,EAGhBC,MAAcZ,GAAyCA,IAAiBI,EAAeS,QAC3FT,EAAeS,MAAQb,GAIxBJ,WAAY,WAEP,OAASQ,EAAeU,gBAAkB,OAASV,EAAeW,eAChEhB,EAAsBe,gBAAkBf,EAAsBgB,cAClEX,EAAeU,eAAiBf,EAAsBe,eACtDV,EAAeW,aAAehB,EAAsBgB,cAMpDX,EAAeU,eAAiBV,EAAeW,aAAe,OAGjE,EAAG,CAAE,EAEP,CAAE,CACH,EASO5D,CAER,CAAC"}