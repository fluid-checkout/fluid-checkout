{"version":3,"file":"../tom-select.complete-319-beta-11.min.js","sources":["tom-select.complete-319-beta-11.js"],"sourcesContent":["/**\r\n* Tom Select v2.3.1\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n*/\r\n\r\n(function (global, factory) {\r\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n\ttypeof define === 'function' && define.amd ? define(factory) :\r\n\t(global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.TomSelect = factory());\r\n})(this, (function () { 'use strict';\r\n\r\n\t/**\r\n\t * MicroEvent - to make any js object an event emitter\r\n\t *\r\n\t * - pure javascript - server compatible, browser compatible\r\n\t * - dont rely on the browser doms\r\n\t * - super simple - you get it immediatly, no mistery, no magic involved\r\n\t *\r\n\t * @author Jerome Etienne (https://github.com/jeromeetienne)\r\n\t */\r\n\r\n\t/**\r\n\t * Execute callback for each event in space separated list of event names\r\n\t *\r\n\t */\r\n\tfunction forEvents(events, callback) {\r\n\t  events.split(/\\s+/).forEach(event => {\r\n\t    callback(event);\r\n\t  });\r\n\t}\r\n\tclass MicroEvent {\r\n\t  constructor() {\r\n\t    this._events = void 0;\r\n\t    this._events = {};\r\n\t  }\r\n\t  on(events, fct) {\r\n\t    forEvents(events, event => {\r\n\t      const event_array = this._events[event] || [];\r\n\t      event_array.push(fct);\r\n\t      this._events[event] = event_array;\r\n\t    });\r\n\t  }\r\n\t  off(events, fct) {\r\n\t    var n = arguments.length;\r\n\t    if (n === 0) {\r\n\t      this._events = {};\r\n\t      return;\r\n\t    }\r\n\t    forEvents(events, event => {\r\n\t      if (n === 1) {\r\n\t        delete this._events[event];\r\n\t        return;\r\n\t      }\r\n\t      const event_array = this._events[event];\r\n\t      if (event_array === undefined) return;\r\n\t      event_array.splice(event_array.indexOf(fct), 1);\r\n\t      this._events[event] = event_array;\r\n\t    });\r\n\t  }\r\n\t  trigger(events, ...args) {\r\n\t    var self = this;\r\n\t    forEvents(events, event => {\r\n\t      const event_array = self._events[event];\r\n\t      if (event_array === undefined) return;\r\n\t      event_array.forEach(fct => {\r\n\t        fct.apply(self, args);\r\n\t      });\r\n\t    });\r\n\t  }\r\n\t}\r\n\r\n\t/**\r\n\t * microplugin.js\r\n\t * Copyright (c) 2013 Brian Reavis & contributors\r\n\t *\r\n\t * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\r\n\t * file except in compliance with the License. You may obtain a copy of the License at:\r\n\t * http://www.apache.org/licenses/LICENSE-2.0\r\n\t *\r\n\t * Unless required by applicable law or agreed to in writing, software distributed under\r\n\t * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\r\n\t * ANY KIND, either express or implied. See the License for the specific language\r\n\t * governing permissions and limitations under the License.\r\n\t *\r\n\t * @author Brian Reavis <brian@thirdroute.com>\r\n\t */\r\n\r\n\tfunction MicroPlugin(Interface) {\r\n\t  Interface.plugins = {};\r\n\t  return class extends Interface {\r\n\t    constructor(...args) {\r\n\t      super(...args);\r\n\t      this.plugins = {\r\n\t        names: [],\r\n\t        settings: {},\r\n\t        requested: {},\r\n\t        loaded: {}\r\n\t      };\r\n\t    }\r\n\t    /**\r\n\t     * Registers a plugin.\r\n\t     *\r\n\t     * @param {function} fn\r\n\t     */\r\n\t    static define(name, fn) {\r\n\t      Interface.plugins[name] = {\r\n\t        'name': name,\r\n\t        'fn': fn\r\n\t      };\r\n\t    }\r\n\r\n\t    /**\r\n\t     * Initializes the listed plugins (with options).\r\n\t     * Acceptable formats:\r\n\t     *\r\n\t     * List (without options):\r\n\t     *   ['a', 'b', 'c']\r\n\t     *\r\n\t     * List (with options):\r\n\t     *   [{'name': 'a', options: {}}, {'name': 'b', options: {}}]\r\n\t     *\r\n\t     * Hash (with options):\r\n\t     *   {'a': { ... }, 'b': { ... }, 'c': { ... }}\r\n\t     *\r\n\t     * @param {array|object} plugins\r\n\t     */\r\n\t    initializePlugins(plugins) {\r\n\t      var key, name;\r\n\t      const self = this;\r\n\t      const queue = [];\r\n\t      if (Array.isArray(plugins)) {\r\n\t        plugins.forEach(plugin => {\r\n\t          if (typeof plugin === 'string') {\r\n\t            queue.push(plugin);\r\n\t          } else {\r\n\t            self.plugins.settings[plugin.name] = plugin.options;\r\n\t            queue.push(plugin.name);\r\n\t          }\r\n\t        });\r\n\t      } else if (plugins) {\r\n\t        for (key in plugins) {\r\n\t          if (plugins.hasOwnProperty(key)) {\r\n\t            self.plugins.settings[key] = plugins[key];\r\n\t            queue.push(key);\r\n\t          }\r\n\t        }\r\n\t      }\r\n\t      while (name = queue.shift()) {\r\n\t        self.require(name);\r\n\t      }\r\n\t    }\r\n\t    loadPlugin(name) {\r\n\t      var self = this;\r\n\t      var plugins = self.plugins;\r\n\t      var plugin = Interface.plugins[name];\r\n\t      if (!Interface.plugins.hasOwnProperty(name)) {\r\n\t        throw new Error('Unable to find \"' + name + '\" plugin');\r\n\t      }\r\n\t      plugins.requested[name] = true;\r\n\t      plugins.loaded[name] = plugin.fn.apply(self, [self.plugins.settings[name] || {}]);\r\n\t      plugins.names.push(name);\r\n\t    }\r\n\r\n\t    /**\r\n\t     * Initializes a plugin.\r\n\t     *\r\n\t     */\r\n\t    require(name) {\r\n\t      var self = this;\r\n\t      var plugins = self.plugins;\r\n\t      if (!self.plugins.loaded.hasOwnProperty(name)) {\r\n\t        if (plugins.requested[name]) {\r\n\t          throw new Error('Plugin has circular dependency (\"' + name + '\")');\r\n\t        }\r\n\t        self.loadPlugin(name);\r\n\t      }\r\n\t      return plugins.loaded[name];\r\n\t    }\r\n\t  };\r\n\t}\r\n\r\n\t/*! @orchidjs/unicode-variants | https://github.com/orchidjs/unicode-variants | Apache License (v2) */\r\n\t/**\r\n\t * Convert array of strings to a regular expression\r\n\t *\tex ['ab','a'] => (?:ab|a)\r\n\t * \tex ['a','b'] => [ab]\r\n\t * @param {string[]} chars\r\n\t * @return {string}\r\n\t */\r\n\tconst arrayToPattern = chars => {\r\n\t  chars = chars.filter(Boolean);\r\n\r\n\t  if (chars.length < 2) {\r\n\t    return chars[0] || '';\r\n\t  }\r\n\r\n\t  return maxValueLength(chars) == 1 ? '[' + chars.join('') + ']' : '(?:' + chars.join('|') + ')';\r\n\t};\r\n\t/**\r\n\t * @param {string[]} array\r\n\t * @return {string}\r\n\t */\r\n\r\n\tconst sequencePattern = array => {\r\n\t  if (!hasDuplicates(array)) {\r\n\t    return array.join('');\r\n\t  }\r\n\r\n\t  let pattern = '';\r\n\t  let prev_char_count = 0;\r\n\r\n\t  const prev_pattern = () => {\r\n\t    if (prev_char_count > 1) {\r\n\t      pattern += '{' + prev_char_count + '}';\r\n\t    }\r\n\t  };\r\n\r\n\t  array.forEach((char, i) => {\r\n\t    if (char === array[i - 1]) {\r\n\t      prev_char_count++;\r\n\t      return;\r\n\t    }\r\n\r\n\t    prev_pattern();\r\n\t    pattern += char;\r\n\t    prev_char_count = 1;\r\n\t  });\r\n\t  prev_pattern();\r\n\t  return pattern;\r\n\t};\r\n\t/**\r\n\t * Convert array of strings to a regular expression\r\n\t *\tex ['ab','a'] => (?:ab|a)\r\n\t * \tex ['a','b'] => [ab]\r\n\t * @param {Set<string>} chars\r\n\t * @return {string}\r\n\t */\r\n\r\n\tconst setToPattern = chars => {\r\n\t  let array = toArray(chars);\r\n\t  return arrayToPattern(array);\r\n\t};\r\n\t/**\r\n\t *\r\n\t * https://stackoverflow.com/questions/7376598/in-javascript-how-do-i-check-if-an-array-has-duplicate-values\r\n\t * @param {any[]} array\r\n\t */\r\n\r\n\tconst hasDuplicates = array => {\r\n\t  return new Set(array).size !== array.length;\r\n\t};\r\n\t/**\r\n\t * https://stackoverflow.com/questions/63006601/why-does-u-throw-an-invalid-escape-error\r\n\t * @param {string} str\r\n\t * @return {string}\r\n\t */\r\n\r\n\tconst escape_regex = str => {\r\n\t  return (str + '').replace(/([\\$\\(\\)\\*\\+\\.\\?\\[\\]\\^\\{\\|\\}\\\\])/gu, '\\\\$1');\r\n\t};\r\n\t/**\r\n\t * Return the max length of array values\r\n\t * @param {string[]} array\r\n\t *\r\n\t */\r\n\r\n\tconst maxValueLength = array => {\r\n\t  return array.reduce((longest, value) => Math.max(longest, unicodeLength(value)), 0);\r\n\t};\r\n\t/**\r\n\t * @param {string} str\r\n\t */\r\n\r\n\tconst unicodeLength = str => {\r\n\t  return toArray(str).length;\r\n\t};\r\n\t/**\r\n\t * @param {any} p\r\n\t * @return {any[]}\r\n\t */\r\n\r\n\tconst toArray = p => Array.from(p);\r\n\r\n\t/*! @orchidjs/unicode-variants | https://github.com/orchidjs/unicode-variants | Apache License (v2) */\r\n\t/**\r\n\t * Get all possible combinations of substrings that add up to the given string\r\n\t * https://stackoverflow.com/questions/30169587/find-all-the-combination-of-substrings-that-add-up-to-the-given-string\r\n\t * @param {string} input\r\n\t * @return {string[][]}\r\n\t */\r\n\tconst allSubstrings = input => {\r\n\t  if (input.length === 1) return [[input]];\r\n\t  /** @type {string[][]} */\r\n\r\n\t  let result = [];\r\n\t  const start = input.substring(1);\r\n\t  const suba = allSubstrings(start);\r\n\t  suba.forEach(function (subresult) {\r\n\t    let tmp = subresult.slice(0);\r\n\t    tmp[0] = input.charAt(0) + tmp[0];\r\n\t    result.push(tmp);\r\n\t    tmp = subresult.slice(0);\r\n\t    tmp.unshift(input.charAt(0));\r\n\t    result.push(tmp);\r\n\t  });\r\n\t  return result;\r\n\t};\r\n\r\n\t/*! @orchidjs/unicode-variants | https://github.com/orchidjs/unicode-variants | Apache License (v2) */\r\n\r\n\t/**\r\n\t * @typedef {{[key:string]:string}} TUnicodeMap\r\n\t * @typedef {{[key:string]:Set<string>}} TUnicodeSets\r\n\t * @typedef {[[number,number]]} TCodePoints\r\n\t * @typedef {{folded:string,composed:string,code_point:number}} TCodePointObj\r\n\t * @typedef {{start:number,end:number,length:number,substr:string}} TSequencePart\r\n\t */\r\n\t/** @type {TCodePoints} */\r\n\r\n\tconst code_points = [[0, 65535]];\r\n\tconst accent_pat = '[\\u0300-\\u036F\\u{b7}\\u{2be}\\u{2bc}]';\r\n\t/** @type {TUnicodeMap} */\r\n\r\n\tlet unicode_map;\r\n\t/** @type {RegExp} */\r\n\r\n\tlet multi_char_reg;\r\n\tconst max_char_length = 3;\r\n\t/** @type {TUnicodeMap} */\r\n\r\n\tconst latin_convert = {};\r\n\t/** @type {TUnicodeMap} */\r\n\r\n\tconst latin_condensed = {\r\n\t  '/': '⁄∕',\r\n\t  '0': '߀',\r\n\t  \"a\": \"ⱥɐɑ\",\r\n\t  \"aa\": \"ꜳ\",\r\n\t  \"ae\": \"æǽǣ\",\r\n\t  \"ao\": \"ꜵ\",\r\n\t  \"au\": \"ꜷ\",\r\n\t  \"av\": \"ꜹꜻ\",\r\n\t  \"ay\": \"ꜽ\",\r\n\t  \"b\": \"ƀɓƃ\",\r\n\t  \"c\": \"ꜿƈȼↄ\",\r\n\t  \"d\": \"đɗɖᴅƌꮷԁɦ\",\r\n\t  \"e\": \"ɛǝᴇɇ\",\r\n\t  \"f\": \"ꝼƒ\",\r\n\t  \"g\": \"ǥɠꞡᵹꝿɢ\",\r\n\t  \"h\": \"ħⱨⱶɥ\",\r\n\t  \"i\": \"ɨı\",\r\n\t  \"j\": \"ɉȷ\",\r\n\t  \"k\": \"ƙⱪꝁꝃꝅꞣ\",\r\n\t  \"l\": \"łƚɫⱡꝉꝇꞁɭ\",\r\n\t  \"m\": \"ɱɯϻ\",\r\n\t  \"n\": \"ꞥƞɲꞑᴎлԉ\",\r\n\t  \"o\": \"øǿɔɵꝋꝍᴑ\",\r\n\t  \"oe\": \"œ\",\r\n\t  \"oi\": \"ƣ\",\r\n\t  \"oo\": \"ꝏ\",\r\n\t  \"ou\": \"ȣ\",\r\n\t  \"p\": \"ƥᵽꝑꝓꝕρ\",\r\n\t  \"q\": \"ꝗꝙɋ\",\r\n\t  \"r\": \"ɍɽꝛꞧꞃ\",\r\n\t  \"s\": \"ßȿꞩꞅʂ\",\r\n\t  \"t\": \"ŧƭʈⱦꞇ\",\r\n\t  \"th\": \"þ\",\r\n\t  \"tz\": \"ꜩ\",\r\n\t  \"u\": \"ʉ\",\r\n\t  \"v\": \"ʋꝟʌ\",\r\n\t  \"vy\": \"ꝡ\",\r\n\t  \"w\": \"ⱳ\",\r\n\t  \"y\": \"ƴɏỿ\",\r\n\t  \"z\": \"ƶȥɀⱬꝣ\",\r\n\t  \"hv\": \"ƕ\"\r\n\t};\r\n\r\n\tfor (let latin in latin_condensed) {\r\n\t  let unicode = latin_condensed[latin] || '';\r\n\r\n\t  for (let i = 0; i < unicode.length; i++) {\r\n\t    let char = unicode.substring(i, i + 1);\r\n\t    latin_convert[char] = latin;\r\n\t  }\r\n\t}\r\n\r\n\tconst convert_pat = new RegExp(Object.keys(latin_convert).join('|') + '|' + accent_pat, 'gu');\r\n\t/**\r\n\t * Initialize the unicode_map from the give code point ranges\r\n\t *\r\n\t * @param {TCodePoints=} _code_points\r\n\t */\r\n\r\n\tconst initialize = _code_points => {\r\n\t  if (unicode_map !== undefined) return;\r\n\t  unicode_map = generateMap(_code_points || code_points);\r\n\t};\r\n\t/**\r\n\t * Helper method for normalize a string\r\n\t * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/normalize\r\n\t * @param {string} str\r\n\t * @param {string} form\r\n\t */\r\n\r\n\tconst normalize = (str, form = 'NFKD') => str.normalize(form);\r\n\t/**\r\n\t * Remove accents without reordering string\r\n\t * calling str.normalize('NFKD') on \\u{594}\\u{595}\\u{596} becomes \\u{596}\\u{594}\\u{595}\r\n\t * via https://github.com/krisk/Fuse/issues/133#issuecomment-318692703\r\n\t * @param {string} str\r\n\t * @return {string}\r\n\t */\r\n\r\n\tconst asciifold = str => {\r\n\t  return toArray(str).reduce(\r\n\t  /**\r\n\t   * @param {string} result\r\n\t   * @param {string} char\r\n\t   */\r\n\t  (result, char) => {\r\n\t    return result + _asciifold(char);\r\n\t  }, '');\r\n\t};\r\n\t/**\r\n\t * @param {string} str\r\n\t * @return {string}\r\n\t */\r\n\r\n\tconst _asciifold = str => {\r\n\t  str = normalize(str).toLowerCase().replace(convert_pat, (\r\n\t  /** @type {string} */\r\n\t  char) => {\r\n\t    return latin_convert[char] || '';\r\n\t  }); //return str;\r\n\r\n\t  return normalize(str, 'NFC');\r\n\t};\r\n\t/**\r\n\t * Generate a list of unicode variants from the list of code points\r\n\t * @param {TCodePoints} code_points\r\n\t * @yield {TCodePointObj}\r\n\t */\r\n\r\n\tfunction* generator(code_points) {\r\n\t  for (const [code_point_min, code_point_max] of code_points) {\r\n\t    for (let i = code_point_min; i <= code_point_max; i++) {\r\n\t      let composed = String.fromCharCode(i);\r\n\t      let folded = asciifold(composed);\r\n\r\n\t      if (folded == composed.toLowerCase()) {\r\n\t        continue;\r\n\t      } // skip when folded is a string longer than 3 characters long\r\n\t      // bc the resulting regex patterns will be long\r\n\t      // eg:\r\n\t      // folded صلى الله عليه وسلم length 18 code point 65018\r\n\t      // folded جل جلاله length 8 code point 65019\r\n\r\n\r\n\t      if (folded.length > max_char_length) {\r\n\t        continue;\r\n\t      }\r\n\r\n\t      if (folded.length == 0) {\r\n\t        continue;\r\n\t      }\r\n\r\n\t      yield {\r\n\t        folded: folded,\r\n\t        composed: composed,\r\n\t        code_point: i\r\n\t      };\r\n\t    }\r\n\t  }\r\n\t}\r\n\t/**\r\n\t * Generate a unicode map from the list of code points\r\n\t * @param {TCodePoints} code_points\r\n\t * @return {TUnicodeSets}\r\n\t */\r\n\r\n\tconst generateSets = code_points => {\r\n\t  /** @type {{[key:string]:Set<string>}} */\r\n\t  const unicode_sets = {};\r\n\t  /**\r\n\t   * @param {string} folded\r\n\t   * @param {string} to_add\r\n\t   */\r\n\r\n\t  const addMatching = (folded, to_add) => {\r\n\t    /** @type {Set<string>} */\r\n\t    const folded_set = unicode_sets[folded] || new Set();\r\n\t    const patt = new RegExp('^' + setToPattern(folded_set) + '$', 'iu');\r\n\r\n\t    if (to_add.match(patt)) {\r\n\t      return;\r\n\t    }\r\n\r\n\t    folded_set.add(escape_regex(to_add));\r\n\t    unicode_sets[folded] = folded_set;\r\n\t  };\r\n\r\n\t  for (let value of generator(code_points)) {\r\n\t    addMatching(value.folded, value.folded);\r\n\t    addMatching(value.folded, value.composed);\r\n\t  }\r\n\r\n\t  return unicode_sets;\r\n\t};\r\n\t/**\r\n\t * Generate a unicode map from the list of code points\r\n\t * ae => (?:(?:ae|Æ|Ǽ|Ǣ)|(?:A|Ⓐ|Ａ...)(?:E|ɛ|Ⓔ...))\r\n\t *\r\n\t * @param {TCodePoints} code_points\r\n\t * @return {TUnicodeMap}\r\n\t */\r\n\r\n\tconst generateMap = code_points => {\r\n\t  /** @type {TUnicodeSets} */\r\n\t  const unicode_sets = generateSets(code_points);\r\n\t  /** @type {TUnicodeMap} */\r\n\r\n\t  const unicode_map = {};\r\n\t  /** @type {string[]} */\r\n\r\n\t  let multi_char = [];\r\n\r\n\t  for (let folded in unicode_sets) {\r\n\t    let set = unicode_sets[folded];\r\n\r\n\t    if (set) {\r\n\t      unicode_map[folded] = setToPattern(set);\r\n\t    }\r\n\r\n\t    if (folded.length > 1) {\r\n\t      multi_char.push(escape_regex(folded));\r\n\t    }\r\n\t  }\r\n\r\n\t  multi_char.sort((a, b) => b.length - a.length);\r\n\t  const multi_char_patt = arrayToPattern(multi_char);\r\n\t  multi_char_reg = new RegExp('^' + multi_char_patt, 'u');\r\n\t  return unicode_map;\r\n\t};\r\n\t/**\r\n\t * Map each element of an array from it's folded value to all possible unicode matches\r\n\t * @param {string[]} strings\r\n\t * @param {number} min_replacement\r\n\t * @return {string}\r\n\t */\r\n\r\n\tconst mapSequence = (strings, min_replacement = 1) => {\r\n\t  let chars_replaced = 0;\r\n\t  strings = strings.map(str => {\r\n\t    if (unicode_map[str]) {\r\n\t      chars_replaced += str.length;\r\n\t    }\r\n\r\n\t    return unicode_map[str] || str;\r\n\t  });\r\n\r\n\t  if (chars_replaced >= min_replacement) {\r\n\t    return sequencePattern(strings);\r\n\t  }\r\n\r\n\t  return '';\r\n\t};\r\n\t/**\r\n\t * Convert a short string and split it into all possible patterns\r\n\t * Keep a pattern only if min_replacement is met\r\n\t *\r\n\t * 'abc'\r\n\t * \t\t=> [['abc'],['ab','c'],['a','bc'],['a','b','c']]\r\n\t *\t\t=> ['abc-pattern','ab-c-pattern'...]\r\n\t *\r\n\t *\r\n\t * @param {string} str\r\n\t * @param {number} min_replacement\r\n\t * @return {string}\r\n\t */\r\n\r\n\tconst substringsToPattern = (str, min_replacement = 1) => {\r\n\t  min_replacement = Math.max(min_replacement, str.length - 1);\r\n\t  return arrayToPattern(allSubstrings(str).map(sub_pat => {\r\n\t    return mapSequence(sub_pat, min_replacement);\r\n\t  }));\r\n\t};\r\n\t/**\r\n\t * Convert an array of sequences into a pattern\r\n\t * [{start:0,end:3,length:3,substr:'iii'}...] => (?:iii...)\r\n\t *\r\n\t * @param {Sequence[]} sequences\r\n\t * @param {boolean} all\r\n\t */\r\n\r\n\tconst sequencesToPattern = (sequences, all = true) => {\r\n\t  let min_replacement = sequences.length > 1 ? 1 : 0;\r\n\t  return arrayToPattern(sequences.map(sequence => {\r\n\t    let seq = [];\r\n\t    const len = all ? sequence.length() : sequence.length() - 1;\r\n\r\n\t    for (let j = 0; j < len; j++) {\r\n\t      seq.push(substringsToPattern(sequence.substrs[j] || '', min_replacement));\r\n\t    }\r\n\r\n\t    return sequencePattern(seq);\r\n\t  }));\r\n\t};\r\n\t/**\r\n\t * Return true if the sequence is already in the sequences\r\n\t * @param {Sequence} needle_seq\r\n\t * @param {Sequence[]} sequences\r\n\t */\r\n\r\n\r\n\tconst inSequences = (needle_seq, sequences) => {\r\n\t  for (const seq of sequences) {\r\n\t    if (seq.start != needle_seq.start || seq.end != needle_seq.end) {\r\n\t      continue;\r\n\t    }\r\n\r\n\t    if (seq.substrs.join('') !== needle_seq.substrs.join('')) {\r\n\t      continue;\r\n\t    }\r\n\r\n\t    let needle_parts = needle_seq.parts;\r\n\t    /**\r\n\t     * @param {TSequencePart} part\r\n\t     */\r\n\r\n\t    const filter = part => {\r\n\t      for (const needle_part of needle_parts) {\r\n\t        if (needle_part.start === part.start && needle_part.substr === part.substr) {\r\n\t          return false;\r\n\t        }\r\n\r\n\t        if (part.length == 1 || needle_part.length == 1) {\r\n\t          continue;\r\n\t        } // check for overlapping parts\r\n\t        // a = ['::=','==']\r\n\t        // b = ['::','===']\r\n\t        // a = ['r','sm']\r\n\t        // b = ['rs','m']\r\n\r\n\r\n\t        if (part.start < needle_part.start && part.end > needle_part.start) {\r\n\t          return true;\r\n\t        }\r\n\r\n\t        if (needle_part.start < part.start && needle_part.end > part.start) {\r\n\t          return true;\r\n\t        }\r\n\t      }\r\n\r\n\t      return false;\r\n\t    };\r\n\r\n\t    let filtered = seq.parts.filter(filter);\r\n\r\n\t    if (filtered.length > 0) {\r\n\t      continue;\r\n\t    }\r\n\r\n\t    return true;\r\n\t  }\r\n\r\n\t  return false;\r\n\t};\r\n\r\n\tclass Sequence {\r\n\t  constructor() {\r\n\t    /** @type {TSequencePart[]} */\r\n\t    this.parts = [];\r\n\t    /** @type {string[]} */\r\n\r\n\t    this.substrs = [];\r\n\t    this.start = 0;\r\n\t    this.end = 0;\r\n\t  }\r\n\t  /**\r\n\t   * @param {TSequencePart|undefined} part\r\n\t   */\r\n\r\n\r\n\t  add(part) {\r\n\t    if (part) {\r\n\t      this.parts.push(part);\r\n\t      this.substrs.push(part.substr);\r\n\t      this.start = Math.min(part.start, this.start);\r\n\t      this.end = Math.max(part.end, this.end);\r\n\t    }\r\n\t  }\r\n\r\n\t  last() {\r\n\t    return this.parts[this.parts.length - 1];\r\n\t  }\r\n\r\n\t  length() {\r\n\t    return this.parts.length;\r\n\t  }\r\n\t  /**\r\n\t   * @param {number} position\r\n\t   * @param {TSequencePart} last_piece\r\n\t   */\r\n\r\n\r\n\t  clone(position, last_piece) {\r\n\t    let clone = new Sequence();\r\n\t    let parts = JSON.parse(JSON.stringify(this.parts));\r\n\t    let last_part = parts.pop();\r\n\r\n\t    for (const part of parts) {\r\n\t      clone.add(part);\r\n\t    }\r\n\r\n\t    let last_substr = last_piece.substr.substring(0, position - last_part.start);\r\n\t    let clone_last_len = last_substr.length;\r\n\t    clone.add({\r\n\t      start: last_part.start,\r\n\t      end: last_part.start + clone_last_len,\r\n\t      length: clone_last_len,\r\n\t      substr: last_substr\r\n\t    });\r\n\t    return clone;\r\n\t  }\r\n\r\n\t}\r\n\t/**\r\n\t * Expand a regular expression pattern to include unicode variants\r\n\t * \teg /a/ becomes /aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐɑAⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ/\r\n\t *\r\n\t * Issue:\r\n\t *  ﺊﺋ [ 'ﺊ = \\\\u{fe8a}', 'ﺋ = \\\\u{fe8b}' ]\r\n\t *\tbecomes:\tئئ [ 'ي = \\\\u{64a}', 'ٔ = \\\\u{654}', 'ي = \\\\u{64a}', 'ٔ = \\\\u{654}' ]\r\n\t *\r\n\t *\tİĲ = IIJ = ⅡJ\r\n\t *\r\n\t * \t1/2/4\r\n\t *\r\n\t * @param {string} str\r\n\t * @return {string|undefined}\r\n\t */\r\n\r\n\r\n\tconst getPattern = str => {\r\n\t  initialize();\r\n\t  str = asciifold(str);\r\n\t  let pattern = '';\r\n\t  let sequences = [new Sequence()];\r\n\r\n\t  for (let i = 0; i < str.length; i++) {\r\n\t    let substr = str.substring(i);\r\n\t    let match = substr.match(multi_char_reg);\r\n\t    const char = str.substring(i, i + 1);\r\n\t    const match_str = match ? match[0] : null; // loop through sequences\r\n\t    // add either the char or multi_match\r\n\r\n\t    let overlapping = [];\r\n\t    let added_types = new Set();\r\n\r\n\t    for (const sequence of sequences) {\r\n\t      const last_piece = sequence.last();\r\n\r\n\t      if (!last_piece || last_piece.length == 1 || last_piece.end <= i) {\r\n\t        // if we have a multi match\r\n\t        if (match_str) {\r\n\t          const len = match_str.length;\r\n\t          sequence.add({\r\n\t            start: i,\r\n\t            end: i + len,\r\n\t            length: len,\r\n\t            substr: match_str\r\n\t          });\r\n\t          added_types.add('1');\r\n\t        } else {\r\n\t          sequence.add({\r\n\t            start: i,\r\n\t            end: i + 1,\r\n\t            length: 1,\r\n\t            substr: char\r\n\t          });\r\n\t          added_types.add('2');\r\n\t        }\r\n\t      } else if (match_str) {\r\n\t        let clone = sequence.clone(i, last_piece);\r\n\t        const len = match_str.length;\r\n\t        clone.add({\r\n\t          start: i,\r\n\t          end: i + len,\r\n\t          length: len,\r\n\t          substr: match_str\r\n\t        });\r\n\t        overlapping.push(clone);\r\n\t      } else {\r\n\t        // don't add char\r\n\t        // adding would create invalid patterns: 234 => [2,34,4]\r\n\t        added_types.add('3');\r\n\t      }\r\n\t    } // if we have overlapping\r\n\r\n\r\n\t    if (overlapping.length > 0) {\r\n\t      // ['ii','iii'] before ['i','i','iii']\r\n\t      overlapping = overlapping.sort((a, b) => {\r\n\t        return a.length() - b.length();\r\n\t      });\r\n\r\n\t      for (let clone of overlapping) {\r\n\t        // don't add if we already have an equivalent sequence\r\n\t        if (inSequences(clone, sequences)) {\r\n\t          continue;\r\n\t        }\r\n\r\n\t        sequences.push(clone);\r\n\t      }\r\n\r\n\t      continue;\r\n\t    } // if we haven't done anything unique\r\n\t    // clean up the patterns\r\n\t    // helps keep patterns smaller\r\n\t    // if str = 'r₨㎧aarss', pattern will be 446 instead of 655\r\n\r\n\r\n\t    if (i > 0 && added_types.size == 1 && !added_types.has('3')) {\r\n\t      pattern += sequencesToPattern(sequences, false);\r\n\t      let new_seq = new Sequence();\r\n\t      const old_seq = sequences[0];\r\n\r\n\t      if (old_seq) {\r\n\t        new_seq.add(old_seq.last());\r\n\t      }\r\n\r\n\t      sequences = [new_seq];\r\n\t    }\r\n\t  }\r\n\r\n\t  pattern += sequencesToPattern(sequences, true);\r\n\t  return pattern;\r\n\t};\r\n\r\n\t/*! sifter.js | https://github.com/orchidjs/sifter.js | Apache License (v2) */\r\n\r\n\t/**\r\n\t * A property getter resolving dot-notation\r\n\t * @param  {Object}  obj     The root object to fetch property on\r\n\t * @param  {String}  name    The optionally dotted property name to fetch\r\n\t * @return {Object}          The resolved property value\r\n\t */\r\n\tconst getAttr = (obj, name) => {\r\n\t  if (!obj) return;\r\n\t  return obj[name];\r\n\t};\r\n\t/**\r\n\t * A property getter resolving dot-notation\r\n\t * @param  {Object}  obj     The root object to fetch property on\r\n\t * @param  {String}  name    The optionally dotted property name to fetch\r\n\t * @return {Object}          The resolved property value\r\n\t */\r\n\r\n\tconst getAttrNesting = (obj, name) => {\r\n\t  if (!obj) return;\r\n\t  var part,\r\n\t      names = name.split(\".\");\r\n\r\n\t  while ((part = names.shift()) && (obj = obj[part]));\r\n\r\n\t  return obj;\r\n\t};\r\n\t/**\r\n\t * Calculates how close of a match the\r\n\t * given value is against a search token.\r\n\t *\r\n\t */\r\n\r\n\tconst scoreValue = (value, token, weight) => {\r\n\t  var score, pos;\r\n\t  if (!value) return 0;\r\n\t  value = value + '';\r\n\t  if (token.regex == null) return 0;\r\n\t  pos = value.search(token.regex);\r\n\t  if (pos === -1) return 0;\r\n\t  score = token.string.length / value.length;\r\n\t  if (pos === 0) score += 0.5;\r\n\t  return score * weight;\r\n\t};\r\n\t/**\r\n\t * Cast object property to an array if it exists and has a value\r\n\t *\r\n\t */\r\n\r\n\tconst propToArray = (obj, key) => {\r\n\t  var value = obj[key];\r\n\t  if (typeof value == 'function') return value;\r\n\r\n\t  if (value && !Array.isArray(value)) {\r\n\t    obj[key] = [value];\r\n\t  }\r\n\t};\r\n\t/**\r\n\t * Iterates over arrays and hashes.\r\n\t *\r\n\t * ```\r\n\t * iterate(this.items, function(item, id) {\r\n\t *    // invoked for each item\r\n\t * });\r\n\t * ```\r\n\t *\r\n\t */\r\n\r\n\tconst iterate$1 = (object, callback) => {\r\n\t  if (Array.isArray(object)) {\r\n\t    object.forEach(callback);\r\n\t  } else {\r\n\t    for (var key in object) {\r\n\t      if (object.hasOwnProperty(key)) {\r\n\t        callback(object[key], key);\r\n\t      }\r\n\t    }\r\n\t  }\r\n\t};\r\n\tconst cmp = (a, b) => {\r\n\t  if (typeof a === 'number' && typeof b === 'number') {\r\n\t    return a > b ? 1 : a < b ? -1 : 0;\r\n\t  }\r\n\r\n\t  a = asciifold(a + '').toLowerCase();\r\n\t  b = asciifold(b + '').toLowerCase();\r\n\t  if (a > b) return 1;\r\n\t  if (b > a) return -1;\r\n\t  return 0;\r\n\t};\r\n\r\n\t/*! sifter.js | https://github.com/orchidjs/sifter.js | Apache License (v2) */\r\n\r\n\t/**\r\n\t * sifter.js\r\n\t * Copyright (c) 2013–2020 Brian Reavis & contributors\r\n\t *\r\n\t * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\r\n\t * file except in compliance with the License. You may obtain a copy of the License at:\r\n\t * http://www.apache.org/licenses/LICENSE-2.0\r\n\t *\r\n\t * Unless required by applicable law or agreed to in writing, software distributed under\r\n\t * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\r\n\t * ANY KIND, either express or implied. See the License for the specific language\r\n\t * governing permissions and limitations under the License.\r\n\t *\r\n\t * @author Brian Reavis <brian@thirdroute.com>\r\n\t */\r\n\r\n\tclass Sifter {\r\n\t  // []|{};\r\n\r\n\t  /**\r\n\t   * Textually searches arrays and hashes of objects\r\n\t   * by property (or multiple properties). Designed\r\n\t   * specifically for autocomplete.\r\n\t   *\r\n\t   */\r\n\t  constructor(items, settings) {\r\n\t    this.items = void 0;\r\n\t    this.settings = void 0;\r\n\t    this.items = items;\r\n\t    this.settings = settings || {\r\n\t      diacritics: true\r\n\t    };\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Splits a search string into an array of individual\r\n\t   * regexps to be used to match results.\r\n\t   *\r\n\t   */\r\n\t  tokenize(query, respect_word_boundaries, weights) {\r\n\t    if (!query || !query.length) return [];\r\n\t    const tokens = [];\r\n\t    const words = query.split(/\\s+/);\r\n\t    var field_regex;\r\n\r\n\t    if (weights) {\r\n\t      field_regex = new RegExp('^(' + Object.keys(weights).map(escape_regex).join('|') + ')\\:(.*)$');\r\n\t    }\r\n\r\n\t    words.forEach(word => {\r\n\t      let field_match;\r\n\t      let field = null;\r\n\t      let regex = null; // look for \"field:query\" tokens\r\n\r\n\t      if (field_regex && (field_match = word.match(field_regex))) {\r\n\t        field = field_match[1];\r\n\t        word = field_match[2];\r\n\t      }\r\n\r\n\t      if (word.length > 0) {\r\n\t        if (this.settings.diacritics) {\r\n\t          regex = getPattern(word) || null;\r\n\t        } else {\r\n\t          regex = escape_regex(word);\r\n\t        }\r\n\r\n\t        if (regex && respect_word_boundaries) regex = \"\\\\b\" + regex;\r\n\t      }\r\n\r\n\t      tokens.push({\r\n\t        string: word,\r\n\t        regex: regex ? new RegExp(regex, 'iu') : null,\r\n\t        field: field\r\n\t      });\r\n\t    });\r\n\t    return tokens;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Returns a function to be used to score individual results.\r\n\t   *\r\n\t   * Good matches will have a higher score than poor matches.\r\n\t   * If an item is not a match, 0 will be returned by the function.\r\n\t   *\r\n\t   * @returns {T.ScoreFn}\r\n\t   */\r\n\t  getScoreFunction(query, options) {\r\n\t    var search = this.prepareSearch(query, options);\r\n\t    return this._getScoreFunction(search);\r\n\t  }\r\n\t  /**\r\n\t   * @returns {T.ScoreFn}\r\n\t   *\r\n\t   */\r\n\r\n\r\n\t  _getScoreFunction(search) {\r\n\t    const tokens = search.tokens,\r\n\t          token_count = tokens.length;\r\n\r\n\t    if (!token_count) {\r\n\t      return function () {\r\n\t        return 0;\r\n\t      };\r\n\t    }\r\n\r\n\t    const fields = search.options.fields,\r\n\t          weights = search.weights,\r\n\t          field_count = fields.length,\r\n\t          getAttrFn = search.getAttrFn;\r\n\r\n\t    if (!field_count) {\r\n\t      return function () {\r\n\t        return 1;\r\n\t      };\r\n\t    }\r\n\t    /**\r\n\t     * Calculates the score of an object\r\n\t     * against the search query.\r\n\t     *\r\n\t     */\r\n\r\n\r\n\t    const scoreObject = function () {\r\n\t      if (field_count === 1) {\r\n\t        return function (token, data) {\r\n\t          const field = fields[0].field;\r\n\t          return scoreValue(getAttrFn(data, field), token, weights[field] || 1);\r\n\t        };\r\n\t      }\r\n\r\n\t      return function (token, data) {\r\n\t        var sum = 0; // is the token specific to a field?\r\n\r\n\t        if (token.field) {\r\n\t          const value = getAttrFn(data, token.field);\r\n\r\n\t          if (!token.regex && value) {\r\n\t            sum += 1 / field_count;\r\n\t          } else {\r\n\t            sum += scoreValue(value, token, 1);\r\n\t          }\r\n\t        } else {\r\n\t          iterate$1(weights, (weight, field) => {\r\n\t            sum += scoreValue(getAttrFn(data, field), token, weight);\r\n\t          });\r\n\t        }\r\n\r\n\t        return sum / field_count;\r\n\t      };\r\n\t    }();\r\n\r\n\t    if (token_count === 1) {\r\n\t      return function (data) {\r\n\t        return scoreObject(tokens[0], data);\r\n\t      };\r\n\t    }\r\n\r\n\t    if (search.options.conjunction === 'and') {\r\n\t      return function (data) {\r\n\t        var score,\r\n\t            sum = 0;\r\n\r\n\t        for (let token of tokens) {\r\n\t          score = scoreObject(token, data);\r\n\t          if (score <= 0) return 0;\r\n\t          sum += score;\r\n\t        }\r\n\r\n\t        return sum / token_count;\r\n\t      };\r\n\t    } else {\r\n\t      return function (data) {\r\n\t        var sum = 0;\r\n\t        iterate$1(tokens, token => {\r\n\t          sum += scoreObject(token, data);\r\n\t        });\r\n\t        return sum / token_count;\r\n\t      };\r\n\t    }\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Returns a function that can be used to compare two\r\n\t   * results, for sorting purposes. If no sorting should\r\n\t   * be performed, `null` will be returned.\r\n\t   *\r\n\t   * @return function(a,b)\r\n\t   */\r\n\t  getSortFunction(query, options) {\r\n\t    var search = this.prepareSearch(query, options);\r\n\t    return this._getSortFunction(search);\r\n\t  }\r\n\r\n\t  _getSortFunction(search) {\r\n\t    var implicit_score,\r\n\t        sort_flds = [];\r\n\t    const self = this,\r\n\t          options = search.options,\r\n\t          sort = !search.query && options.sort_empty ? options.sort_empty : options.sort;\r\n\r\n\t    if (typeof sort == 'function') {\r\n\t      return sort.bind(this);\r\n\t    }\r\n\t    /**\r\n\t     * Fetches the specified sort field value\r\n\t     * from a search result item.\r\n\t     *\r\n\t     */\r\n\r\n\r\n\t    const get_field = function get_field(name, result) {\r\n\t      if (name === '$score') return result.score;\r\n\t      return search.getAttrFn(self.items[result.id], name);\r\n\t    }; // parse options\r\n\r\n\r\n\t    if (sort) {\r\n\t      for (let s of sort) {\r\n\t        if (search.query || s.field !== '$score') {\r\n\t          sort_flds.push(s);\r\n\t        }\r\n\t      }\r\n\t    } // the \"$score\" field is implied to be the primary\r\n\t    // sort field, unless it's manually specified\r\n\r\n\r\n\t    if (search.query) {\r\n\t      implicit_score = true;\r\n\r\n\t      for (let fld of sort_flds) {\r\n\t        if (fld.field === '$score') {\r\n\t          implicit_score = false;\r\n\t          break;\r\n\t        }\r\n\t      }\r\n\r\n\t      if (implicit_score) {\r\n\t        sort_flds.unshift({\r\n\t          field: '$score',\r\n\t          direction: 'desc'\r\n\t        });\r\n\t      } // without a search.query, all items will have the same score\r\n\r\n\t    } else {\r\n\t      sort_flds = sort_flds.filter(fld => fld.field !== '$score');\r\n\t    } // build function\r\n\r\n\r\n\t    const sort_flds_count = sort_flds.length;\r\n\r\n\t    if (!sort_flds_count) {\r\n\t      return null;\r\n\t    }\r\n\r\n\t    return function (a, b) {\r\n\t      var result, field;\r\n\r\n\t      for (let sort_fld of sort_flds) {\r\n\t        field = sort_fld.field;\r\n\t        let multiplier = sort_fld.direction === 'desc' ? -1 : 1;\r\n\t        result = multiplier * cmp(get_field(field, a), get_field(field, b));\r\n\t        if (result) return result;\r\n\t      }\r\n\r\n\t      return 0;\r\n\t    };\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Parses a search query and returns an object\r\n\t   * with tokens and fields ready to be populated\r\n\t   * with results.\r\n\t   *\r\n\t   */\r\n\t  prepareSearch(query, optsUser) {\r\n\t    const weights = {};\r\n\t    var options = Object.assign({}, optsUser);\r\n\t    propToArray(options, 'sort');\r\n\t    propToArray(options, 'sort_empty'); // convert fields to new format\r\n\r\n\t    if (options.fields) {\r\n\t      propToArray(options, 'fields');\r\n\t      const fields = [];\r\n\t      options.fields.forEach(field => {\r\n\t        if (typeof field == 'string') {\r\n\t          field = {\r\n\t            field: field,\r\n\t            weight: 1\r\n\t          };\r\n\t        }\r\n\r\n\t        fields.push(field);\r\n\t        weights[field.field] = 'weight' in field ? field.weight : 1;\r\n\t      });\r\n\t      options.fields = fields;\r\n\t    }\r\n\r\n\t    return {\r\n\t      options: options,\r\n\t      query: query.toLowerCase().trim(),\r\n\t      tokens: this.tokenize(query, options.respect_word_boundaries, weights),\r\n\t      total: 0,\r\n\t      items: [],\r\n\t      weights: weights,\r\n\t      getAttrFn: options.nesting ? getAttrNesting : getAttr\r\n\t    };\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Searches through all items and returns a sorted array of matches.\r\n\t   *\r\n\t   */\r\n\t  search(query, options) {\r\n\t    var self = this,\r\n\t        score,\r\n\t        search;\r\n\t    search = this.prepareSearch(query, options);\r\n\t    options = search.options;\r\n\t    query = search.query; // generate result scoring function\r\n\r\n\t    const fn_score = options.score || self._getScoreFunction(search); // perform search and sort\r\n\r\n\r\n\t    if (query.length) {\r\n\t      iterate$1(self.items, (item, id) => {\r\n\t        score = fn_score(item);\r\n\r\n\t        if (options.filter === false || score > 0) {\r\n\t          search.items.push({\r\n\t            'score': score,\r\n\t            'id': id\r\n\t          });\r\n\t        }\r\n\t      });\r\n\t    } else {\r\n\t      iterate$1(self.items, (_, id) => {\r\n\t        search.items.push({\r\n\t          'score': 1,\r\n\t          'id': id\r\n\t        });\r\n\t      });\r\n\t    }\r\n\r\n\t    const fn_sort = self._getSortFunction(search);\r\n\r\n\t    if (fn_sort) search.items.sort(fn_sort); // apply limits\r\n\r\n\t    search.total = search.items.length;\r\n\r\n\t    if (typeof options.limit === 'number') {\r\n\t      search.items = search.items.slice(0, options.limit);\r\n\t    }\r\n\r\n\t    return search;\r\n\t  }\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Iterates over arrays and hashes.\r\n\t *\r\n\t * ```\r\n\t * iterate(this.items, function(item, id) {\r\n\t *    // invoked for each item\r\n\t * });\r\n\t * ```\r\n\t *\r\n\t */\r\n\tconst iterate = (object, callback) => {\r\n\t  if (Array.isArray(object)) {\r\n\t    object.forEach(callback);\r\n\t  } else {\r\n\t    for (var key in object) {\r\n\t      if (object.hasOwnProperty(key)) {\r\n\t        callback(object[key], key);\r\n\t      }\r\n\t    }\r\n\t  }\r\n\t};\r\n\r\n\t/**\r\n\t * Return a dom element from either a dom query string, jQuery object, a dom element or html string\r\n\t * https://stackoverflow.com/questions/494143/creating-a-new-dom-element-from-an-html-string-using-built-in-dom-methods-or-pro/35385518#35385518\r\n\t *\r\n\t * param query should be {}\r\n\t */\r\n\tconst getDom = query => {\r\n\t  if (query.jquery) {\r\n\t    return query[0];\r\n\t  }\r\n\t  if (query instanceof HTMLElement) {\r\n\t    return query;\r\n\t  }\r\n\t  if (isHtmlString(query)) {\r\n\t    var tpl = document.createElement('template');\r\n\t    tpl.innerHTML = query.trim(); // Never return a text node of whitespace as the result\r\n\t    return tpl.content.firstChild;\r\n\t  }\r\n\t  return document.querySelector(query);\r\n\t};\r\n\tconst isHtmlString = arg => {\r\n\t  if (typeof arg === 'string' && arg.indexOf('<') > -1) {\r\n\t    return true;\r\n\t  }\r\n\t  return false;\r\n\t};\r\n\tconst escapeQuery = query => {\r\n\t  return query.replace(/['\"\\\\]/g, '\\\\$&');\r\n\t};\r\n\r\n\t/**\r\n\t * Dispatch an event\r\n\t *\r\n\t */\r\n\tconst triggerEvent = (dom_el, event_name) => {\r\n\t  var event = document.createEvent('HTMLEvents');\r\n\t  event.initEvent(event_name, true, false);\r\n\t  dom_el.dispatchEvent(event);\r\n\t};\r\n\r\n\t/**\r\n\t * Apply CSS rules to a dom element\r\n\t *\r\n\t */\r\n\tconst applyCSS = (dom_el, css) => {\r\n\t  Object.assign(dom_el.style, css);\r\n\t};\r\n\r\n\t/**\r\n\t * Add css classes\r\n\t *\r\n\t */\r\n\tconst addClasses = (elmts, ...classes) => {\r\n\t  var norm_classes = classesArray(classes);\r\n\t  elmts = castAsArray(elmts);\r\n\t  elmts.map(el => {\r\n\t    norm_classes.map(cls => {\r\n\t      el.classList.add(cls);\r\n\t    });\r\n\t  });\r\n\t};\r\n\r\n\t/**\r\n\t * Remove css classes\r\n\t *\r\n\t */\r\n\tconst removeClasses = (elmts, ...classes) => {\r\n\t  var norm_classes = classesArray(classes);\r\n\t  elmts = castAsArray(elmts);\r\n\t  elmts.map(el => {\r\n\t    norm_classes.map(cls => {\r\n\t      el.classList.remove(cls);\r\n\t    });\r\n\t  });\r\n\t};\r\n\r\n\t/**\r\n\t * Return arguments\r\n\t *\r\n\t */\r\n\tconst classesArray = args => {\r\n\t  var classes = [];\r\n\t  iterate(args, _classes => {\r\n\t    if (typeof _classes === 'string') {\r\n\t      _classes = _classes.trim().split(/[\\11\\12\\14\\15\\40]/);\r\n\t    }\r\n\t    if (Array.isArray(_classes)) {\r\n\t      classes = classes.concat(_classes);\r\n\t    }\r\n\t  });\r\n\t  return classes.filter(Boolean);\r\n\t};\r\n\r\n\t/**\r\n\t * Create an array from arg if it's not already an array\r\n\t *\r\n\t */\r\n\tconst castAsArray = arg => {\r\n\t  if (!Array.isArray(arg)) {\r\n\t    arg = [arg];\r\n\t  }\r\n\t  return arg;\r\n\t};\r\n\r\n\t/**\r\n\t * Get the closest node to the evt.target matching the selector\r\n\t * Stops at wrapper\r\n\t *\r\n\t */\r\n\tconst parentMatch = (target, selector, wrapper) => {\r\n\t  if (wrapper && !wrapper.contains(target)) {\r\n\t    return;\r\n\t  }\r\n\t  while (target && target.matches) {\r\n\t    if (target.matches(selector)) {\r\n\t      return target;\r\n\t    }\r\n\t    target = target.parentNode;\r\n\t  }\r\n\t};\r\n\r\n\t/**\r\n\t * Get the first or last item from an array\r\n\t *\r\n\t * > 0 - right (last)\r\n\t * <= 0 - left (first)\r\n\t *\r\n\t */\r\n\tconst getTail = (list, direction = 0) => {\r\n\t  if (direction > 0) {\r\n\t    return list[list.length - 1];\r\n\t  }\r\n\t  return list[0];\r\n\t};\r\n\r\n\t/**\r\n\t * Return true if an object is empty\r\n\t *\r\n\t */\r\n\tconst isEmptyObject = obj => {\r\n\t  return Object.keys(obj).length === 0;\r\n\t};\r\n\r\n\t/**\r\n\t * Get the index of an element amongst sibling nodes of the same type\r\n\t *\r\n\t */\r\n\tconst nodeIndex = (el, amongst) => {\r\n\t  if (!el) return -1;\r\n\t  amongst = amongst || el.nodeName;\r\n\t  var i = 0;\r\n\t  while (el = el.previousElementSibling) {\r\n\t    if (el.matches(amongst)) {\r\n\t      i++;\r\n\t    }\r\n\t  }\r\n\t  return i;\r\n\t};\r\n\r\n\t/**\r\n\t * Set attributes of an element\r\n\t *\r\n\t */\r\n\tconst setAttr = (el, attrs) => {\r\n\t  iterate(attrs, (val, attr) => {\r\n\t    if (val == null) {\r\n\t      el.removeAttribute(attr);\r\n\t    } else {\r\n\t      el.setAttribute(attr, '' + val);\r\n\t    }\r\n\t  });\r\n\t};\r\n\r\n\t/**\r\n\t * Replace a node\r\n\t */\r\n\tconst replaceNode = (existing, replacement) => {\r\n\t  if (existing.parentNode) existing.parentNode.replaceChild(replacement, existing);\r\n\t};\r\n\r\n\t/**\r\n\t * highlight v3 | MIT license | Johann Burkard <jb@eaio.com>\r\n\t * Highlights arbitrary terms in a node.\r\n\t *\r\n\t * - Modified by Marshal <beatgates@gmail.com> 2011-6-24 (added regex)\r\n\t * - Modified by Brian Reavis <brian@thirdroute.com> 2012-8-27 (cleanup)\r\n\t */\r\n\r\n\tconst highlight = (element, regex) => {\r\n\t  if (regex === null) return;\r\n\r\n\t  // convet string to regex\r\n\t  if (typeof regex === 'string') {\r\n\t    if (!regex.length) return;\r\n\t    regex = new RegExp(regex, 'i');\r\n\t  }\r\n\r\n\t  // Wrap matching part of text node with highlighting <span>, e.g.\r\n\t  // Soccer  ->  <span class=\"highlight\">Soc</span>cer  for regex = /soc/i\r\n\t  const highlightText = node => {\r\n\t    var match = node.data.match(regex);\r\n\t    if (match && node.data.length > 0) {\r\n\t      var spannode = document.createElement('span');\r\n\t      spannode.className = 'highlight';\r\n\t      var middlebit = node.splitText(match.index);\r\n\t      middlebit.splitText(match[0].length);\r\n\t      var middleclone = middlebit.cloneNode(true);\r\n\t      spannode.appendChild(middleclone);\r\n\t      replaceNode(middlebit, spannode);\r\n\t      return 1;\r\n\t    }\r\n\t    return 0;\r\n\t  };\r\n\r\n\t  // Recurse element node, looking for child text nodes to highlight, unless element\r\n\t  // is childless, <script>, <style>, or already highlighted: <span class=\"hightlight\">\r\n\t  const highlightChildren = node => {\r\n\t    if (node.nodeType === 1 && node.childNodes && !/(script|style)/i.test(node.tagName) && (node.className !== 'highlight' || node.tagName !== 'SPAN')) {\r\n\t      Array.from(node.childNodes).forEach(element => {\r\n\t        highlightRecursive(element);\r\n\t      });\r\n\t    }\r\n\t  };\r\n\t  const highlightRecursive = node => {\r\n\t    if (node.nodeType === 3) {\r\n\t      return highlightText(node);\r\n\t    }\r\n\t    highlightChildren(node);\r\n\t    return 0;\r\n\t  };\r\n\t  highlightRecursive(element);\r\n\t};\r\n\r\n\t/**\r\n\t * removeHighlight fn copied from highlight v5 and\r\n\t * edited to remove with(), pass js strict mode, and use without jquery\r\n\t */\r\n\tconst removeHighlight = el => {\r\n\t  var elements = el.querySelectorAll(\"span.highlight\");\r\n\t  Array.prototype.forEach.call(elements, function (el) {\r\n\t    var parent = el.parentNode;\r\n\t    parent.replaceChild(el.firstChild, el);\r\n\t    parent.normalize();\r\n\t  });\r\n\t};\r\n\r\n\tconst KEY_A = 65;\r\n\tconst KEY_RETURN = 13;\r\n\tconst KEY_ESC = 27;\r\n\tconst KEY_LEFT = 37;\r\n\tconst KEY_UP = 38;\r\n\tconst KEY_RIGHT = 39;\r\n\tconst KEY_DOWN = 40;\r\n\tconst KEY_BACKSPACE = 8;\r\n\tconst KEY_DELETE = 46;\r\n\tconst KEY_TAB = 9;\r\n\tconst IS_MAC = typeof navigator === 'undefined' ? false : /Mac/.test(navigator.userAgent);\r\n\tconst KEY_SHORTCUT = IS_MAC ? 'metaKey' : 'ctrlKey'; // ctrl key or apple key for ma\r\n\r\n\tvar defaults = {\r\n\t  options: [],\r\n\t  optgroups: [],\r\n\t  plugins: [],\r\n\t  delimiter: ',',\r\n\t  splitOn: null,\r\n\t  // regexp or string for splitting up values from a paste command\r\n\t  persist: true,\r\n\t  diacritics: true,\r\n\t  create: null,\r\n\t  createOnBlur: false,\r\n\t  createFilter: null,\r\n\t  highlight: true,\r\n\t  openOnFocus: true,\r\n\t  shouldOpen: null,\r\n\t  maxOptions: 50,\r\n\t  maxItems: null,\r\n\t  hideSelected: null,\r\n\t  duplicates: false,\r\n\t  addPrecedence: false,\r\n\t  selectOnTab: false,\r\n\t  preload: null,\r\n\t  allowEmptyOption: false,\r\n\t  //closeAfterSelect: false,\r\n\t  refreshThrottle: 300,\r\n\t  loadThrottle: 300,\r\n\t  loadingClass: 'loading',\r\n\t  dataAttr: null,\r\n\t  //'data-data',\r\n\t  optgroupField: 'optgroup',\r\n\t  valueField: 'value',\r\n\t  labelField: 'text',\r\n\t  disabledField: 'disabled',\r\n\t  optgroupLabelField: 'label',\r\n\t  optgroupValueField: 'value',\r\n\t  lockOptgroupOrder: false,\r\n\t  sortField: '$order',\r\n\t  searchField: ['text'],\r\n\t  searchConjunction: 'and',\r\n\t  mode: null,\r\n\t  wrapperClass: 'ts-wrapper',\r\n\t  controlClass: 'ts-control',\r\n\t  dropdownClass: 'ts-dropdown',\r\n\t  dropdownContentClass: 'ts-dropdown-content',\r\n\t  itemClass: 'item',\r\n\t  optionClass: 'option',\r\n\t  dropdownParent: null,\r\n\t  controlInput: '<input type=\"text\" autocomplete=\"off\" size=\"1\" />',\r\n\t  copyClassesToDropdown: false,\r\n\t  placeholder: null,\r\n\t  hidePlaceholder: null,\r\n\t  shouldLoad: function (query) {\r\n\t    return query.length > 0;\r\n\t  },\r\n\t  /*\r\n\t  load                 : null, // function(query, callback) { ... }\r\n\t  score                : null, // function(search) { ... }\r\n\t  onInitialize         : null, // function() { ... }\r\n\t  onChange             : null, // function(value) { ... }\r\n\t  onItemAdd            : null, // function(value, $item) { ... }\r\n\t  onItemRemove         : null, // function(value) { ... }\r\n\t  onClear              : null, // function() { ... }\r\n\t  onOptionAdd          : null, // function(value, data) { ... }\r\n\t  onOptionRemove       : null, // function(value) { ... }\r\n\t  onOptionClear        : null, // function() { ... }\r\n\t  onOptionGroupAdd     : null, // function(id, data) { ... }\r\n\t  onOptionGroupRemove  : null, // function(id) { ... }\r\n\t  onOptionGroupClear   : null, // function() { ... }\r\n\t  onDropdownOpen       : null, // function(dropdown) { ... }\r\n\t  onDropdownClose      : null, // function(dropdown) { ... }\r\n\t  onType               : null, // function(str) { ... }\r\n\t  onDelete             : null, // function(values) { ... }\r\n\t  */\r\n\r\n\t  render: {\r\n\t    /*\r\n\t    item: null,\r\n\t    optgroup: null,\r\n\t    optgroup_header: null,\r\n\t    option: null,\r\n\t    option_create: null\r\n\t    */\r\n\t  }\r\n\t};\r\n\r\n\t/**\r\n\t * Converts a scalar to its best string representation\r\n\t * for hash keys and HTML attribute values.\r\n\t *\r\n\t * Transformations:\r\n\t *   'str'     -> 'str'\r\n\t *   null      -> ''\r\n\t *   undefined -> ''\r\n\t *   true      -> '1'\r\n\t *   false     -> '0'\r\n\t *   0         -> '0'\r\n\t *   1         -> '1'\r\n\t *\r\n\t */\r\n\tconst hash_key = value => {\r\n\t  if (typeof value === 'undefined' || value === null) return null;\r\n\t  return get_hash(value);\r\n\t};\r\n\tconst get_hash = value => {\r\n\t  if (typeof value === 'boolean') return value ? '1' : '0';\r\n\t  return value + '';\r\n\t};\r\n\r\n\t/**\r\n\t * Escapes a string for use within HTML.\r\n\t *\r\n\t */\r\n\tconst escape_html = str => {\r\n\t  return (str + '').replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\r\n\t};\r\n\r\n\t/**\r\n\t * use setTimeout if timeout > 0 \r\n\t */\r\n\tconst timeout = (fn, timeout) => {\r\n\t  if (timeout > 0) {\r\n\t    return setTimeout(fn, timeout);\r\n\t  }\r\n\t  fn.call(null);\r\n\t  return null;\r\n\t};\r\n\r\n\t/**\r\n\t * Debounce the user provided load function\r\n\t *\r\n\t */\r\n\tconst loadDebounce = (fn, delay) => {\r\n\t  var timeout;\r\n\t  return function (value, callback) {\r\n\t    var self = this;\r\n\t    if (timeout) {\r\n\t      self.loading = Math.max(self.loading - 1, 0);\r\n\t      clearTimeout(timeout);\r\n\t    }\r\n\t    timeout = setTimeout(function () {\r\n\t      timeout = null;\r\n\t      self.loadedSearches[value] = true;\r\n\t      fn.call(self, value, callback);\r\n\t    }, delay);\r\n\t  };\r\n\t};\r\n\r\n\t/**\r\n\t * Debounce all fired events types listed in `types`\r\n\t * while executing the provided `fn`.\r\n\t *\r\n\t */\r\n\tconst debounce_events = (self, types, fn) => {\r\n\t  var type;\r\n\t  var trigger = self.trigger;\r\n\t  var event_args = {};\r\n\r\n\t  // override trigger method\r\n\t  self.trigger = function () {\r\n\t    var type = arguments[0];\r\n\t    if (types.indexOf(type) !== -1) {\r\n\t      event_args[type] = arguments;\r\n\t    } else {\r\n\t      return trigger.apply(self, arguments);\r\n\t    }\r\n\t  };\r\n\r\n\t  // invoke provided function\r\n\t  fn.apply(self, []);\r\n\t  self.trigger = trigger;\r\n\r\n\t  // trigger queued events\r\n\t  for (type of types) {\r\n\t    if (type in event_args) {\r\n\t      trigger.apply(self, event_args[type]);\r\n\t    }\r\n\t  }\r\n\t};\r\n\r\n\t/**\r\n\t * Determines the current selection within a text input control.\r\n\t * Returns an object containing:\r\n\t *   - start\r\n\t *   - length\r\n\t *\r\n\t * Note: \"selectionStart, selectionEnd ... apply only to inputs of types text, search, URL, tel and password\"\r\n\t * \t- https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/setSelectionRange\r\n\t */\r\n\tconst getSelection = input => {\r\n\t  return {\r\n\t    start: input.selectionStart || 0,\r\n\t    length: (input.selectionEnd || 0) - (input.selectionStart || 0)\r\n\t  };\r\n\t};\r\n\r\n\t/**\r\n\t * Prevent default\r\n\t *\r\n\t */\r\n\tconst preventDefault = (evt, stop = false) => {\r\n\t  if (evt) {\r\n\t    evt.preventDefault();\r\n\t    if (stop) {\r\n\t      evt.stopPropagation();\r\n\t    }\r\n\t  }\r\n\t};\r\n\r\n\t/**\r\n\t * Add event helper\r\n\t *\r\n\t */\r\n\tconst addEvent = (target, type, callback, options) => {\r\n\t  target.addEventListener(type, callback, options);\r\n\t};\r\n\r\n\t/**\r\n\t * Return true if the requested key is down\r\n\t * Will return false if more than one control character is pressed ( when [ctrl+shift+a] != [ctrl+a] )\r\n\t * The current evt may not always set ( eg calling advanceSelection() )\r\n\t *\r\n\t */\r\n\tconst isKeyDown = (key_name, evt) => {\r\n\t  if (!evt) {\r\n\t    return false;\r\n\t  }\r\n\t  if (!evt[key_name]) {\r\n\t    return false;\r\n\t  }\r\n\t  var count = (evt.altKey ? 1 : 0) + (evt.ctrlKey ? 1 : 0) + (evt.shiftKey ? 1 : 0) + (evt.metaKey ? 1 : 0);\r\n\t  if (count === 1) {\r\n\t    return true;\r\n\t  }\r\n\t  return false;\r\n\t};\r\n\r\n\t/**\r\n\t * Get the id of an element\r\n\t * If the id attribute is not set, set the attribute with the given id\r\n\t *\r\n\t */\r\n\tconst getId = (el, id) => {\r\n\t  const existing_id = el.getAttribute('id');\r\n\t  if (existing_id) {\r\n\t    return existing_id;\r\n\t  }\r\n\t  el.setAttribute('id', id);\r\n\t  return id;\r\n\t};\r\n\r\n\t/**\r\n\t * Returns a string with backslashes added before characters that need to be escaped.\r\n\t */\r\n\tconst addSlashes = str => {\r\n\t  return str.replace(/[\\\\\"']/g, '\\\\$&');\r\n\t};\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst append = (parent, node) => {\r\n\t  if (node) parent.append(node);\r\n\t};\r\n\r\n\tfunction getSettings(input, settings_user) {\r\n\t  var settings = Object.assign({}, defaults, settings_user);\r\n\t  var attr_data = settings.dataAttr;\r\n\t  var field_label = settings.labelField;\r\n\t  var field_value = settings.valueField;\r\n\t  var field_disabled = settings.disabledField;\r\n\t  var field_optgroup = settings.optgroupField;\r\n\t  var field_optgroup_label = settings.optgroupLabelField;\r\n\t  var field_optgroup_value = settings.optgroupValueField;\r\n\t  var tag_name = input.tagName.toLowerCase();\r\n\t  var placeholder = input.getAttribute('placeholder') || input.getAttribute('data-placeholder');\r\n\t  if (!placeholder && !settings.allowEmptyOption) {\r\n\t    let option = input.querySelector('option[value=\"\"]');\r\n\t    if (option) {\r\n\t      placeholder = option.textContent;\r\n\t    }\r\n\t  }\r\n\t  var settings_element = {\r\n\t    placeholder: placeholder,\r\n\t    options: [],\r\n\t    optgroups: [],\r\n\t    items: [],\r\n\t    maxItems: null\r\n\t  };\r\n\r\n\t  /**\r\n\t   * Initialize from a <select> element.\r\n\t   *\r\n\t   */\r\n\t  var init_select = () => {\r\n\t    var tagName;\r\n\t    var options = settings_element.options;\r\n\t    var optionsMap = {};\r\n\t    var group_count = 1;\r\n\t    let $order = 0;\r\n\t    var readData = el => {\r\n\t      var data = Object.assign({}, el.dataset); // get plain object from DOMStringMap\r\n\t      var json = attr_data && data[attr_data];\r\n\t      if (typeof json === 'string' && json.length) {\r\n\t        data = Object.assign(data, JSON.parse(json));\r\n\t      }\r\n\t      return data;\r\n\t    };\r\n\t    var addOption = (option, group) => {\r\n\t      var value = hash_key(option.value);\r\n\t      if (value == null) return;\r\n\t      if (!value && !settings.allowEmptyOption) return;\r\n\r\n\t      // if the option already exists, it's probably been\r\n\t      // duplicated in another optgroup. in this case, push\r\n\t      // the current group to the \"optgroup\" property on the\r\n\t      // existing option so that it's rendered in both places.\r\n\t      if (optionsMap.hasOwnProperty(value)) {\r\n\t        if (group) {\r\n\t          var arr = optionsMap[value][field_optgroup];\r\n\t          if (!arr) {\r\n\t            optionsMap[value][field_optgroup] = group;\r\n\t          } else if (!Array.isArray(arr)) {\r\n\t            optionsMap[value][field_optgroup] = [arr, group];\r\n\t          } else {\r\n\t            arr.push(group);\r\n\t          }\r\n\t        }\r\n\t      } else {\r\n\t        var option_data = readData(option);\r\n\t        option_data[field_label] = option_data[field_label] || option.textContent;\r\n\t        option_data[field_value] = option_data[field_value] || value;\r\n\t        option_data[field_disabled] = option_data[field_disabled] || option.disabled;\r\n\t        option_data[field_optgroup] = option_data[field_optgroup] || group;\r\n\t        option_data.$option = option;\r\n\t        option_data.$order = option_data.$order || ++$order;\r\n\t        optionsMap[value] = option_data;\r\n\t        options.push(option_data);\r\n\t      }\r\n\t      if (option.selected) {\r\n\t        settings_element.items.push(value);\r\n\t      }\r\n\t    };\r\n\t    var addGroup = optgroup => {\r\n\t      var id, optgroup_data;\r\n\t      optgroup_data = readData(optgroup);\r\n\t      optgroup_data[field_optgroup_label] = optgroup_data[field_optgroup_label] || optgroup.getAttribute('label') || '';\r\n\t      optgroup_data[field_optgroup_value] = optgroup_data[field_optgroup_value] || group_count++;\r\n\t      optgroup_data[field_disabled] = optgroup_data[field_disabled] || optgroup.disabled;\r\n\t      optgroup_data.$order = optgroup_data.$order || ++$order;\r\n\t      settings_element.optgroups.push(optgroup_data);\r\n\t      id = optgroup_data[field_optgroup_value];\r\n\t      iterate(optgroup.children, option => {\r\n\t        addOption(option, id);\r\n\t      });\r\n\t    };\r\n\t    settings_element.maxItems = input.hasAttribute('multiple') ? null : 1;\r\n\t    iterate(input.children, child => {\r\n\t      tagName = child.tagName.toLowerCase();\r\n\t      if (tagName === 'optgroup') {\r\n\t        addGroup(child);\r\n\t      } else if (tagName === 'option') {\r\n\t        addOption(child);\r\n\t      }\r\n\t    });\r\n\t  };\r\n\r\n\t  /**\r\n\t   * Initialize from a <input type=\"text\"> element.\r\n\t   *\r\n\t   */\r\n\t  var init_textbox = () => {\r\n\t    const data_raw = input.getAttribute(attr_data);\r\n\t    if (!data_raw) {\r\n\t      var value = input.value.trim() || '';\r\n\t      if (!settings.allowEmptyOption && !value.length) return;\r\n\t      const values = value.split(settings.delimiter);\r\n\t      iterate(values, value => {\r\n\t        const option = {};\r\n\t        option[field_label] = value;\r\n\t        option[field_value] = value;\r\n\t        settings_element.options.push(option);\r\n\t      });\r\n\t      settings_element.items = values;\r\n\t    } else {\r\n\t      settings_element.options = JSON.parse(data_raw);\r\n\t      iterate(settings_element.options, opt => {\r\n\t        settings_element.items.push(opt[field_value]);\r\n\t      });\r\n\t    }\r\n\t  };\r\n\t  if (tag_name === 'select') {\r\n\t    init_select();\r\n\t  } else {\r\n\t    init_textbox();\r\n\t  }\r\n\t  return Object.assign({}, defaults, settings_element, settings_user);\r\n\t}\r\n\r\n\tvar instance_i = 0;\r\n\tclass TomSelect extends MicroPlugin(MicroEvent) {\r\n\t  constructor(input_arg, user_settings) {\r\n\t    super();\r\n\t    this.control_input = void 0;\r\n\t    this.wrapper = void 0;\r\n\t    this.dropdown = void 0;\r\n\t    this.control = void 0;\r\n\t    this.dropdown_content = void 0;\r\n\t    this.focus_node = void 0;\r\n\t    this.order = 0;\r\n\t    this.settings = void 0;\r\n\t    this.input = void 0;\r\n\t    this.tabIndex = void 0;\r\n\t    this.is_select_tag = void 0;\r\n\t    this.rtl = void 0;\r\n\t    this.inputId = void 0;\r\n\t    this._destroy = void 0;\r\n\t    this.sifter = void 0;\r\n\t    this.isOpen = false;\r\n\t    this.isDisabled = false;\r\n\t    this.isReadOnly = false;\r\n\t    this.isRequired = void 0;\r\n\t    this.isInvalid = false;\r\n\t    // @deprecated 1.8\r\n\t    this.isValid = true;\r\n\t    this.isLocked = false;\r\n\t    this.isFocused = false;\r\n\t    this.isInputHidden = false;\r\n\t    this.isSetup = false;\r\n\t    this.ignoreFocus = false;\r\n\t    this.ignoreHover = false;\r\n\t    this.hasOptions = false;\r\n\t    this.currentResults = void 0;\r\n\t    this.lastValue = '';\r\n\t    this.caretPos = 0;\r\n\t    this.loading = 0;\r\n\t    this.loadedSearches = {};\r\n\t    this.activeOption = null;\r\n\t    this.activeItems = [];\r\n\t    this.optgroups = {};\r\n\t    this.options = {};\r\n\t    this.userOptions = {};\r\n\t    this.items = [];\r\n\t    this.refreshTimeout = null;\r\n\t    instance_i++;\r\n\t    var dir;\r\n\t    var input = getDom(input_arg);\r\n\t    if (input.tomselect) {\r\n\t      throw new Error('Tom Select already initialized on this element');\r\n\t    }\r\n\t    input.tomselect = this;\r\n\r\n\t    // detect rtl environment\r\n\t    var computedStyle = window.getComputedStyle && window.getComputedStyle(input, null);\r\n\t    dir = computedStyle.getPropertyValue('direction');\r\n\r\n\t    // setup default state\r\n\t    const settings = getSettings(input, user_settings);\r\n\t    this.settings = settings;\r\n\t    this.input = input;\r\n\t    this.tabIndex = input.tabIndex || 0;\r\n\t    this.is_select_tag = input.tagName.toLowerCase() === 'select';\r\n\t    this.rtl = /rtl/i.test(dir);\r\n\t    this.inputId = getId(input, 'tomselect-' + instance_i);\r\n\t    this.isRequired = input.required;\r\n\r\n\t    // search system\r\n\t    this.sifter = new Sifter(this.options, {\r\n\t      diacritics: settings.diacritics\r\n\t    });\r\n\r\n\t    // option-dependent defaults\r\n\t    settings.mode = settings.mode || (settings.maxItems === 1 ? 'single' : 'multi');\r\n\t    if (typeof settings.hideSelected !== 'boolean') {\r\n\t      settings.hideSelected = settings.mode === 'multi';\r\n\t    }\r\n\t    if (typeof settings.hidePlaceholder !== 'boolean') {\r\n\t      settings.hidePlaceholder = settings.mode !== 'multi';\r\n\t    }\r\n\r\n\t    // set up createFilter callback\r\n\t    var filter = settings.createFilter;\r\n\t    if (typeof filter !== 'function') {\r\n\t      if (typeof filter === 'string') {\r\n\t        filter = new RegExp(filter);\r\n\t      }\r\n\t      if (filter instanceof RegExp) {\r\n\t        settings.createFilter = input => filter.test(input);\r\n\t      } else {\r\n\t        settings.createFilter = value => {\r\n\t          return this.settings.duplicates || !this.options[value];\r\n\t        };\r\n\t      }\r\n\t    }\r\n\t    this.initializePlugins(settings.plugins);\r\n\t    this.setupCallbacks();\r\n\t    this.setupTemplates();\r\n\r\n\t    // Create all elements\r\n\t    const wrapper = getDom('<div>');\r\n\t    const control = getDom('<div>');\r\n\t    const dropdown = this._render('dropdown');\r\n\t    const dropdown_content = getDom(`<div role=\"listbox\" tabindex=\"-1\">`);\r\n\t    const classes = this.input.getAttribute('class') || '';\r\n\t    const inputMode = settings.mode;\r\n\t    var control_input;\r\n\t    addClasses(wrapper, settings.wrapperClass, classes, inputMode);\r\n\t    addClasses(control, settings.controlClass);\r\n\t    append(wrapper, control);\r\n\t    addClasses(dropdown, settings.dropdownClass, inputMode);\r\n\t    if (settings.copyClassesToDropdown) {\r\n\t      addClasses(dropdown, classes);\r\n\t    }\r\n\t    addClasses(dropdown_content, settings.dropdownContentClass);\r\n\t    append(dropdown, dropdown_content);\r\n\t    getDom(settings.dropdownParent || wrapper).appendChild(dropdown);\r\n\r\n\t    // default controlInput\r\n\t    if (isHtmlString(settings.controlInput)) {\r\n\t      control_input = getDom(settings.controlInput);\r\n\r\n\t      // set attributes\r\n\t      var attrs = ['autocorrect', 'autocapitalize', 'autocomplete', 'spellcheck'];\r\n\t      iterate$1(attrs, attr => {\r\n\t        if (input.getAttribute(attr)) {\r\n\t          setAttr(control_input, {\r\n\t            [attr]: input.getAttribute(attr)\r\n\t          });\r\n\t        }\r\n\t      });\r\n\t      control_input.tabIndex = -1;\r\n\t      control.appendChild(control_input);\r\n\t      this.focus_node = control_input;\r\n\r\n\t      // dom element\r\n\t    } else if (settings.controlInput) {\r\n\t      control_input = getDom(settings.controlInput);\r\n\t      this.focus_node = control_input;\r\n\t    } else {\r\n\t      control_input = getDom('<input/>');\r\n\t      this.focus_node = control;\r\n\t    }\r\n\t    this.wrapper = wrapper;\r\n\t    this.dropdown = dropdown;\r\n\t    this.dropdown_content = dropdown_content;\r\n\t    this.control = control;\r\n\t    this.control_input = control_input;\r\n\t    this.setup();\r\n\t  }\r\n\r\n\t  /**\r\n\t   * set up event bindings.\r\n\t   *\r\n\t   */\r\n\t  setup() {\r\n\t    const self = this;\r\n\t    const settings = self.settings;\r\n\t    const control_input = self.control_input;\r\n\t    const dropdown = self.dropdown;\r\n\t    const dropdown_content = self.dropdown_content;\r\n\t    const wrapper = self.wrapper;\r\n\t    const control = self.control;\r\n\t    const input = self.input;\r\n\t    const focus_node = self.focus_node;\r\n\t    const passive_event = {\r\n\t      passive: true\r\n\t    };\r\n\t    const listboxId = self.inputId + '-ts-dropdown';\r\n\t    setAttr(dropdown_content, {\r\n\t      id: listboxId\r\n\t    });\r\n\t    setAttr(focus_node, {\r\n\t      role: 'combobox',\r\n\t      'aria-haspopup': 'listbox',\r\n\t      'aria-expanded': 'false',\r\n\t      'aria-controls': listboxId\r\n\t    });\r\n\t    const control_id = getId(focus_node, self.inputId + '-ts-control');\r\n\t    const query = \"label[for='\" + escapeQuery(self.inputId) + \"']\";\r\n\t    const label = document.querySelector(query);\r\n\t    const label_click = self.focus.bind(self);\r\n\t    if (label) {\r\n\t      addEvent(label, 'click', label_click);\r\n\t      setAttr(label, {\r\n\t        for: control_id\r\n\t      });\r\n\t      const label_id = getId(label, self.inputId + '-ts-label');\r\n\t      setAttr(focus_node, {\r\n\t        'aria-labelledby': label_id\r\n\t      });\r\n\t      setAttr(dropdown_content, {\r\n\t        'aria-labelledby': label_id\r\n\t      });\r\n\t    }\r\n\t    wrapper.style.width = input.style.width;\r\n\t    if (self.plugins.names.length) {\r\n\t      const classes_plugins = 'plugin-' + self.plugins.names.join(' plugin-');\r\n\t      addClasses([wrapper, dropdown], classes_plugins);\r\n\t    }\r\n\t    if ((settings.maxItems === null || settings.maxItems > 1) && self.is_select_tag) {\r\n\t      setAttr(input, {\r\n\t        multiple: 'multiple'\r\n\t      });\r\n\t    }\r\n\t    if (settings.placeholder) {\r\n\t      setAttr(control_input, {\r\n\t        placeholder: settings.placeholder\r\n\t      });\r\n\t    }\r\n\r\n\t    // if splitOn was not passed in, construct it from the delimiter to allow pasting universally\r\n\t    if (!settings.splitOn && settings.delimiter) {\r\n\t      settings.splitOn = new RegExp('\\\\s*' + escape_regex(settings.delimiter) + '+\\\\s*');\r\n\t    }\r\n\r\n\t    // debounce user defined load() if loadThrottle > 0\r\n\t    // after initializePlugins() so plugins can create/modify user defined loaders\r\n\t    if (settings.load && settings.loadThrottle) {\r\n\t      settings.load = loadDebounce(settings.load, settings.loadThrottle);\r\n\t    }\r\n\t    addEvent(dropdown, 'mousemove', () => {\r\n\t      self.ignoreHover = false;\r\n\t    });\r\n\t    addEvent(dropdown, 'mouseenter', e => {\r\n\t      var target_match = parentMatch(e.target, '[data-selectable]', dropdown);\r\n\t      if (target_match) self.onOptionHover(e, target_match);\r\n\t    }, {\r\n\t      capture: true\r\n\t    });\r\n\r\n\t    // clicking on an option should select it\r\n\t    addEvent(dropdown, 'click', evt => {\r\n\t      const option = parentMatch(evt.target, '[data-selectable]');\r\n\t      if (option) {\r\n\t        self.onOptionSelect(evt, option);\r\n\t        preventDefault(evt, true);\r\n\t      }\r\n\t    });\r\n\t    addEvent(control, 'click', evt => {\r\n\t      var target_match = parentMatch(evt.target, '[data-ts-item]', control);\r\n\t      if (target_match && self.onItemSelect(evt, target_match)) {\r\n\t        preventDefault(evt, true);\r\n\t        return;\r\n\t      }\r\n\r\n\t      // retain focus (see control_input mousedown)\r\n\t      if (control_input.value != '') {\r\n\t        return;\r\n\t      }\r\n\t      self.onClick();\r\n\t      preventDefault(evt, true);\r\n\t    });\r\n\r\n\t    // keydown on focus_node for arrow_down/arrow_up\r\n\t    addEvent(focus_node, 'keydown', e => self.onKeyDown(e));\r\n\r\n\t    // keypress and input/keyup\r\n\t    addEvent(control_input, 'keypress', e => self.onKeyPress(e));\r\n\t    addEvent(control_input, 'input', e => self.onInput(e));\r\n\t    addEvent(focus_node, 'blur', e => self.onBlur(e));\r\n\t    addEvent(focus_node, 'focus', e => self.onFocus(e));\r\n\t    addEvent(control_input, 'paste', e => self.onPaste(e));\r\n\t    const doc_mousedown = evt => {\r\n\t      // blur if target is outside of this instance\r\n\t      // dropdown is not always inside wrapper\r\n\t      const target = evt.composedPath()[0];\r\n\t      if (!wrapper.contains(target) && !dropdown.contains(target)) {\r\n\t        if (self.isFocused) {\r\n\t          self.blur();\r\n\t        }\r\n\t        self.inputState();\r\n\t        return;\r\n\t      }\r\n\r\n\t      // retain focus by preventing native handling. if the\r\n\t      // event target is the input it should not be modified.\r\n\t      // otherwise, text selection within the input won't work.\r\n\t      // Fixes bug #212 which is no covered by tests\r\n\t      if (target == control_input && self.isOpen) {\r\n\t        evt.stopPropagation();\r\n\r\n\t        // clicking anywhere in the control should not blur the control_input (which would close the dropdown)\r\n\t      } else {\r\n\t        preventDefault(evt, true);\r\n\t      }\r\n\t    };\r\n\t    const win_scroll = () => {\r\n\t      if (self.isOpen) {\r\n\t        self.positionDropdown();\r\n\t      }\r\n\t    };\r\n\t    addEvent(document, 'mousedown', doc_mousedown);\r\n\t    addEvent(window, 'scroll', win_scroll, passive_event);\r\n\t    addEvent(window, 'resize', win_scroll, passive_event);\r\n\t    this._destroy = () => {\r\n\t      document.removeEventListener('mousedown', doc_mousedown);\r\n\t      window.removeEventListener('scroll', win_scroll);\r\n\t      window.removeEventListener('resize', win_scroll);\r\n\t      if (label) label.removeEventListener('click', label_click);\r\n\t    };\r\n\r\n\t    // store original html and tab index so that they can be\r\n\t    // restored when the destroy() method is called.\r\n\t    this.revertSettings = {\r\n\t      innerHTML: input.innerHTML,\r\n\t      tabIndex: input.tabIndex\r\n\t    };\r\n\t    input.tabIndex = -1;\r\n\t    input.insertAdjacentElement('afterend', self.wrapper);\r\n\t    self.sync(false);\r\n\t    settings.items = [];\r\n\t    delete settings.optgroups;\r\n\t    delete settings.options;\r\n\t    addEvent(input, 'invalid', () => {\r\n\t      if (self.isValid) {\r\n\t        self.isValid = false;\r\n\t        self.isInvalid = true;\r\n\t        self.refreshState();\r\n\t      }\r\n\t    });\r\n\t    self.updateOriginalInput();\r\n\t    self.refreshItems();\r\n\t    self.close(false);\r\n\t    self.inputState();\r\n\t    self.isSetup = true;\r\n\t    if (input.disabled) {\r\n\t      self.disable();\r\n\t    } else if (input.readOnly) {\r\n\t      self.setReadOnly(true);\r\n\t    } else {\r\n\t      self.enable(); //sets tabIndex\r\n\t    }\r\n\r\n\t    self.on('change', this.onChange);\r\n\t    addClasses(input, 'tomselected', 'ts-hidden-accessible');\r\n\t    self.trigger('initialize');\r\n\r\n\t    // preload options\r\n\t    if (settings.preload === true) {\r\n\t      self.preload();\r\n\t    }\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Register options and optgroups\r\n\t   *\r\n\t   */\r\n\t  setupOptions(options = [], optgroups = []) {\r\n\t    // build options table\r\n\t    this.addOptions(options);\r\n\r\n\t    // build optgroup table\r\n\t    iterate$1(optgroups, optgroup => {\r\n\t      this.registerOptionGroup(optgroup);\r\n\t    });\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Sets up default rendering functions.\r\n\t   */\r\n\t  setupTemplates() {\r\n\t    var self = this;\r\n\t    var field_label = self.settings.labelField;\r\n\t    var field_optgroup = self.settings.optgroupLabelField;\r\n\t    var templates = {\r\n\t      'optgroup': data => {\r\n\t        let optgroup = document.createElement('div');\r\n\t        optgroup.className = 'optgroup';\r\n\t        optgroup.appendChild(data.options);\r\n\t        return optgroup;\r\n\t      },\r\n\t      'optgroup_header': (data, escape) => {\r\n\t        return '<div class=\"optgroup-header\">' + escape(data[field_optgroup]) + '</div>';\r\n\t      },\r\n\t      'option': (data, escape) => {\r\n\t        return '<div>' + escape(data[field_label]) + '</div>';\r\n\t      },\r\n\t      'item': (data, escape) => {\r\n\t        return '<div>' + escape(data[field_label]) + '</div>';\r\n\t      },\r\n\t      'option_create': (data, escape) => {\r\n\t        return '<div class=\"create\">Add <strong>' + escape(data.input) + '</strong>&hellip;</div>';\r\n\t      },\r\n\t      'no_results': () => {\r\n\t        return '<div class=\"no-results\">No results found</div>';\r\n\t      },\r\n\t      'loading': () => {\r\n\t        return '<div class=\"spinner\"></div>';\r\n\t      },\r\n\t      'not_loading': () => {},\r\n\t      'dropdown': () => {\r\n\t        return '<div></div>';\r\n\t      }\r\n\t    };\r\n\t    self.settings.render = Object.assign({}, templates, self.settings.render);\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Maps fired events to callbacks provided\r\n\t   * in the settings used when creating the control.\r\n\t   */\r\n\t  setupCallbacks() {\r\n\t    var key, fn;\r\n\t    var callbacks = {\r\n\t      'initialize': 'onInitialize',\r\n\t      'change': 'onChange',\r\n\t      'item_add': 'onItemAdd',\r\n\t      'item_remove': 'onItemRemove',\r\n\t      'item_select': 'onItemSelect',\r\n\t      'clear': 'onClear',\r\n\t      'option_add': 'onOptionAdd',\r\n\t      'option_remove': 'onOptionRemove',\r\n\t      'option_clear': 'onOptionClear',\r\n\t      'optgroup_add': 'onOptionGroupAdd',\r\n\t      'optgroup_remove': 'onOptionGroupRemove',\r\n\t      'optgroup_clear': 'onOptionGroupClear',\r\n\t      'dropdown_open': 'onDropdownOpen',\r\n\t      'dropdown_close': 'onDropdownClose',\r\n\t      'type': 'onType',\r\n\t      'load': 'onLoad',\r\n\t      'focus': 'onFocus',\r\n\t      'blur': 'onBlur'\r\n\t    };\r\n\t    for (key in callbacks) {\r\n\t      fn = this.settings[callbacks[key]];\r\n\t      if (fn) this.on(key, fn);\r\n\t    }\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Sync the Tom Select instance with the original input or select\r\n\t   *\r\n\t   */\r\n\t  sync(get_settings = true) {\r\n\t    const self = this;\r\n\t    const settings = get_settings ? getSettings(self.input, {\r\n\t      delimiter: self.settings.delimiter\r\n\t    }) : self.settings;\r\n\t    self.setupOptions(settings.options, settings.optgroups);\r\n\t    self.setValue(settings.items || [], true); // silent prevents recursion\r\n\r\n\t    self.lastQuery = null; // so updated options will be displayed in dropdown\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Triggered when the main control element\r\n\t   * has a click event.\r\n\t   *\r\n\t   */\r\n\t  onClick() {\r\n\t    var self = this;\r\n\t    if (self.activeItems.length > 0) {\r\n\t      self.clearActiveItems();\r\n\t      self.focus();\r\n\t      return;\r\n\t    }\r\n\t    if (self.isFocused && self.isOpen) {\r\n\t      self.blur();\r\n\t    } else {\r\n\t      self.focus();\r\n\t    }\r\n\t  }\r\n\r\n\t  /**\r\n\t   * @deprecated v1.7\r\n\t   *\r\n\t   */\r\n\t  onMouseDown() {}\r\n\r\n\t  /**\r\n\t   * Triggered when the value of the control has been changed.\r\n\t   * This should propagate the event to the original DOM\r\n\t   * input / select element.\r\n\t   */\r\n\t  onChange() {\r\n\t    triggerEvent(this.input, 'input');\r\n\t    triggerEvent(this.input, 'change');\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Triggered on <input> paste.\r\n\t   *\r\n\t   */\r\n\t  onPaste(e) {\r\n\t    var self = this;\r\n\t    if (self.isInputHidden || self.isLocked) {\r\n\t      preventDefault(e);\r\n\t      return;\r\n\t    }\r\n\r\n\t    // If a regex or string is included, this will split the pasted\r\n\t    // input and create Items for each separate value\r\n\t    if (!self.settings.splitOn) {\r\n\t      return;\r\n\t    }\r\n\r\n\t    // Wait for pasted text to be recognized in value\r\n\t    setTimeout(() => {\r\n\t      var pastedText = self.inputValue();\r\n\t      if (!pastedText.match(self.settings.splitOn)) {\r\n\t        return;\r\n\t      }\r\n\t      var splitInput = pastedText.trim().split(self.settings.splitOn);\r\n\t      iterate$1(splitInput, piece => {\r\n\t        const hash = hash_key(piece);\r\n\t        if (hash) {\r\n\t          if (this.options[piece]) {\r\n\t            self.addItem(piece);\r\n\t          } else {\r\n\t            self.createItem(piece);\r\n\t          }\r\n\t        }\r\n\t      });\r\n\t    }, 0);\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Triggered on <input> keypress.\r\n\t   *\r\n\t   */\r\n\t  onKeyPress(e) {\r\n\t    var self = this;\r\n\t    if (self.isLocked) {\r\n\t      preventDefault(e);\r\n\t      return;\r\n\t    }\r\n\t    var character = String.fromCharCode(e.keyCode || e.which);\r\n\t    if (self.settings.create && self.settings.mode === 'multi' && character === self.settings.delimiter) {\r\n\t      self.createItem();\r\n\t      preventDefault(e);\r\n\t      return;\r\n\t    }\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Triggered on <input> keydown.\r\n\t   *\r\n\t   */\r\n\t  onKeyDown(e) {\r\n\t    var self = this;\r\n\t    self.ignoreHover = true;\r\n\t    if (self.isLocked) {\r\n\t      if (e.keyCode !== KEY_TAB) {\r\n\t        preventDefault(e);\r\n\t      }\r\n\t      return;\r\n\t    }\r\n\t    switch (e.keyCode) {\r\n\t      // ctrl+A: select all\r\n\t      case KEY_A:\r\n\t        if (isKeyDown(KEY_SHORTCUT, e)) {\r\n\t          if (self.control_input.value == '') {\r\n\t            preventDefault(e);\r\n\t            self.selectAll();\r\n\t            return;\r\n\t          }\r\n\t        }\r\n\t        break;\r\n\r\n\t      // esc: close dropdown\r\n\t      case KEY_ESC:\r\n\t        if (self.isOpen) {\r\n\t          preventDefault(e, true);\r\n\t          self.close();\r\n\t        }\r\n\t        self.clearActiveItems();\r\n\t        return;\r\n\r\n\t      // down: open dropdown or move selection down\r\n\t      case KEY_DOWN:\r\n\t        if (!self.isOpen && self.hasOptions) {\r\n\t          self.open();\r\n\t        } else if (self.activeOption) {\r\n\t          let next = self.getAdjacent(self.activeOption, 1);\r\n\t          if (next) self.setActiveOption(next);\r\n\t        }\r\n\t        preventDefault(e);\r\n\t        return;\r\n\r\n\t      // up: move selection up\r\n\t      case KEY_UP:\r\n\t        if (self.activeOption) {\r\n\t          let prev = self.getAdjacent(self.activeOption, -1);\r\n\t          if (prev) self.setActiveOption(prev);\r\n\t        }\r\n\t        preventDefault(e);\r\n\t        return;\r\n\r\n\t      // return: select active option\r\n\t      case KEY_RETURN:\r\n\t        if (self.canSelect(self.activeOption)) {\r\n\t          self.onOptionSelect(e, self.activeOption);\r\n\t          preventDefault(e);\r\n\r\n\t          // if the option_create=null, the dropdown might be closed\r\n\t        } else if (self.settings.create && self.createItem()) {\r\n\t          preventDefault(e);\r\n\r\n\t          // don't submit form when searching for a value\r\n\t        } else if (document.activeElement == self.control_input && self.isOpen) {\r\n\t          preventDefault(e);\r\n\t        }\r\n\t        return;\r\n\r\n\t      // left: modifiy item selection to the left\r\n\t      case KEY_LEFT:\r\n\t        self.advanceSelection(-1, e);\r\n\t        return;\r\n\r\n\t      // right: modifiy item selection to the right\r\n\t      case KEY_RIGHT:\r\n\t        self.advanceSelection(1, e);\r\n\t        return;\r\n\r\n\t      // tab: select active option and/or create item\r\n\t      case KEY_TAB:\r\n\t        if (self.settings.selectOnTab) {\r\n\t          if (self.canSelect(self.activeOption)) {\r\n\t            self.onOptionSelect(e, self.activeOption);\r\n\r\n\t            // prevent default [tab] behaviour of jump to the next field\r\n\t            // if select isFull, then the dropdown won't be open and [tab] will work normally\r\n\t            preventDefault(e);\r\n\t          }\r\n\t          if (self.settings.create && self.createItem()) {\r\n\t            preventDefault(e);\r\n\t          }\r\n\t        }\r\n\t        return;\r\n\r\n\t      // delete|backspace: delete items\r\n\t      case KEY_BACKSPACE:\r\n\t      case KEY_DELETE:\r\n\t        self.deleteSelection(e);\r\n\t        return;\r\n\t    }\r\n\r\n\t    // don't enter text in the control_input when active items are selected\r\n\t    if (self.isInputHidden && !isKeyDown(KEY_SHORTCUT, e)) {\r\n\t      preventDefault(e);\r\n\t    }\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Triggered on <input> keyup.\r\n\t   *\r\n\t   */\r\n\t  onInput(e) {\r\n\t    if (this.isLocked) {\r\n\t      return;\r\n\t    }\r\n\t    const value = this.inputValue();\r\n\t    if (this.lastValue === value) return;\r\n\t    this.lastValue = value;\r\n\t    if (value == '') {\r\n\t      this._onInput();\r\n\t      return;\r\n\t    }\r\n\t    if (this.refreshTimeout) {\r\n\t      clearTimeout(this.refreshTimeout);\r\n\t    }\r\n\t    this.refreshTimeout = timeout(() => {\r\n\t      this.refreshTimeout = null;\r\n\t      this._onInput();\r\n\t    }, this.settings.refreshThrottle);\r\n\t  }\r\n\t  _onInput() {\r\n\t    const value = this.lastValue;\r\n\t    if (this.settings.shouldLoad.call(this, value)) {\r\n\t      this.load(value);\r\n\t    }\r\n\t    this.refreshOptions();\r\n\t    this.trigger('type', value);\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Triggered when the user rolls over\r\n\t   * an option in the autocomplete dropdown menu.\r\n\t   *\r\n\t   */\r\n\t  onOptionHover(evt, option) {\r\n\t    if (this.ignoreHover) return;\r\n\t    this.setActiveOption(option, false);\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Triggered on <input> focus.\r\n\t   *\r\n\t   */\r\n\t  onFocus(e) {\r\n\t    var self = this;\r\n\t    var wasFocused = self.isFocused;\r\n\t    if (self.isDisabled || self.isReadOnly) {\r\n\t      self.blur();\r\n\t      preventDefault(e);\r\n\t      return;\r\n\t    }\r\n\t    if (self.ignoreFocus) return;\r\n\t    self.isFocused = true;\r\n\t    if (self.settings.preload === 'focus') self.preload();\r\n\t    if (!wasFocused) self.trigger('focus');\r\n\t    if (!self.activeItems.length) {\r\n\t      self.inputState();\r\n\t      self.refreshOptions(!!self.settings.openOnFocus);\r\n\t    }\r\n\t    self.refreshState();\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Triggered on <input> blur.\r\n\t   *\r\n\t   */\r\n\t  onBlur(e) {\r\n\t    if (document.hasFocus() === false) return;\r\n\t    var self = this;\r\n\t    if (!self.isFocused) return;\r\n\t    self.isFocused = false;\r\n\t    self.ignoreFocus = false;\r\n\t    var deactivate = () => {\r\n\t      self.close();\r\n\t      self.setActiveItem();\r\n\t      self.setCaret(self.items.length);\r\n\t      self.trigger('blur');\r\n\t    };\r\n\t    if (self.settings.create && self.settings.createOnBlur) {\r\n\t      self.createItem(null, deactivate);\r\n\t    } else {\r\n\t      deactivate();\r\n\t    }\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Triggered when the user clicks on an option\r\n\t   * in the autocomplete dropdown menu.\r\n\t   *\r\n\t   */\r\n\t  onOptionSelect(evt, option) {\r\n\t    var value,\r\n\t      self = this;\r\n\r\n\t    // should not be possible to trigger a option under a disabled optgroup\r\n\t    if (option.parentElement && option.parentElement.matches('[data-disabled]')) {\r\n\t      return;\r\n\t    }\r\n\t    if (option.classList.contains('create')) {\r\n\t      self.createItem(null, () => {\r\n\t        if (self.settings.closeAfterSelect) {\r\n\t          self.close();\r\n\t        }\r\n\t      });\r\n\t    } else {\r\n\t      value = option.dataset.value;\r\n\t      if (typeof value !== 'undefined') {\r\n\t        self.lastQuery = null;\r\n\t        self.addItem(value);\r\n\t        if (self.settings.closeAfterSelect) {\r\n\t          self.close();\r\n\t        }\r\n\t        if (!self.settings.hideSelected && evt.type && /click/.test(evt.type)) {\r\n\t          self.setActiveOption(option);\r\n\t        }\r\n\t      }\r\n\t    }\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Return true if the given option can be selected\r\n\t   *\r\n\t   */\r\n\t  canSelect(option) {\r\n\t    if (this.isOpen && option && this.dropdown_content.contains(option)) {\r\n\t      return true;\r\n\t    }\r\n\t    return false;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Triggered when the user clicks on an item\r\n\t   * that has been selected.\r\n\t   *\r\n\t   */\r\n\t  onItemSelect(evt, item) {\r\n\t    var self = this;\r\n\t    if (!self.isLocked && self.settings.mode === 'multi') {\r\n\t      preventDefault(evt);\r\n\t      self.setActiveItem(item, evt);\r\n\t      return true;\r\n\t    }\r\n\t    return false;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Determines whether or not to invoke\r\n\t   * the user-provided option provider / loader\r\n\t   *\r\n\t   * Note, there is a subtle difference between\r\n\t   * this.canLoad() and this.settings.shouldLoad();\r\n\t   *\r\n\t   *\t- settings.shouldLoad() is a user-input validator.\r\n\t   *\tWhen false is returned, the not_loading template\r\n\t   *\twill be added to the dropdown\r\n\t   *\r\n\t   *\t- canLoad() is lower level validator that checks\r\n\t   * \tthe Tom Select instance. There is no inherent user\r\n\t   *\tfeedback when canLoad returns false\r\n\t   *\r\n\t   */\r\n\t  canLoad(value) {\r\n\t    if (!this.settings.load) return false;\r\n\t    if (this.loadedSearches.hasOwnProperty(value)) return false;\r\n\t    return true;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Invokes the user-provided option provider / loader.\r\n\t   *\r\n\t   */\r\n\t  load(value) {\r\n\t    const self = this;\r\n\t    if (!self.canLoad(value)) return;\r\n\t    addClasses(self.wrapper, self.settings.loadingClass);\r\n\t    self.loading++;\r\n\t    const callback = self.loadCallback.bind(self);\r\n\t    self.settings.load.call(self, value, callback);\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Invoked by the user-provided option provider\r\n\t   *\r\n\t   */\r\n\t  loadCallback(options, optgroups) {\r\n\t    const self = this;\r\n\t    self.loading = Math.max(self.loading - 1, 0);\r\n\t    self.lastQuery = null;\r\n\t    self.clearActiveOption(); // when new results load, focus should be on first option\r\n\t    self.setupOptions(options, optgroups);\r\n\t    self.refreshOptions(self.isFocused && !self.isInputHidden);\r\n\t    if (!self.loading) {\r\n\t      removeClasses(self.wrapper, self.settings.loadingClass);\r\n\t    }\r\n\t    self.trigger('load', options, optgroups);\r\n\t  }\r\n\t  preload() {\r\n\t    var classList = this.wrapper.classList;\r\n\t    if (classList.contains('preloaded')) return;\r\n\t    classList.add('preloaded');\r\n\t    this.load('');\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Sets the input field of the control to the specified value.\r\n\t   *\r\n\t   */\r\n\t  setTextboxValue(value = '') {\r\n\t    var input = this.control_input;\r\n\t    var changed = input.value !== value;\r\n\t    if (changed) {\r\n\t      input.value = value;\r\n\t      triggerEvent(input, 'update');\r\n\t      this.lastValue = value;\r\n\t    }\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Returns the value of the control. If multiple items\r\n\t   * can be selected (e.g. <select multiple>), this returns\r\n\t   * an array. If only one item can be selected, this\r\n\t   * returns a string.\r\n\t   *\r\n\t   */\r\n\t  getValue() {\r\n\t    if (this.is_select_tag && this.input.hasAttribute('multiple')) {\r\n\t      return this.items;\r\n\t    }\r\n\t    return this.items.join(this.settings.delimiter);\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Resets the selected items to the given value.\r\n\t   *\r\n\t   */\r\n\t  setValue(value, silent) {\r\n\t    var events = silent ? [] : ['change'];\r\n\t    debounce_events(this, events, () => {\r\n\t      this.clear(silent);\r\n\t      this.addItems(value, silent);\r\n\t    });\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Resets the number of max items to the given value\r\n\t   *\r\n\t   */\r\n\t  setMaxItems(value) {\r\n\t    if (value === 0) value = null; //reset to unlimited items.\r\n\t    this.settings.maxItems = value;\r\n\t    this.refreshState();\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Sets the selected item.\r\n\t   *\r\n\t   */\r\n\t  setActiveItem(item, e) {\r\n\t    var self = this;\r\n\t    var eventName;\r\n\t    var i, begin, end, swap;\r\n\t    var last;\r\n\t    if (self.settings.mode === 'single') return;\r\n\r\n\t    // clear the active selection\r\n\t    if (!item) {\r\n\t      self.clearActiveItems();\r\n\t      if (self.isFocused) {\r\n\t        self.inputState();\r\n\t      }\r\n\t      return;\r\n\t    }\r\n\r\n\t    // modify selection\r\n\t    eventName = e && e.type.toLowerCase();\r\n\t    if (eventName === 'click' && isKeyDown('shiftKey', e) && self.activeItems.length) {\r\n\t      last = self.getLastActive();\r\n\t      begin = Array.prototype.indexOf.call(self.control.children, last);\r\n\t      end = Array.prototype.indexOf.call(self.control.children, item);\r\n\t      if (begin > end) {\r\n\t        swap = begin;\r\n\t        begin = end;\r\n\t        end = swap;\r\n\t      }\r\n\t      for (i = begin; i <= end; i++) {\r\n\t        item = self.control.children[i];\r\n\t        if (self.activeItems.indexOf(item) === -1) {\r\n\t          self.setActiveItemClass(item);\r\n\t        }\r\n\t      }\r\n\t      preventDefault(e);\r\n\t    } else if (eventName === 'click' && isKeyDown(KEY_SHORTCUT, e) || eventName === 'keydown' && isKeyDown('shiftKey', e)) {\r\n\t      if (item.classList.contains('active')) {\r\n\t        self.removeActiveItem(item);\r\n\t      } else {\r\n\t        self.setActiveItemClass(item);\r\n\t      }\r\n\t    } else {\r\n\t      self.clearActiveItems();\r\n\t      self.setActiveItemClass(item);\r\n\t    }\r\n\r\n\t    // ensure control has focus\r\n\t    self.inputState();\r\n\t    if (!self.isFocused) {\r\n\t      self.focus();\r\n\t    }\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Set the active and last-active classes\r\n\t   *\r\n\t   */\r\n\t  setActiveItemClass(item) {\r\n\t    const self = this;\r\n\t    const last_active = self.control.querySelector('.last-active');\r\n\t    if (last_active) removeClasses(last_active, 'last-active');\r\n\t    addClasses(item, 'active last-active');\r\n\t    self.trigger('item_select', item);\r\n\t    if (self.activeItems.indexOf(item) == -1) {\r\n\t      self.activeItems.push(item);\r\n\t    }\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Remove active item\r\n\t   *\r\n\t   */\r\n\t  removeActiveItem(item) {\r\n\t    var idx = this.activeItems.indexOf(item);\r\n\t    this.activeItems.splice(idx, 1);\r\n\t    removeClasses(item, 'active');\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Clears all the active items\r\n\t   *\r\n\t   */\r\n\t  clearActiveItems() {\r\n\t    removeClasses(this.activeItems, 'active');\r\n\t    this.activeItems = [];\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Sets the selected item in the dropdown menu\r\n\t   * of available options.\r\n\t   *\r\n\t   */\r\n\t  setActiveOption(option, scroll = true) {\r\n\t    if (option === this.activeOption) {\r\n\t      return;\r\n\t    }\r\n\t    this.clearActiveOption();\r\n\t    if (!option) return;\r\n\t    this.activeOption = option;\r\n\t    setAttr(this.focus_node, {\r\n\t      'aria-activedescendant': option.getAttribute('id')\r\n\t    });\r\n\t    setAttr(option, {\r\n\t      'aria-selected': 'true'\r\n\t    });\r\n\t    addClasses(option, 'active');\r\n\t    if (scroll) this.scrollToOption(option);\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Sets the dropdown_content scrollTop to display the option\r\n\t   *\r\n\t   */\r\n\t  scrollToOption(option, behavior) {\r\n\t    if (!option) return;\r\n\t    const content = this.dropdown_content;\r\n\t    const height_menu = content.clientHeight;\r\n\t    const scrollTop = content.scrollTop || 0;\r\n\t    const height_item = option.offsetHeight;\r\n\t    const y = option.getBoundingClientRect().top - content.getBoundingClientRect().top + scrollTop;\r\n\t    if (y + height_item > height_menu + scrollTop) {\r\n\t      this.scroll(y - height_menu + height_item, behavior);\r\n\t    } else if (y < scrollTop) {\r\n\t      this.scroll(y, behavior);\r\n\t    }\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Scroll the dropdown to the given position\r\n\t   *\r\n\t   */\r\n\t  scroll(scrollTop, behavior) {\r\n\t    const content = this.dropdown_content;\r\n\t    if (behavior) {\r\n\t      content.style.scrollBehavior = behavior;\r\n\t    }\r\n\t    content.scrollTop = scrollTop;\r\n\t    content.style.scrollBehavior = '';\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Clears the active option\r\n\t   *\r\n\t   */\r\n\t  clearActiveOption() {\r\n\t    if (this.activeOption) {\r\n\t      removeClasses(this.activeOption, 'active');\r\n\t      setAttr(this.activeOption, {\r\n\t        'aria-selected': null\r\n\t      });\r\n\t    }\r\n\t    this.activeOption = null;\r\n\t    setAttr(this.focus_node, {\r\n\t      'aria-activedescendant': null\r\n\t    });\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Selects all items (CTRL + A).\r\n\t   */\r\n\t  selectAll() {\r\n\t    const self = this;\r\n\t    if (self.settings.mode === 'single') return;\r\n\t    const activeItems = self.controlChildren();\r\n\t    if (!activeItems.length) return;\r\n\t    self.inputState();\r\n\t    self.close();\r\n\t    self.activeItems = activeItems;\r\n\t    iterate$1(activeItems, item => {\r\n\t      self.setActiveItemClass(item);\r\n\t    });\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Determines if the control_input should be in a hidden or visible state\r\n\t   *\r\n\t   */\r\n\t  inputState() {\r\n\t    var self = this;\r\n\t    if (!self.control.contains(self.control_input)) return;\r\n\t    setAttr(self.control_input, {\r\n\t      placeholder: self.settings.placeholder\r\n\t    });\r\n\t    if (self.activeItems.length > 0 || !self.isFocused && self.settings.hidePlaceholder && self.items.length > 0) {\r\n\t      self.setTextboxValue();\r\n\t      self.isInputHidden = true;\r\n\t    } else {\r\n\t      if (self.settings.hidePlaceholder && self.items.length > 0) {\r\n\t        setAttr(self.control_input, {\r\n\t          placeholder: ''\r\n\t        });\r\n\t      }\r\n\t      self.isInputHidden = false;\r\n\t    }\r\n\t    self.wrapper.classList.toggle('input-hidden', self.isInputHidden);\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Get the input value\r\n\t   */\r\n\t  inputValue() {\r\n\t    return this.control_input.value.trim();\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Gives the control focus.\r\n\t   */\r\n\t  focus() {\r\n\t    var self = this;\r\n\t    if (self.isDisabled || self.isReadOnly) return;\r\n\t    self.ignoreFocus = true;\r\n\t    if (self.control_input.offsetWidth) {\r\n\t      self.control_input.focus();\r\n\t    } else {\r\n\t      self.focus_node.focus();\r\n\t    }\r\n\t    setTimeout(() => {\r\n\t      self.ignoreFocus = false;\r\n\t      self.onFocus();\r\n\t    }, 0);\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Forces the control out of focus.\r\n\t   *\r\n\t   */\r\n\t  blur() {\r\n\t    this.focus_node.blur();\r\n\t    this.onBlur();\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Returns a function that scores an object\r\n\t   * to show how good of a match it is to the\r\n\t   * provided query.\r\n\t   *\r\n\t   * @return {function}\r\n\t   */\r\n\t  getScoreFunction(query) {\r\n\t    return this.sifter.getScoreFunction(query, this.getSearchOptions());\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Returns search options for sifter (the system\r\n\t   * for scoring and sorting results).\r\n\t   *\r\n\t   * @see https://github.com/orchidjs/sifter.js\r\n\t   * @return {object}\r\n\t   */\r\n\t  getSearchOptions() {\r\n\t    var settings = this.settings;\r\n\t    var sort = settings.sortField;\r\n\t    if (typeof settings.sortField === 'string') {\r\n\t      sort = [{\r\n\t        field: settings.sortField\r\n\t      }];\r\n\t    }\r\n\t    return {\r\n\t      fields: settings.searchField,\r\n\t      conjunction: settings.searchConjunction,\r\n\t      sort: sort,\r\n\t      nesting: settings.nesting\r\n\t    };\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Searches through available options and returns\r\n\t   * a sorted array of matches.\r\n\t   *\r\n\t   */\r\n\t  search(query) {\r\n\t    var result, calculateScore;\r\n\t    var self = this;\r\n\t    var options = this.getSearchOptions();\r\n\r\n\t    // validate user-provided result scoring function\r\n\t    if (self.settings.score) {\r\n\t      calculateScore = self.settings.score.call(self, query);\r\n\t      if (typeof calculateScore !== 'function') {\r\n\t        throw new Error('Tom Select \"score\" setting must be a function that returns a function');\r\n\t      }\r\n\t    }\r\n\r\n\t    // perform search\r\n\t    if (query !== self.lastQuery) {\r\n\t      self.lastQuery = query;\r\n\t      result = self.sifter.search(query, Object.assign(options, {\r\n\t        score: calculateScore\r\n\t      }));\r\n\t      self.currentResults = result;\r\n\t    } else {\r\n\t      result = Object.assign({}, self.currentResults);\r\n\t    }\r\n\r\n\t    // filter out selected items\r\n\t    if (self.settings.hideSelected) {\r\n\t      result.items = result.items.filter(item => {\r\n\t        let hashed = hash_key(item.id);\r\n\t        return !(hashed && self.items.indexOf(hashed) !== -1);\r\n\t      });\r\n\t    }\r\n\t    return result;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Refreshes the list of available options shown\r\n\t   * in the autocomplete dropdown menu.\r\n\t   *\r\n\t   */\r\n\t  refreshOptions(triggerDropdown = true) {\r\n\t    var i, j, k, n, optgroup, optgroups, html, has_create_option, active_group;\r\n\t    var create;\r\n\t    const groups = {};\r\n\t    const groups_order = [];\r\n\t    var self = this;\r\n\t    var query = self.inputValue();\r\n\t    const same_query = query === self.lastQuery || query == '' && self.lastQuery == null;\r\n\t    var results = self.search(query);\r\n\t    var active_option = null;\r\n\t    var show_dropdown = self.settings.shouldOpen || false;\r\n\t    var dropdown_content = self.dropdown_content;\r\n\t    if (same_query) {\r\n\t      active_option = self.activeOption;\r\n\t      if (active_option) {\r\n\t        active_group = active_option.closest('[data-group]');\r\n\t      }\r\n\t    }\r\n\r\n\t    // build markup\r\n\t    n = results.items.length;\r\n\t    if (typeof self.settings.maxOptions === 'number') {\r\n\t      n = Math.min(n, self.settings.maxOptions);\r\n\t    }\r\n\t    if (n > 0) {\r\n\t      show_dropdown = true;\r\n\t    }\r\n\r\n\t    // get fragment for group and the position of the group in group_order\r\n\t    const getGroupFragment = (optgroup, order) => {\r\n\t      let group_order_i = groups[optgroup];\r\n\t      if (group_order_i !== undefined) {\r\n\t        let order_group = groups_order[group_order_i];\r\n\t        if (order_group !== undefined) {\r\n\t          return [group_order_i, order_group.fragment];\r\n\t        }\r\n\t      }\r\n\t      let group_fragment = document.createDocumentFragment();\r\n\t      group_order_i = groups_order.length;\r\n\t      groups_order.push({\r\n\t        fragment: group_fragment,\r\n\t        order,\r\n\t        optgroup\r\n\t      });\r\n\t      return [group_order_i, group_fragment];\r\n\t    };\r\n\r\n\t    // render and group available options individually\r\n\t    for (i = 0; i < n; i++) {\r\n\t      // get option dom element\r\n\t      let item = results.items[i];\r\n\t      if (!item) continue;\r\n\t      let opt_value = item.id;\r\n\t      let option = self.options[opt_value];\r\n\t      if (option === undefined) continue;\r\n\t      let opt_hash = get_hash(opt_value);\r\n\t      let option_el = self.getOption(opt_hash, true);\r\n\r\n\t      // toggle 'selected' class\r\n\t      if (!self.settings.hideSelected) {\r\n\t        option_el.classList.toggle('selected', self.items.includes(opt_hash));\r\n\t      }\r\n\t      optgroup = option[self.settings.optgroupField] || '';\r\n\t      optgroups = Array.isArray(optgroup) ? optgroup : [optgroup];\r\n\t      for (j = 0, k = optgroups && optgroups.length; j < k; j++) {\r\n\t        optgroup = optgroups[j];\r\n\t        let order = option.$order;\r\n\t        let self_optgroup = self.optgroups[optgroup];\r\n\t        if (self_optgroup === undefined) {\r\n\t          optgroup = '';\r\n\t        } else {\r\n\t          order = self_optgroup.$order;\r\n\t        }\r\n\t        const [group_order_i, group_fragment] = getGroupFragment(optgroup, order);\r\n\r\n\t        // nodes can only have one parent, so if the option is in mutple groups, we need a clone\r\n\t        if (j > 0) {\r\n\t          option_el = option_el.cloneNode(true);\r\n\t          setAttr(option_el, {\r\n\t            id: option.$id + '-clone-' + j,\r\n\t            'aria-selected': null\r\n\t          });\r\n\t          option_el.classList.add('ts-cloned');\r\n\t          removeClasses(option_el, 'active');\r\n\r\n\t          // make sure we keep the activeOption in the same group\r\n\t          if (self.activeOption && self.activeOption.dataset.value == opt_value) {\r\n\t            if (active_group && active_group.dataset.group === optgroup.toString()) {\r\n\t              active_option = option_el;\r\n\t            }\r\n\t          }\r\n\t        }\r\n\t        group_fragment.appendChild(option_el);\r\n\t        if (optgroup != '') {\r\n\t          groups[optgroup] = group_order_i;\r\n\t        }\r\n\t      }\r\n\t    }\r\n\r\n\t    // sort optgroups\r\n\t    if (self.settings.lockOptgroupOrder) {\r\n\t      groups_order.sort((a, b) => {\r\n\t        return a.order - b.order;\r\n\t      });\r\n\t    }\r\n\r\n\t    // render optgroup headers & join groups\r\n\t    html = document.createDocumentFragment();\r\n\t    iterate$1(groups_order, group_order => {\r\n\t      let group_fragment = group_order.fragment;\r\n\t      let optgroup = group_order.optgroup;\r\n\t      if (!group_fragment || !group_fragment.children.length) return;\r\n\t      let group_heading = self.optgroups[optgroup];\r\n\t      if (group_heading !== undefined) {\r\n\t        let group_options = document.createDocumentFragment();\r\n\t        let header = self.render('optgroup_header', group_heading);\r\n\t        append(group_options, header);\r\n\t        append(group_options, group_fragment);\r\n\t        let group_html = self.render('optgroup', {\r\n\t          group: group_heading,\r\n\t          options: group_options\r\n\t        });\r\n\t        append(html, group_html);\r\n\t      } else {\r\n\t        append(html, group_fragment);\r\n\t      }\r\n\t    });\r\n\t    dropdown_content.innerHTML = '';\r\n\t    append(dropdown_content, html);\r\n\r\n\t    // highlight matching terms inline\r\n\t    if (self.settings.highlight) {\r\n\t      removeHighlight(dropdown_content);\r\n\t      if (results.query.length && results.tokens.length) {\r\n\t        iterate$1(results.tokens, tok => {\r\n\t          highlight(dropdown_content, tok.regex);\r\n\t        });\r\n\t      }\r\n\t    }\r\n\r\n\t    // helper method for adding templates to dropdown\r\n\t    var add_template = template => {\r\n\t      let content = self.render(template, {\r\n\t        input: query\r\n\t      });\r\n\t      if (content) {\r\n\t        show_dropdown = true;\r\n\t        dropdown_content.insertBefore(content, dropdown_content.firstChild);\r\n\t      }\r\n\t      return content;\r\n\t    };\r\n\r\n\t    // add loading message\r\n\t    if (self.loading) {\r\n\t      add_template('loading');\r\n\r\n\t      // invalid query\r\n\t    } else if (!self.settings.shouldLoad.call(self, query)) {\r\n\t      add_template('not_loading');\r\n\r\n\t      // add no_results message\r\n\t    } else if (results.items.length === 0) {\r\n\t      add_template('no_results');\r\n\t    }\r\n\r\n\t    // add create option\r\n\t    has_create_option = self.canCreate(query);\r\n\t    if (has_create_option) {\r\n\t      create = add_template('option_create');\r\n\t    }\r\n\r\n\t    // activate\r\n\t    self.hasOptions = results.items.length > 0 || has_create_option;\r\n\t    if (show_dropdown) {\r\n\t      if (results.items.length > 0) {\r\n\t        if (!active_option && self.settings.mode === 'single' && self.items[0] != undefined) {\r\n\t          active_option = self.getOption(self.items[0]);\r\n\t        }\r\n\t        if (!dropdown_content.contains(active_option)) {\r\n\t          let active_index = 0;\r\n\t          if (create && !self.settings.addPrecedence) {\r\n\t            active_index = 1;\r\n\t          }\r\n\t          active_option = self.selectable()[active_index];\r\n\t        }\r\n\t      } else if (create) {\r\n\t        active_option = create;\r\n\t      }\r\n\t      if (triggerDropdown && !self.isOpen) {\r\n\t        self.open();\r\n\t        self.scrollToOption(active_option, 'auto');\r\n\t      }\r\n\t      self.setActiveOption(active_option);\r\n\t    } else {\r\n\t      self.clearActiveOption();\r\n\t      if (triggerDropdown && self.isOpen) {\r\n\t        self.close(false); // if create_option=null, we want the dropdown to close but not reset the textbox value\r\n\t      }\r\n\t    }\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Return list of selectable options\r\n\t   *\r\n\t   */\r\n\t  selectable() {\r\n\t    return this.dropdown_content.querySelectorAll('[data-selectable]');\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Adds an available option. If it already exists,\r\n\t   * nothing will happen. Note: this does not refresh\r\n\t   * the options list dropdown (use `refreshOptions`\r\n\t   * for that).\r\n\t   *\r\n\t   * Usage:\r\n\t   *\r\n\t   *   this.addOption(data)\r\n\t   *\r\n\t   */\r\n\t  addOption(data, user_created = false) {\r\n\t    const self = this;\r\n\r\n\t    // @deprecated 1.7.7\r\n\t    // use addOptions( array, user_created ) for adding multiple options\r\n\t    if (Array.isArray(data)) {\r\n\t      self.addOptions(data, user_created);\r\n\t      return false;\r\n\t    }\r\n\t    const key = hash_key(data[self.settings.valueField]);\r\n\t    if (key === null || self.options.hasOwnProperty(key)) {\r\n\t      return false;\r\n\t    }\r\n\t    data.$order = data.$order || ++self.order;\r\n\t    data.$id = self.inputId + '-opt-' + data.$order;\r\n\t    self.options[key] = data;\r\n\t    self.lastQuery = null;\r\n\t    if (user_created) {\r\n\t      self.userOptions[key] = user_created;\r\n\t      self.trigger('option_add', key, data);\r\n\t    }\r\n\t    return key;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Add multiple options\r\n\t   *\r\n\t   */\r\n\t  addOptions(data, user_created = false) {\r\n\t    iterate$1(data, dat => {\r\n\t      this.addOption(dat, user_created);\r\n\t    });\r\n\t  }\r\n\r\n\t  /**\r\n\t   * @deprecated 1.7.7\r\n\t   */\r\n\t  registerOption(data) {\r\n\t    return this.addOption(data);\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Registers an option group to the pool of option groups.\r\n\t   *\r\n\t   * @return {boolean|string}\r\n\t   */\r\n\t  registerOptionGroup(data) {\r\n\t    var key = hash_key(data[this.settings.optgroupValueField]);\r\n\t    if (key === null) return false;\r\n\t    data.$order = data.$order || ++this.order;\r\n\t    this.optgroups[key] = data;\r\n\t    return key;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Registers a new optgroup for options\r\n\t   * to be bucketed into.\r\n\t   *\r\n\t   */\r\n\t  addOptionGroup(id, data) {\r\n\t    var hashed_id;\r\n\t    data[this.settings.optgroupValueField] = id;\r\n\t    if (hashed_id = this.registerOptionGroup(data)) {\r\n\t      this.trigger('optgroup_add', hashed_id, data);\r\n\t    }\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Removes an existing option group.\r\n\t   *\r\n\t   */\r\n\t  removeOptionGroup(id) {\r\n\t    if (this.optgroups.hasOwnProperty(id)) {\r\n\t      delete this.optgroups[id];\r\n\t      this.clearCache();\r\n\t      this.trigger('optgroup_remove', id);\r\n\t    }\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Clears all existing option groups.\r\n\t   */\r\n\t  clearOptionGroups() {\r\n\t    this.optgroups = {};\r\n\t    this.clearCache();\r\n\t    this.trigger('optgroup_clear');\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Updates an option available for selection. If\r\n\t   * it is visible in the selected items or options\r\n\t   * dropdown, it will be re-rendered automatically.\r\n\t   *\r\n\t   */\r\n\t  updateOption(value, data) {\r\n\t    const self = this;\r\n\t    var item_new;\r\n\t    var index_item;\r\n\t    const value_old = hash_key(value);\r\n\t    const value_new = hash_key(data[self.settings.valueField]);\r\n\r\n\t    // sanity checks\r\n\t    if (value_old === null) return;\r\n\t    const data_old = self.options[value_old];\r\n\t    if (data_old == undefined) return;\r\n\t    if (typeof value_new !== 'string') throw new Error('Value must be set in option data');\r\n\t    const option = self.getOption(value_old);\r\n\t    const item = self.getItem(value_old);\r\n\t    data.$order = data.$order || data_old.$order;\r\n\t    delete self.options[value_old];\r\n\r\n\t    // invalidate render cache\r\n\t    // don't remove existing node yet, we'll remove it after replacing it\r\n\t    self.uncacheValue(value_new);\r\n\t    self.options[value_new] = data;\r\n\r\n\t    // update the option if it's in the dropdown\r\n\t    if (option) {\r\n\t      if (self.dropdown_content.contains(option)) {\r\n\t        const option_new = self._render('option', data);\r\n\t        replaceNode(option, option_new);\r\n\t        if (self.activeOption === option) {\r\n\t          self.setActiveOption(option_new);\r\n\t        }\r\n\t      }\r\n\t      option.remove();\r\n\t    }\r\n\r\n\t    // update the item if we have one\r\n\t    if (item) {\r\n\t      index_item = self.items.indexOf(value_old);\r\n\t      if (index_item !== -1) {\r\n\t        self.items.splice(index_item, 1, value_new);\r\n\t      }\r\n\t      item_new = self._render('item', data);\r\n\t      if (item.classList.contains('active')) addClasses(item_new, 'active');\r\n\t      replaceNode(item, item_new);\r\n\t    }\r\n\r\n\t    // invalidate last query because we might have updated the sortField\r\n\t    self.lastQuery = null;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Removes a single option.\r\n\t   *\r\n\t   */\r\n\t  removeOption(value, silent) {\r\n\t    const self = this;\r\n\t    value = get_hash(value);\r\n\t    self.uncacheValue(value);\r\n\t    delete self.userOptions[value];\r\n\t    delete self.options[value];\r\n\t    self.lastQuery = null;\r\n\t    self.trigger('option_remove', value);\r\n\t    self.removeItem(value, silent);\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Clears all options.\r\n\t   */\r\n\t  clearOptions(filter) {\r\n\t    const boundFilter = (filter || this.clearFilter).bind(this);\r\n\t    this.loadedSearches = {};\r\n\t    this.userOptions = {};\r\n\t    this.clearCache();\r\n\t    const selected = {};\r\n\t    iterate$1(this.options, (option, key) => {\r\n\t      if (boundFilter(option, key)) {\r\n\t        selected[key] = option;\r\n\t      }\r\n\t    });\r\n\t    this.options = this.sifter.items = selected;\r\n\t    this.lastQuery = null;\r\n\t    this.trigger('option_clear');\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Used by clearOptions() to decide whether or not an option should be removed\r\n\t   * Return true to keep an option, false to remove\r\n\t   *\r\n\t   */\r\n\t  clearFilter(option, value) {\r\n\t    if (this.items.indexOf(value) >= 0) {\r\n\t      return true;\r\n\t    }\r\n\t    return false;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Returns the dom element of the option\r\n\t   * matching the given value.\r\n\t   *\r\n\t   */\r\n\t  getOption(value, create = false) {\r\n\t    const hashed = hash_key(value);\r\n\t    if (hashed === null) return null;\r\n\t    const option = this.options[hashed];\r\n\t    if (option != undefined) {\r\n\t      if (option.$div) {\r\n\t        return option.$div;\r\n\t      }\r\n\t      if (create) {\r\n\t        return this._render('option', option);\r\n\t      }\r\n\t    }\r\n\t    return null;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Returns the dom element of the next or previous dom element of the same type\r\n\t   * Note: adjacent options may not be adjacent DOM elements (optgroups)\r\n\t   *\r\n\t   */\r\n\t  getAdjacent(option, direction, type = 'option') {\r\n\t    var self = this,\r\n\t      all;\r\n\t    if (!option) {\r\n\t      return null;\r\n\t    }\r\n\t    if (type == 'item') {\r\n\t      all = self.controlChildren();\r\n\t    } else {\r\n\t      all = self.dropdown_content.querySelectorAll('[data-selectable]');\r\n\t    }\r\n\t    for (let i = 0; i < all.length; i++) {\r\n\t      if (all[i] != option) {\r\n\t        continue;\r\n\t      }\r\n\t      if (direction > 0) {\r\n\t        return all[i + 1];\r\n\t      }\r\n\t      return all[i - 1];\r\n\t    }\r\n\t    return null;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Returns the dom element of the item\r\n\t   * matching the given value.\r\n\t   *\r\n\t   */\r\n\t  getItem(item) {\r\n\t    if (typeof item == 'object') {\r\n\t      return item;\r\n\t    }\r\n\t    var value = hash_key(item);\r\n\t    return value !== null ? this.control.querySelector(`[data-value=\"${addSlashes(value)}\"]`) : null;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * \"Selects\" multiple items at once. Adds them to the list\r\n\t   * at the current caret position.\r\n\t   *\r\n\t   */\r\n\t  addItems(values, silent) {\r\n\t    var self = this;\r\n\t    var items = Array.isArray(values) ? values : [values];\r\n\t    items = items.filter(x => self.items.indexOf(x) === -1);\r\n\t    const last_item = items[items.length - 1];\r\n\t    items.forEach(item => {\r\n\t      self.isPending = item !== last_item;\r\n\t      self.addItem(item, silent);\r\n\t    });\r\n\t  }\r\n\r\n\t  /**\r\n\t   * \"Selects\" an item. Adds it to the list\r\n\t   * at the current caret position.\r\n\t   *\r\n\t   */\r\n\t  addItem(value, silent) {\r\n\t    var events = silent ? [] : ['change', 'dropdown_close'];\r\n\t    debounce_events(this, events, () => {\r\n\t      var item, wasFull;\r\n\t      const self = this;\r\n\t      const inputMode = self.settings.mode;\r\n\t      const hashed = hash_key(value);\r\n\t      if (hashed && self.items.indexOf(hashed) !== -1) {\r\n\t        if (inputMode === 'single') {\r\n\t          self.close();\r\n\t        }\r\n\t        if (inputMode === 'single' || !self.settings.duplicates) {\r\n\t          return;\r\n\t        }\r\n\t      }\r\n\t      if (hashed === null || !self.options.hasOwnProperty(hashed)) return;\r\n\t      if (inputMode === 'single') self.clear(silent);\r\n\t      if (inputMode === 'multi' && self.isFull()) return;\r\n\t      item = self._render('item', self.options[hashed]);\r\n\t      if (self.control.contains(item)) {\r\n\t        // duplicates\r\n\t        item = item.cloneNode(true);\r\n\t      }\r\n\t      wasFull = self.isFull();\r\n\t      self.items.splice(self.caretPos, 0, hashed);\r\n\t      self.insertAtCaret(item);\r\n\t      if (self.isSetup) {\r\n\t        // update menu / remove the option (if this is not one item being added as part of series)\r\n\t        if (!self.isPending && self.settings.hideSelected) {\r\n\t          let option = self.getOption(hashed);\r\n\t          let next = self.getAdjacent(option, 1);\r\n\t          if (next) {\r\n\t            self.setActiveOption(next);\r\n\t          }\r\n\t        }\r\n\r\n\t        // refreshOptions after setActiveOption(),\r\n\t        // otherwise setActiveOption() will be called by refreshOptions() with the wrong value\r\n\t        if (!self.isPending && !self.settings.closeAfterSelect) {\r\n\t          self.refreshOptions(self.isFocused && inputMode !== 'single');\r\n\t        }\r\n\r\n\t        // hide the menu if the maximum number of items have been selected or no options are left\r\n\t        if (self.settings.closeAfterSelect != false && self.isFull()) {\r\n\t          self.close();\r\n\t        } else if (!self.isPending) {\r\n\t          self.positionDropdown();\r\n\t        }\r\n\t        self.trigger('item_add', hashed, item);\r\n\t        if (!self.isPending) {\r\n\t          self.updateOriginalInput({\r\n\t            silent: silent\r\n\t          });\r\n\t        }\r\n\t      }\r\n\t      if (!self.isPending || !wasFull && self.isFull()) {\r\n\t        self.inputState();\r\n\t        self.refreshState();\r\n\t      }\r\n\t    });\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Removes the selected item matching\r\n\t   * the provided value.\r\n\t   *\r\n\t   */\r\n\t  removeItem(item = null, silent) {\r\n\t    const self = this;\r\n\t    item = self.getItem(item);\r\n\t    if (!item) return;\r\n\t    var i, idx;\r\n\t    const value = item.dataset.value;\r\n\t    i = nodeIndex(item);\r\n\t    item.remove();\r\n\t    if (item.classList.contains('active')) {\r\n\t      idx = self.activeItems.indexOf(item);\r\n\t      self.activeItems.splice(idx, 1);\r\n\t      removeClasses(item, 'active');\r\n\t    }\r\n\t    self.items.splice(i, 1);\r\n\t    self.lastQuery = null;\r\n\t    if (!self.settings.persist && self.userOptions.hasOwnProperty(value)) {\r\n\t      self.removeOption(value, silent);\r\n\t    }\r\n\t    if (i < self.caretPos) {\r\n\t      self.setCaret(self.caretPos - 1);\r\n\t    }\r\n\t    self.updateOriginalInput({\r\n\t      silent: silent\r\n\t    });\r\n\t    self.refreshState();\r\n\t    self.positionDropdown();\r\n\t    self.trigger('item_remove', value, item);\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Invokes the `create` method provided in the\r\n\t   * TomSelect options that should provide the data\r\n\t   * for the new item, given the user input.\r\n\t   *\r\n\t   * Once this completes, it will be added\r\n\t   * to the item list.\r\n\t   *\r\n\t   */\r\n\t  createItem(input = null, callback = () => {}) {\r\n\t    // triggerDropdown parameter @deprecated 2.1.1\r\n\t    if (arguments.length === 3) {\r\n\t      callback = arguments[2];\r\n\t    }\r\n\t    if (typeof callback != 'function') {\r\n\t      callback = () => {};\r\n\t    }\r\n\t    var self = this;\r\n\t    var caret = self.caretPos;\r\n\t    var output;\r\n\t    input = input || self.inputValue();\r\n\t    if (!self.canCreate(input)) {\r\n\t      callback();\r\n\t      return false;\r\n\t    }\r\n\t    self.lock();\r\n\t    var created = false;\r\n\t    var create = data => {\r\n\t      self.unlock();\r\n\t      if (!data || typeof data !== 'object') return callback();\r\n\t      var value = hash_key(data[self.settings.valueField]);\r\n\t      if (typeof value !== 'string') {\r\n\t        return callback();\r\n\t      }\r\n\t      self.setTextboxValue();\r\n\t      self.addOption(data, true);\r\n\t      self.setCaret(caret);\r\n\t      self.addItem(value);\r\n\t      callback(data);\r\n\t      created = true;\r\n\t    };\r\n\t    if (typeof self.settings.create === 'function') {\r\n\t      output = self.settings.create.call(this, input, create);\r\n\t    } else {\r\n\t      output = {\r\n\t        [self.settings.labelField]: input,\r\n\t        [self.settings.valueField]: input\r\n\t      };\r\n\t    }\r\n\t    if (!created) {\r\n\t      create(output);\r\n\t    }\r\n\t    return true;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Re-renders the selected item lists.\r\n\t   */\r\n\t  refreshItems() {\r\n\t    var self = this;\r\n\t    self.lastQuery = null;\r\n\t    if (self.isSetup) {\r\n\t      self.addItems(self.items);\r\n\t    }\r\n\t    self.updateOriginalInput();\r\n\t    self.refreshState();\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Updates all state-dependent attributes\r\n\t   * and CSS classes.\r\n\t   */\r\n\t  refreshState() {\r\n\t    const self = this;\r\n\t    self.refreshValidityState();\r\n\t    const isFull = self.isFull();\r\n\t    const isLocked = self.isLocked;\r\n\t    self.wrapper.classList.toggle('rtl', self.rtl);\r\n\t    const wrap_classList = self.wrapper.classList;\r\n\t    wrap_classList.toggle('focus', self.isFocused);\r\n\t    wrap_classList.toggle('disabled', self.isDisabled);\r\n\t    wrap_classList.toggle('readonly', self.isReadOnly);\r\n\t    wrap_classList.toggle('required', self.isRequired);\r\n\t    wrap_classList.toggle('invalid', !self.isValid);\r\n\t    wrap_classList.toggle('locked', isLocked);\r\n\t    wrap_classList.toggle('full', isFull);\r\n\t    wrap_classList.toggle('input-active', self.isFocused && !self.isInputHidden);\r\n\t    wrap_classList.toggle('dropdown-active', self.isOpen);\r\n\t    wrap_classList.toggle('has-options', isEmptyObject(self.options));\r\n\t    wrap_classList.toggle('has-items', self.items.length > 0);\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Update the `required` attribute of both input and control input.\r\n\t   *\r\n\t   * The `required` property needs to be activated on the control input\r\n\t   * for the error to be displayed at the right place. `required` also\r\n\t   * needs to be temporarily deactivated on the input since the input is\r\n\t   * hidden and can't show errors.\r\n\t   */\r\n\t  refreshValidityState() {\r\n\t    var self = this;\r\n\t    if (!self.input.validity) {\r\n\t      return;\r\n\t    }\r\n\t    self.isValid = self.input.validity.valid;\r\n\t    self.isInvalid = !self.isValid;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Determines whether or not more items can be added\r\n\t   * to the control without exceeding the user-defined maximum.\r\n\t   *\r\n\t   * @returns {boolean}\r\n\t   */\r\n\t  isFull() {\r\n\t    return this.settings.maxItems !== null && this.items.length >= this.settings.maxItems;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Refreshes the original <select> or <input>\r\n\t   * element to reflect the current state.\r\n\t   *\r\n\t   */\r\n\t  updateOriginalInput(opts = {}) {\r\n\t    const self = this;\r\n\t    var option, label;\r\n\t    const empty_option = self.input.querySelector('option[value=\"\"]');\r\n\t    if (self.is_select_tag) {\r\n\t      const selected = [];\r\n\t      const has_selected = self.input.querySelectorAll('option:checked').length;\r\n\t      function AddSelected(option_el, value, label) {\r\n\t        if (!option_el) {\r\n\t          option_el = getDom('<option value=\"' + escape_html(value) + '\">' + escape_html(label) + '</option>');\r\n\t        }\r\n\r\n\t        // don't move empty option from top of list\r\n\t        // fixes bug in firefox https://bugzilla.mozilla.org/show_bug.cgi?id=1725293\r\n\t        if (option_el != empty_option) {\r\n\t          self.input.append(option_el);\r\n\t        }\r\n\t        selected.push(option_el);\r\n\r\n\t        // marking empty option as selected can break validation\r\n\t        // fixes https://github.com/orchidjs/tom-select/issues/303\r\n\t        if (option_el != empty_option || has_selected > 0) {\r\n\t          option_el.selected = true;\r\n\t        }\r\n\t        return option_el;\r\n\t      }\r\n\r\n\t      // unselect all selected options\r\n\t      self.input.querySelectorAll('option:checked').forEach(option_el => {\r\n\t        option_el.selected = false;\r\n\t      });\r\n\r\n\t      // nothing selected?\r\n\t      if (self.items.length == 0 && self.settings.mode == 'single') {\r\n\t        AddSelected(empty_option, \"\", \"\");\r\n\r\n\t        // order selected <option> tags for values in self.items\r\n\t      } else {\r\n\t        self.items.forEach(value => {\r\n\t          option = self.options[value];\r\n\t          label = option[self.settings.labelField] || '';\r\n\t          if (selected.includes(option.$option)) {\r\n\t            const reuse_opt = self.input.querySelector(`option[value=\"${addSlashes(value)}\"]:not(:checked)`);\r\n\t            AddSelected(reuse_opt, value, label);\r\n\t          } else {\r\n\t            option.$option = AddSelected(option.$option, value, label);\r\n\t          }\r\n\t        });\r\n\t      }\r\n\t    } else {\r\n\t      self.input.value = self.getValue();\r\n\t    }\r\n\t    if (self.isSetup) {\r\n\t      if (!opts.silent) {\r\n\t        self.trigger('change', self.getValue());\r\n\t      }\r\n\t    }\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Shows the autocomplete dropdown containing\r\n\t   * the available options.\r\n\t   */\r\n\t  open() {\r\n\t    var self = this;\r\n\t    if (self.isLocked || self.isOpen || self.settings.mode === 'multi' && self.isFull()) return;\r\n\t    self.isOpen = true;\r\n\t    setAttr(self.focus_node, {\r\n\t      'aria-expanded': 'true'\r\n\t    });\r\n\t    self.refreshState();\r\n\t    applyCSS(self.dropdown, {\r\n\t      visibility: 'hidden',\r\n\t      display: 'block'\r\n\t    });\r\n\t    self.positionDropdown();\r\n\t    applyCSS(self.dropdown, {\r\n\t      visibility: 'visible',\r\n\t      display: 'block'\r\n\t    });\r\n\t    self.focus();\r\n\t    self.trigger('dropdown_open', self.dropdown);\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Closes the autocomplete dropdown menu.\r\n\t   */\r\n\t  close(setTextboxValue = true) {\r\n\t    var self = this;\r\n\t    var trigger = self.isOpen;\r\n\t    if (setTextboxValue) {\r\n\t      // before blur() to prevent form onchange event\r\n\t      self.setTextboxValue();\r\n\t      if (self.settings.mode === 'single' && self.items.length) {\r\n\t        self.inputState();\r\n\t      }\r\n\t    }\r\n\t    self.isOpen = false;\r\n\t    setAttr(self.focus_node, {\r\n\t      'aria-expanded': 'false'\r\n\t    });\r\n\t    applyCSS(self.dropdown, {\r\n\t      display: 'none'\r\n\t    });\r\n\t    if (self.settings.hideSelected) {\r\n\t      self.clearActiveOption();\r\n\t    }\r\n\t    self.refreshState();\r\n\t    if (trigger) self.trigger('dropdown_close', self.dropdown);\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Calculates and applies the appropriate\r\n\t   * position of the dropdown if dropdownParent = 'body'.\r\n\t   * Otherwise, position is determined by css\r\n\t   */\r\n\t  positionDropdown() {\r\n\t    if (this.settings.dropdownParent !== 'body') {\r\n\t      return;\r\n\t    }\r\n\t    var context = this.control;\r\n\t    var rect = context.getBoundingClientRect();\r\n\t    var top = context.offsetHeight + rect.top + window.scrollY;\r\n\t    var left = rect.left + window.scrollX;\r\n\t    applyCSS(this.dropdown, {\r\n\t      width: rect.width + 'px',\r\n\t      top: top + 'px',\r\n\t      left: left + 'px'\r\n\t    });\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Resets / clears all selected items\r\n\t   * from the control.\r\n\t   *\r\n\t   */\r\n\t  clear(silent) {\r\n\t    var self = this;\r\n\t    if (!self.items.length) return;\r\n\t    var items = self.controlChildren();\r\n\t    iterate$1(items, item => {\r\n\t      self.removeItem(item, true);\r\n\t    });\r\n\t    self.inputState();\r\n\t    if (!silent) self.updateOriginalInput();\r\n\t    self.trigger('clear');\r\n\t  }\r\n\r\n\t  /**\r\n\t   * A helper method for inserting an element\r\n\t   * at the current caret position.\r\n\t   *\r\n\t   */\r\n\t  insertAtCaret(el) {\r\n\t    const self = this;\r\n\t    const caret = self.caretPos;\r\n\t    const target = self.control;\r\n\t    target.insertBefore(el, target.children[caret] || null);\r\n\t    self.setCaret(caret + 1);\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Removes the current selected item(s).\r\n\t   *\r\n\t   */\r\n\t  deleteSelection(e) {\r\n\t    var direction, selection, caret, tail;\r\n\t    var self = this;\r\n\t    direction = e && e.keyCode === KEY_BACKSPACE ? -1 : 1;\r\n\t    selection = getSelection(self.control_input);\r\n\r\n\t    // determine items that will be removed\r\n\t    const rm_items = [];\r\n\t    if (self.activeItems.length) {\r\n\t      tail = getTail(self.activeItems, direction);\r\n\t      caret = nodeIndex(tail);\r\n\t      if (direction > 0) {\r\n\t        caret++;\r\n\t      }\r\n\t      iterate$1(self.activeItems, item => rm_items.push(item));\r\n\t    } else if ((self.isFocused || self.settings.mode === 'single') && self.items.length) {\r\n\t      const items = self.controlChildren();\r\n\t      let rm_item;\r\n\t      if (direction < 0 && selection.start === 0 && selection.length === 0) {\r\n\t        rm_item = items[self.caretPos - 1];\r\n\t      } else if (direction > 0 && selection.start === self.inputValue().length) {\r\n\t        rm_item = items[self.caretPos];\r\n\t      }\r\n\t      if (rm_item !== undefined) {\r\n\t        rm_items.push(rm_item);\r\n\t      }\r\n\t    }\r\n\t    if (!self.shouldDelete(rm_items, e)) {\r\n\t      return false;\r\n\t    }\r\n\t    preventDefault(e, true);\r\n\r\n\t    // perform removal\r\n\t    if (typeof caret !== 'undefined') {\r\n\t      self.setCaret(caret);\r\n\t    }\r\n\t    while (rm_items.length) {\r\n\t      self.removeItem(rm_items.pop());\r\n\t    }\r\n\t    self.inputState();\r\n\t    self.positionDropdown();\r\n\t    self.refreshOptions(false);\r\n\t    return true;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Return true if the items should be deleted\r\n\t   */\r\n\t  shouldDelete(items, evt) {\r\n\t    const values = items.map(item => item.dataset.value);\r\n\r\n\t    // allow the callback to abort\r\n\t    if (!values.length || typeof this.settings.onDelete === 'function' && this.settings.onDelete(values, evt) === false) {\r\n\t      return false;\r\n\t    }\r\n\t    return true;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Selects the previous / next item (depending on the `direction` argument).\r\n\t   *\r\n\t   * > 0 - right\r\n\t   * < 0 - left\r\n\t   *\r\n\t   */\r\n\t  advanceSelection(direction, e) {\r\n\t    var last_active,\r\n\t      adjacent,\r\n\t      self = this;\r\n\t    if (self.rtl) direction *= -1;\r\n\t    if (self.inputValue().length) return;\r\n\r\n\t    // add or remove to active items\r\n\t    if (isKeyDown(KEY_SHORTCUT, e) || isKeyDown('shiftKey', e)) {\r\n\t      last_active = self.getLastActive(direction);\r\n\t      if (last_active) {\r\n\t        if (!last_active.classList.contains('active')) {\r\n\t          adjacent = last_active;\r\n\t        } else {\r\n\t          adjacent = self.getAdjacent(last_active, direction, 'item');\r\n\t        }\r\n\r\n\t        // if no active item, get items adjacent to the control input\r\n\t      } else if (direction > 0) {\r\n\t        adjacent = self.control_input.nextElementSibling;\r\n\t      } else {\r\n\t        adjacent = self.control_input.previousElementSibling;\r\n\t      }\r\n\t      if (adjacent) {\r\n\t        if (adjacent.classList.contains('active')) {\r\n\t          self.removeActiveItem(last_active);\r\n\t        }\r\n\t        self.setActiveItemClass(adjacent); // mark as last_active !! after removeActiveItem() on last_active\r\n\t      }\r\n\r\n\t      // move caret to the left or right\r\n\t    } else {\r\n\t      self.moveCaret(direction);\r\n\t    }\r\n\t  }\r\n\t  moveCaret(direction) {}\r\n\r\n\t  /**\r\n\t   * Get the last active item\r\n\t   *\r\n\t   */\r\n\t  getLastActive(direction) {\r\n\t    let last_active = this.control.querySelector('.last-active');\r\n\t    if (last_active) {\r\n\t      return last_active;\r\n\t    }\r\n\t    var result = this.control.querySelectorAll('.active');\r\n\t    if (result) {\r\n\t      return getTail(result, direction);\r\n\t    }\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Moves the caret to the specified index.\r\n\t   *\r\n\t   * The input must be moved by leaving it in place and moving the\r\n\t   * siblings, due to the fact that focus cannot be restored once lost\r\n\t   * on mobile webkit devices\r\n\t   *\r\n\t   */\r\n\t  setCaret(new_pos) {\r\n\t    this.caretPos = this.items.length;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Return list of item dom elements\r\n\t   *\r\n\t   */\r\n\t  controlChildren() {\r\n\t    return Array.from(this.control.querySelectorAll('[data-ts-item]'));\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Disables user input on the control. Used while\r\n\t   * items are being asynchronously created.\r\n\t   */\r\n\t  lock() {\r\n\t    this.setLocked(true);\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Re-enables user input on the control.\r\n\t   */\r\n\t  unlock() {\r\n\t    this.setLocked(false);\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Disable or enable user input on the control\r\n\t   */\r\n\t  setLocked(lock = this.isReadOnly || this.isDisabled) {\r\n\t    this.isLocked = lock;\r\n\t    this.refreshState();\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Disables user input on the control completely.\r\n\t   * While disabled, it cannot receive focus.\r\n\t   */\r\n\t  disable() {\r\n\t    this.setDisabled(true);\r\n\t    this.close();\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Enables the control so that it can respond\r\n\t   * to focus and user input.\r\n\t   */\r\n\t  enable() {\r\n\t    this.setDisabled(false);\r\n\t  }\r\n\t  setDisabled(disabled) {\r\n\t    this.focus_node.tabIndex = disabled ? -1 : this.tabIndex;\r\n\t    this.isDisabled = disabled;\r\n\t    this.input.disabled = disabled;\r\n\t    this.control_input.disabled = disabled;\r\n\t    this.setLocked();\r\n\t  }\r\n\t  setReadOnly(isReadOnly) {\r\n\t    this.isReadOnly = isReadOnly;\r\n\t    this.input.readOnly = isReadOnly;\r\n\t    this.control_input.readOnly = isReadOnly;\r\n\t    this.setLocked();\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Completely destroys the control and\r\n\t   * unbinds all event listeners so that it can\r\n\t   * be garbage collected.\r\n\t   */\r\n\t  destroy() {\r\n\t    var self = this;\r\n\t    var revertSettings = self.revertSettings;\r\n\t    self.trigger('destroy');\r\n\t    self.off();\r\n\t    self.wrapper.remove();\r\n\t    self.dropdown.remove();\r\n\t    self.input.innerHTML = revertSettings.innerHTML;\r\n\t    self.input.tabIndex = revertSettings.tabIndex;\r\n\t    removeClasses(self.input, 'tomselected', 'ts-hidden-accessible');\r\n\t    self._destroy();\r\n\t    delete self.input.tomselect;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * A helper method for rendering \"item\" and\r\n\t   * \"option\" templates, given the data.\r\n\t   *\r\n\t   */\r\n\t  render(templateName, data) {\r\n\t    var id, html;\r\n\t    const self = this;\r\n\t    if (typeof this.settings.render[templateName] !== 'function') {\r\n\t      return null;\r\n\t    }\r\n\r\n\t    // render markup\r\n\t    html = self.settings.render[templateName].call(this, data, escape_html);\r\n\t    if (!html) {\r\n\t      return null;\r\n\t    }\r\n\t    html = getDom(html);\r\n\r\n\t    // add mandatory attributes\r\n\t    if (templateName === 'option' || templateName === 'option_create') {\r\n\t      if (data[self.settings.disabledField]) {\r\n\t        setAttr(html, {\r\n\t          'aria-disabled': 'true'\r\n\t        });\r\n\t      } else {\r\n\t        setAttr(html, {\r\n\t          'data-selectable': ''\r\n\t        });\r\n\t      }\r\n\t    } else if (templateName === 'optgroup') {\r\n\t      id = data.group[self.settings.optgroupValueField];\r\n\t      setAttr(html, {\r\n\t        'data-group': id\r\n\t      });\r\n\t      if (data.group[self.settings.disabledField]) {\r\n\t        setAttr(html, {\r\n\t          'data-disabled': ''\r\n\t        });\r\n\t      }\r\n\t    }\r\n\t    if (templateName === 'option' || templateName === 'item') {\r\n\t      const value = get_hash(data[self.settings.valueField]);\r\n\t      setAttr(html, {\r\n\t        'data-value': value\r\n\t      });\r\n\r\n\t      // make sure we have some classes if a template is overwritten\r\n\t      if (templateName === 'item') {\r\n\t        addClasses(html, self.settings.itemClass);\r\n\t        setAttr(html, {\r\n\t          'data-ts-item': ''\r\n\t        });\r\n\t      } else {\r\n\t        addClasses(html, self.settings.optionClass);\r\n\t        setAttr(html, {\r\n\t          role: 'option',\r\n\t          id: data.$id\r\n\t        });\r\n\r\n\t        // update cache\r\n\t        data.$div = html;\r\n\t        self.options[value] = data;\r\n\t      }\r\n\t    }\r\n\t    return html;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Type guarded rendering\r\n\t   *\r\n\t   */\r\n\t  _render(templateName, data) {\r\n\t    const html = this.render(templateName, data);\r\n\t    if (html == null) {\r\n\t      throw 'HTMLElement expected';\r\n\t    }\r\n\t    return html;\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Clears the render cache for a template. If\r\n\t   * no template is given, clears all render\r\n\t   * caches.\r\n\t   *\r\n\t   */\r\n\t  clearCache() {\r\n\t    iterate$1(this.options, option => {\r\n\t      if (option.$div) {\r\n\t        option.$div.remove();\r\n\t        delete option.$div;\r\n\t      }\r\n\t    });\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Removes a value from item and option caches\r\n\t   *\r\n\t   */\r\n\t  uncacheValue(value) {\r\n\t    const option_el = this.getOption(value);\r\n\t    if (option_el) option_el.remove();\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Determines whether or not to display the\r\n\t   * create item prompt, given a user input.\r\n\t   *\r\n\t   */\r\n\t  canCreate(input) {\r\n\t    return this.settings.create && input.length > 0 && this.settings.createFilter.call(this, input);\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Wraps this.`method` so that `new_fn` can be invoked 'before', 'after', or 'instead' of the original method\r\n\t   *\r\n\t   * this.hook('instead','onKeyDown',function( arg1, arg2 ...){\r\n\t   *\r\n\t   * });\r\n\t   */\r\n\t  hook(when, method, new_fn) {\r\n\t    var self = this;\r\n\t    var orig_method = self[method];\r\n\t    self[method] = function () {\r\n\t      var result, result_new;\r\n\t      if (when === 'after') {\r\n\t        result = orig_method.apply(self, arguments);\r\n\t      }\r\n\t      result_new = new_fn.apply(self, arguments);\r\n\t      if (when === 'instead') {\r\n\t        return result_new;\r\n\t      }\r\n\t      if (when === 'before') {\r\n\t        result = orig_method.apply(self, arguments);\r\n\t      }\r\n\t      return result;\r\n\t    };\r\n\t  }\r\n\t}\r\n\r\n\t/**\r\n\t * Plugin: \"change_listener\" (Tom Select)\r\n\t * Copyright (c) contributors\r\n\t *\r\n\t * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\r\n\t * file except in compliance with the License. You may obtain a copy of the License at:\r\n\t * http://www.apache.org/licenses/LICENSE-2.0\r\n\t *\r\n\t * Unless required by applicable law or agreed to in writing, software distributed under\r\n\t * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\r\n\t * ANY KIND, either express or implied. See the License for the specific language\r\n\t * governing permissions and limitations under the License.\r\n\t *\r\n\t */\r\n\r\n\tfunction change_listener () {\r\n\t  addEvent(this.input, 'change', () => {\r\n\t    this.sync();\r\n\t  });\r\n\t}\r\n\r\n\t/**\r\n\t * Plugin: \"checkbox_options\" (Tom Select)\r\n\t * Copyright (c) contributors\r\n\t *\r\n\t * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\r\n\t * file except in compliance with the License. You may obtain a copy of the License at:\r\n\t * http://www.apache.org/licenses/LICENSE-2.0\r\n\t *\r\n\t * Unless required by applicable law or agreed to in writing, software distributed under\r\n\t * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\r\n\t * ANY KIND, either express or implied. See the License for the specific language\r\n\t * governing permissions and limitations under the License.\r\n\t *\r\n\t */\r\n\r\n\tfunction checkbox_options (userOptions) {\r\n\t  var self = this;\r\n\t  var orig_onOptionSelect = self.onOptionSelect;\r\n\t  self.settings.hideSelected = false;\r\n\t  const cbOptions = Object.assign({\r\n\t    // so that the user may add different ones as well\r\n\t    className: \"tomselect-checkbox\",\r\n\t    // the following default to the historic plugin's values\r\n\t    checkedClassNames: undefined,\r\n\t    uncheckedClassNames: undefined\r\n\t  }, userOptions);\r\n\t  var UpdateChecked = function UpdateChecked(checkbox, toCheck) {\r\n\t    if (toCheck) {\r\n\t      checkbox.checked = true;\r\n\t      if (cbOptions.uncheckedClassNames) {\r\n\t        checkbox.classList.remove(...cbOptions.uncheckedClassNames);\r\n\t      }\r\n\t      if (cbOptions.checkedClassNames) {\r\n\t        checkbox.classList.add(...cbOptions.checkedClassNames);\r\n\t      }\r\n\t    } else {\r\n\t      checkbox.checked = false;\r\n\t      if (cbOptions.checkedClassNames) {\r\n\t        checkbox.classList.remove(...cbOptions.checkedClassNames);\r\n\t      }\r\n\t      if (cbOptions.uncheckedClassNames) {\r\n\t        checkbox.classList.add(...cbOptions.uncheckedClassNames);\r\n\t      }\r\n\t    }\r\n\t  };\r\n\r\n\t  // update the checkbox for an option\r\n\t  var UpdateCheckbox = function UpdateCheckbox(option) {\r\n\t    setTimeout(() => {\r\n\t      var checkbox = option.querySelector('input.' + cbOptions.className);\r\n\t      if (checkbox instanceof HTMLInputElement) {\r\n\t        UpdateChecked(checkbox, option.classList.contains('selected'));\r\n\t      }\r\n\t    }, 1);\r\n\t  };\r\n\r\n\t  // add checkbox to option template\r\n\t  self.hook('after', 'setupTemplates', () => {\r\n\t    var orig_render_option = self.settings.render.option;\r\n\t    self.settings.render.option = (data, escape_html) => {\r\n\t      var rendered = getDom(orig_render_option.call(self, data, escape_html));\r\n\t      var checkbox = document.createElement('input');\r\n\t      if (cbOptions.className) {\r\n\t        checkbox.classList.add(cbOptions.className);\r\n\t      }\r\n\t      checkbox.addEventListener('click', function (evt) {\r\n\t        preventDefault(evt);\r\n\t      });\r\n\t      checkbox.type = 'checkbox';\r\n\t      const hashed = hash_key(data[self.settings.valueField]);\r\n\t      UpdateChecked(checkbox, !!(hashed && self.items.indexOf(hashed) > -1));\r\n\t      rendered.prepend(checkbox);\r\n\t      return rendered;\r\n\t    };\r\n\t  });\r\n\r\n\t  // uncheck when item removed\r\n\t  self.on('item_remove', value => {\r\n\t    var option = self.getOption(value);\r\n\t    if (option) {\r\n\t      // if dropdown hasn't been opened yet, the option won't exist\r\n\t      option.classList.remove('selected'); // selected class won't be removed yet\r\n\t      UpdateCheckbox(option);\r\n\t    }\r\n\t  });\r\n\r\n\t  // check when item added\r\n\t  self.on('item_add', value => {\r\n\t    var option = self.getOption(value);\r\n\t    if (option) {\r\n\t      // if dropdown hasn't been opened yet, the option won't exist\r\n\t      UpdateCheckbox(option);\r\n\t    }\r\n\t  });\r\n\r\n\t  // remove items when selected option is clicked\r\n\t  self.hook('instead', 'onOptionSelect', (evt, option) => {\r\n\t    if (option.classList.contains('selected')) {\r\n\t      option.classList.remove('selected');\r\n\t      self.removeItem(option.dataset.value);\r\n\t      self.refreshOptions();\r\n\t      preventDefault(evt, true);\r\n\t      return;\r\n\t    }\r\n\t    orig_onOptionSelect.call(self, evt, option);\r\n\t    UpdateCheckbox(option);\r\n\t  });\r\n\t}\r\n\r\n\t/**\r\n\t * Plugin: \"dropdown_header\" (Tom Select)\r\n\t * Copyright (c) contributors\r\n\t *\r\n\t * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\r\n\t * file except in compliance with the License. You may obtain a copy of the License at:\r\n\t * http://www.apache.org/licenses/LICENSE-2.0\r\n\t *\r\n\t * Unless required by applicable law or agreed to in writing, software distributed under\r\n\t * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\r\n\t * ANY KIND, either express or implied. See the License for the specific language\r\n\t * governing permissions and limitations under the License.\r\n\t *\r\n\t */\r\n\r\n\tfunction clear_button (userOptions) {\r\n\t  const self = this;\r\n\t  const options = Object.assign({\r\n\t    className: 'clear-button',\r\n\t    title: 'Clear All',\r\n\t    html: data => {\r\n\t      return `<div class=\"${data.className}\" title=\"${data.title}\">&#10799;</div>`;\r\n\t    }\r\n\t  }, userOptions);\r\n\t  self.on('initialize', () => {\r\n\t    var button = getDom(options.html(options));\r\n\t    button.addEventListener('click', evt => {\r\n\t      if (self.isLocked) return;\r\n\t      self.clear();\r\n\t      if (self.settings.mode === 'single' && self.settings.allowEmptyOption) {\r\n\t        self.addItem('');\r\n\t      }\r\n\t      evt.preventDefault();\r\n\t      evt.stopPropagation();\r\n\t    });\r\n\t    self.control.appendChild(button);\r\n\t  });\r\n\t}\r\n\r\n\t/**\r\n\t * Plugin: \"drag_drop\" (Tom Select)\r\n\t * Copyright (c) contributors\r\n\t *\r\n\t * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\r\n\t * file except in compliance with the License. You may obtain a copy of the License at:\r\n\t * http://www.apache.org/licenses/LICENSE-2.0\r\n\t *\r\n\t * Unless required by applicable law or agreed to in writing, software distributed under\r\n\t * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\r\n\t * ANY KIND, either express or implied. See the License for the specific language\r\n\t * governing permissions and limitations under the License.\r\n\t *\r\n\t */\r\n\r\n\tconst insertAfter = (referenceNode, newNode) => {\r\n\t  var _referenceNode$parent;\r\n\t  (_referenceNode$parent = referenceNode.parentNode) == null || _referenceNode$parent.insertBefore(newNode, referenceNode.nextSibling);\r\n\t};\r\n\tconst insertBefore = (referenceNode, newNode) => {\r\n\t  var _referenceNode$parent2;\r\n\t  (_referenceNode$parent2 = referenceNode.parentNode) == null || _referenceNode$parent2.insertBefore(newNode, referenceNode);\r\n\t};\r\n\tconst isBefore = (referenceNode, newNode) => {\r\n\t  do {\r\n\t    var _newNode;\r\n\t    newNode = (_newNode = newNode) == null ? void 0 : _newNode.previousElementSibling;\r\n\t    if (referenceNode == newNode) {\r\n\t      return true;\r\n\t    }\r\n\t  } while (newNode && newNode.previousElementSibling);\r\n\t  return false;\r\n\t};\r\n\tfunction drag_drop () {\r\n\t  var self = this;\r\n\t  if (self.settings.mode !== 'multi') return;\r\n\t  var orig_lock = self.lock;\r\n\t  var orig_unlock = self.unlock;\r\n\t  let sortable = true;\r\n\t  let drag_item;\r\n\r\n\t  /**\r\n\t   * Add draggable attribute to item\r\n\t   */\r\n\t  self.hook('after', 'setupTemplates', () => {\r\n\t    var orig_render_item = self.settings.render.item;\r\n\t    self.settings.render.item = (data, escape) => {\r\n\t      const item = getDom(orig_render_item.call(self, data, escape));\r\n\t      setAttr(item, {\r\n\t        'draggable': 'true'\r\n\t      });\r\n\r\n\t      // prevent doc_mousedown (see tom-select.ts)\r\n\t      const mousedown = evt => {\r\n\t        if (!sortable) preventDefault(evt);\r\n\t        evt.stopPropagation();\r\n\t      };\r\n\t      const dragStart = evt => {\r\n\t        drag_item = item;\r\n\t        setTimeout(() => {\r\n\t          item.classList.add('ts-dragging');\r\n\t        }, 0);\r\n\t      };\r\n\t      const dragOver = evt => {\r\n\t        evt.preventDefault();\r\n\t        item.classList.add('ts-drag-over');\r\n\t        moveitem(item, drag_item);\r\n\t      };\r\n\t      const dragLeave = () => {\r\n\t        item.classList.remove('ts-drag-over');\r\n\t      };\r\n\t      const moveitem = (targetitem, dragitem) => {\r\n\t        if (dragitem === undefined) return;\r\n\t        if (isBefore(dragitem, item)) {\r\n\t          insertAfter(targetitem, dragitem);\r\n\t        } else {\r\n\t          insertBefore(targetitem, dragitem);\r\n\t        }\r\n\t      };\r\n\t      const dragend = () => {\r\n\t        var _drag_item;\r\n\t        document.querySelectorAll('.ts-drag-over').forEach(el => el.classList.remove('ts-drag-over'));\r\n\t        (_drag_item = drag_item) == null || _drag_item.classList.remove('ts-dragging');\r\n\t        drag_item = undefined;\r\n\t        var values = [];\r\n\t        self.control.querySelectorAll(`[data-value]`).forEach(el => {\r\n\t          if (el.dataset.value) {\r\n\t            let value = el.dataset.value;\r\n\t            if (value) {\r\n\t              values.push(value);\r\n\t            }\r\n\t          }\r\n\t        });\r\n\t        self.setValue(values);\r\n\t      };\r\n\t      addEvent(item, 'mousedown', mousedown);\r\n\t      addEvent(item, 'dragstart', dragStart);\r\n\t      addEvent(item, 'dragenter', dragOver);\r\n\t      addEvent(item, 'dragover', dragOver);\r\n\t      addEvent(item, 'dragleave', dragLeave);\r\n\t      addEvent(item, 'dragend', dragend);\r\n\t      return item;\r\n\t    };\r\n\t  });\r\n\t  self.hook('instead', 'lock', () => {\r\n\t    sortable = false;\r\n\t    return orig_lock.call(self);\r\n\t  });\r\n\t  self.hook('instead', 'unlock', () => {\r\n\t    sortable = true;\r\n\t    return orig_unlock.call(self);\r\n\t  });\r\n\t}\r\n\r\n\t/**\r\n\t * Plugin: \"dropdown_header\" (Tom Select)\r\n\t * Copyright (c) contributors\r\n\t *\r\n\t * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\r\n\t * file except in compliance with the License. You may obtain a copy of the License at:\r\n\t * http://www.apache.org/licenses/LICENSE-2.0\r\n\t *\r\n\t * Unless required by applicable law or agreed to in writing, software distributed under\r\n\t * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\r\n\t * ANY KIND, either express or implied. See the License for the specific language\r\n\t * governing permissions and limitations under the License.\r\n\t *\r\n\t */\r\n\r\n\tfunction dropdown_header (userOptions) {\r\n\t  const self = this;\r\n\t  const options = Object.assign({\r\n\t    title: 'Untitled',\r\n\t    headerClass: 'dropdown-header',\r\n\t    titleRowClass: 'dropdown-header-title',\r\n\t    labelClass: 'dropdown-header-label',\r\n\t    closeClass: 'dropdown-header-close',\r\n\t    html: data => {\r\n\t      return '<div class=\"' + data.headerClass + '\">' + '<div class=\"' + data.titleRowClass + '\">' + '<span class=\"' + data.labelClass + '\">' + data.title + '</span>' + '<a class=\"' + data.closeClass + '\">&times;</a>' + '</div>' + '</div>';\r\n\t    }\r\n\t  }, userOptions);\r\n\t  self.on('initialize', () => {\r\n\t    var header = getDom(options.html(options));\r\n\t    var close_link = header.querySelector('.' + options.closeClass);\r\n\t    if (close_link) {\r\n\t      close_link.addEventListener('click', evt => {\r\n\t        preventDefault(evt, true);\r\n\t        self.close();\r\n\t      });\r\n\t    }\r\n\t    self.dropdown.insertBefore(header, self.dropdown.firstChild);\r\n\t  });\r\n\t}\r\n\r\n\t/**\r\n\t * Plugin: \"dropdown_input\" (Tom Select)\r\n\t * Copyright (c) contributors\r\n\t *\r\n\t * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\r\n\t * file except in compliance with the License. You may obtain a copy of the License at:\r\n\t * http://www.apache.org/licenses/LICENSE-2.0\r\n\t *\r\n\t * Unless required by applicable law or agreed to in writing, software distributed under\r\n\t * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\r\n\t * ANY KIND, either express or implied. See the License for the specific language\r\n\t * governing permissions and limitations under the License.\r\n\t *\r\n\t */\r\n\r\n\tfunction caret_position () {\r\n\t  var self = this;\r\n\r\n\t  /**\r\n\t   * Moves the caret to the specified index.\r\n\t   *\r\n\t   * The input must be moved by leaving it in place and moving the\r\n\t   * siblings, due to the fact that focus cannot be restored once lost\r\n\t   * on mobile webkit devices\r\n\t   *\r\n\t   */\r\n\t  self.hook('instead', 'setCaret', new_pos => {\r\n\t    if (self.settings.mode === 'single' || !self.control.contains(self.control_input)) {\r\n\t      new_pos = self.items.length;\r\n\t    } else {\r\n\t      new_pos = Math.max(0, Math.min(self.items.length, new_pos));\r\n\t      if (new_pos != self.caretPos && !self.isPending) {\r\n\t        self.controlChildren().forEach((child, j) => {\r\n\t          if (j < new_pos) {\r\n\t            self.control_input.insertAdjacentElement('beforebegin', child);\r\n\t          } else {\r\n\t            self.control.appendChild(child);\r\n\t          }\r\n\t        });\r\n\t      }\r\n\t    }\r\n\t    self.caretPos = new_pos;\r\n\t  });\r\n\t  self.hook('instead', 'moveCaret', direction => {\r\n\t    if (!self.isFocused) return;\r\n\r\n\t    // move caret before or after selected items\r\n\t    const last_active = self.getLastActive(direction);\r\n\t    if (last_active) {\r\n\t      const idx = nodeIndex(last_active);\r\n\t      self.setCaret(direction > 0 ? idx + 1 : idx);\r\n\t      self.setActiveItem();\r\n\t      removeClasses(last_active, 'last-active');\r\n\r\n\t      // move caret left or right of current position\r\n\t    } else {\r\n\t      self.setCaret(self.caretPos + direction);\r\n\t    }\r\n\t  });\r\n\t}\r\n\r\n\t/**\r\n\t * Plugin: \"dropdown_input\" (Tom Select)\r\n\t * Copyright (c) contributors\r\n\t *\r\n\t * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\r\n\t * file except in compliance with the License. You may obtain a copy of the License at:\r\n\t * http://www.apache.org/licenses/LICENSE-2.0\r\n\t *\r\n\t * Unless required by applicable law or agreed to in writing, software distributed under\r\n\t * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\r\n\t * ANY KIND, either express or implied. See the License for the specific language\r\n\t * governing permissions and limitations under the License.\r\n\t *\r\n\t */\r\n\r\n\tfunction dropdown_input () {\r\n\t  const self = this;\r\n\t  self.settings.shouldOpen = true; // make sure the input is shown even if there are no options to display in the dropdown\r\n\r\n\t  self.hook('before', 'setup', () => {\r\n\t    self.focus_node = self.control;\r\n\t    addClasses(self.control_input, 'dropdown-input');\r\n\t    const div = getDom('<div class=\"dropdown-input-wrap\">');\r\n\t    div.append(self.control_input);\r\n\t    self.dropdown.insertBefore(div, self.dropdown.firstChild);\r\n\r\n\t    // set a placeholder in the select control\r\n\t    const placeholder = getDom('<input class=\"items-placeholder\" tabindex=\"-1\" />');\r\n\t    placeholder.placeholder = self.settings.placeholder || '';\r\n\t    self.control.append(placeholder);\r\n\t  });\r\n\t  self.on('initialize', () => {\r\n\t    // set tabIndex on control to -1, otherwise [shift+tab] will put focus right back on control_input\r\n\t    self.control_input.addEventListener('keydown', evt => {\r\n\t      //addEvent(self.control_input,'keydown' as const,(evt:KeyboardEvent) =>{\r\n\t      switch (evt.keyCode) {\r\n\t        case KEY_ESC:\r\n\t          if (self.isOpen) {\r\n\t            preventDefault(evt, true);\r\n\t            self.close();\r\n\t          }\r\n\t          self.clearActiveItems();\r\n\t          return;\r\n\t        case KEY_TAB:\r\n\t          self.focus_node.tabIndex = -1;\r\n\t          break;\r\n\t      }\r\n\t      return self.onKeyDown.call(self, evt);\r\n\t    });\r\n\t    self.on('blur', () => {\r\n\t      self.focus_node.tabIndex = self.isDisabled ? -1 : self.tabIndex;\r\n\t    });\r\n\r\n\t    // give the control_input focus when the dropdown is open\r\n\t    self.on('dropdown_open', () => {\r\n\t      self.control_input.focus();\r\n\t    });\r\n\r\n\t    // prevent onBlur from closing when focus is on the control_input\r\n\t    const orig_onBlur = self.onBlur;\r\n\t    self.hook('instead', 'onBlur', evt => {\r\n\t      if (evt && evt.relatedTarget == self.control_input) return;\r\n\t      return orig_onBlur.call(self);\r\n\t    });\r\n\t    addEvent(self.control_input, 'blur', () => self.onBlur());\r\n\r\n\t    // return focus to control to allow further keyboard input\r\n\t    self.hook('before', 'close', () => {\r\n\t      if (!self.isOpen) return;\r\n\t      self.focus_node.focus({\r\n\t        preventScroll: true\r\n\t      });\r\n\t    });\r\n\t  });\r\n\t}\r\n\r\n\t/**\r\n\t * Plugin: \"input_autogrow\" (Tom Select)\r\n\t *\r\n\t * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\r\n\t * file except in compliance with the License. You may obtain a copy of the License at:\r\n\t * http://www.apache.org/licenses/LICENSE-2.0\r\n\t *\r\n\t * Unless required by applicable law or agreed to in writing, software distributed under\r\n\t * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\r\n\t * ANY KIND, either express or implied. See the License for the specific language\r\n\t * governing permissions and limitations under the License.\r\n\t *\r\n\t */\r\n\r\n\tfunction input_autogrow () {\r\n\t  var self = this;\r\n\t  self.on('initialize', () => {\r\n\t    var test_input = document.createElement('span');\r\n\t    var control = self.control_input;\r\n\t    test_input.style.cssText = 'position:absolute; top:-99999px; left:-99999px; width:auto; padding:0; white-space:pre; ';\r\n\t    self.wrapper.appendChild(test_input);\r\n\t    var transfer_styles = ['letterSpacing', 'fontSize', 'fontFamily', 'fontWeight', 'textTransform'];\r\n\t    for (const style_name of transfer_styles) {\r\n\t      // @ts-ignore TS7015 https://stackoverflow.com/a/50506154/697576\r\n\t      test_input.style[style_name] = control.style[style_name];\r\n\t    }\r\n\r\n\t    /**\r\n\t     * Set the control width\r\n\t     *\r\n\t     */\r\n\t    var resize = () => {\r\n\t      test_input.textContent = control.value;\r\n\t      control.style.width = test_input.clientWidth + 'px';\r\n\t    };\r\n\t    resize();\r\n\t    self.on('update item_add item_remove', resize);\r\n\t    addEvent(control, 'input', resize);\r\n\t    addEvent(control, 'keyup', resize);\r\n\t    addEvent(control, 'blur', resize);\r\n\t    addEvent(control, 'update', resize);\r\n\t  });\r\n\t}\r\n\r\n\t/**\r\n\t * Plugin: \"input_autogrow\" (Tom Select)\r\n\t *\r\n\t * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\r\n\t * file except in compliance with the License. You may obtain a copy of the License at:\r\n\t * http://www.apache.org/licenses/LICENSE-2.0\r\n\t *\r\n\t * Unless required by applicable law or agreed to in writing, software distributed under\r\n\t * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\r\n\t * ANY KIND, either express or implied. See the License for the specific language\r\n\t * governing permissions and limitations under the License.\r\n\t *\r\n\t */\r\n\r\n\tfunction no_backspace_delete () {\r\n\t  var self = this;\r\n\t  var orig_deleteSelection = self.deleteSelection;\r\n\t  this.hook('instead', 'deleteSelection', evt => {\r\n\t    if (self.activeItems.length) {\r\n\t      return orig_deleteSelection.call(self, evt);\r\n\t    }\r\n\t    return false;\r\n\t  });\r\n\t}\r\n\r\n\t/**\r\n\t * Plugin: \"no_active_items\" (Tom Select)\r\n\t *\r\n\t * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\r\n\t * file except in compliance with the License. You may obtain a copy of the License at:\r\n\t * http://www.apache.org/licenses/LICENSE-2.0\r\n\t *\r\n\t * Unless required by applicable law or agreed to in writing, software distributed under\r\n\t * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\r\n\t * ANY KIND, either express or implied. See the License for the specific language\r\n\t * governing permissions and limitations under the License.\r\n\t *\r\n\t */\r\n\r\n\tfunction no_active_items () {\r\n\t  this.hook('instead', 'setActiveItem', () => {});\r\n\t  this.hook('instead', 'selectAll', () => {});\r\n\t}\r\n\r\n\t/**\r\n\t * Plugin: \"optgroup_columns\" (Tom Select.js)\r\n\t * Copyright (c) contributors\r\n\t *\r\n\t * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\r\n\t * file except in compliance with the License. You may obtain a copy of the License at:\r\n\t * http://www.apache.org/licenses/LICENSE-2.0\r\n\t *\r\n\t * Unless required by applicable law or agreed to in writing, software distributed under\r\n\t * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\r\n\t * ANY KIND, either express or implied. See the License for the specific language\r\n\t * governing permissions and limitations under the License.\r\n\t *\r\n\t */\r\n\r\n\tfunction optgroup_columns () {\r\n\t  var self = this;\r\n\t  var orig_keydown = self.onKeyDown;\r\n\t  self.hook('instead', 'onKeyDown', evt => {\r\n\t    var index, option, options, optgroup;\r\n\t    if (!self.isOpen || !(evt.keyCode === KEY_LEFT || evt.keyCode === KEY_RIGHT)) {\r\n\t      return orig_keydown.call(self, evt);\r\n\t    }\r\n\t    self.ignoreHover = true;\r\n\t    optgroup = parentMatch(self.activeOption, '[data-group]');\r\n\t    index = nodeIndex(self.activeOption, '[data-selectable]');\r\n\t    if (!optgroup) {\r\n\t      return;\r\n\t    }\r\n\t    if (evt.keyCode === KEY_LEFT) {\r\n\t      optgroup = optgroup.previousSibling;\r\n\t    } else {\r\n\t      optgroup = optgroup.nextSibling;\r\n\t    }\r\n\t    if (!optgroup) {\r\n\t      return;\r\n\t    }\r\n\t    options = optgroup.querySelectorAll('[data-selectable]');\r\n\t    option = options[Math.min(options.length - 1, index)];\r\n\t    if (option) {\r\n\t      self.setActiveOption(option);\r\n\t    }\r\n\t  });\r\n\t}\r\n\r\n\t/**\r\n\t * Plugin: \"remove_button\" (Tom Select)\r\n\t * Copyright (c) contributors\r\n\t *\r\n\t * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\r\n\t * file except in compliance with the License. You may obtain a copy of the License at:\r\n\t * http://www.apache.org/licenses/LICENSE-2.0\r\n\t *\r\n\t * Unless required by applicable law or agreed to in writing, software distributed under\r\n\t * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\r\n\t * ANY KIND, either express or implied. See the License for the specific language\r\n\t * governing permissions and limitations under the License.\r\n\t *\r\n\t */\r\n\r\n\tfunction remove_button (userOptions) {\r\n\t  const options = Object.assign({\r\n\t    label: '&times;',\r\n\t    title: 'Remove',\r\n\t    className: 'remove',\r\n\t    append: true\r\n\t  }, userOptions);\r\n\r\n\t  //options.className = 'remove-single';\r\n\t  var self = this;\r\n\r\n\t  // override the render method to add remove button to each item\r\n\t  if (!options.append) {\r\n\t    return;\r\n\t  }\r\n\t  var html = '<a href=\"javascript:void(0)\" class=\"' + options.className + '\" tabindex=\"-1\" title=\"' + escape_html(options.title) + '\">' + options.label + '</a>';\r\n\t  self.hook('after', 'setupTemplates', () => {\r\n\t    var orig_render_item = self.settings.render.item;\r\n\t    self.settings.render.item = (data, escape) => {\r\n\t      var item = getDom(orig_render_item.call(self, data, escape));\r\n\t      var close_button = getDom(html);\r\n\t      item.appendChild(close_button);\r\n\t      addEvent(close_button, 'mousedown', evt => {\r\n\t        preventDefault(evt, true);\r\n\t      });\r\n\t      addEvent(close_button, 'click', evt => {\r\n\t        if (self.isLocked) return;\r\n\r\n\t        // propagating will trigger the dropdown to show for single mode\r\n\t        preventDefault(evt, true);\r\n\t        if (self.isLocked) return;\r\n\t        if (!self.shouldDelete([item], evt)) return;\r\n\t        self.removeItem(item);\r\n\t        self.refreshOptions(false);\r\n\t        self.inputState();\r\n\t      });\r\n\t      return item;\r\n\t    };\r\n\t  });\r\n\t}\r\n\r\n\t/**\r\n\t * Plugin: \"restore_on_backspace\" (Tom Select)\r\n\t * Copyright (c) contributors\r\n\t *\r\n\t * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\r\n\t * file except in compliance with the License. You may obtain a copy of the License at:\r\n\t * http://www.apache.org/licenses/LICENSE-2.0\r\n\t *\r\n\t * Unless required by applicable law or agreed to in writing, software distributed under\r\n\t * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\r\n\t * ANY KIND, either express or implied. See the License for the specific language\r\n\t * governing permissions and limitations under the License.\r\n\t *\r\n\t */\r\n\r\n\tfunction restore_on_backspace (userOptions) {\r\n\t  const self = this;\r\n\t  const options = Object.assign({\r\n\t    text: option => {\r\n\t      return option[self.settings.labelField];\r\n\t    }\r\n\t  }, userOptions);\r\n\t  self.on('item_remove', function (value) {\r\n\t    if (!self.isFocused) {\r\n\t      return;\r\n\t    }\r\n\t    if (self.control_input.value.trim() === '') {\r\n\t      var option = self.options[value];\r\n\t      if (option) {\r\n\t        self.setTextboxValue(options.text.call(self, option));\r\n\t      }\r\n\t    }\r\n\t  });\r\n\t}\r\n\r\n\t/**\r\n\t * Plugin: \"restore_on_backspace\" (Tom Select)\r\n\t * Copyright (c) contributors\r\n\t *\r\n\t * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\r\n\t * file except in compliance with the License. You may obtain a copy of the License at:\r\n\t * http://www.apache.org/licenses/LICENSE-2.0\r\n\t *\r\n\t * Unless required by applicable law or agreed to in writing, software distributed under\r\n\t * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\r\n\t * ANY KIND, either express or implied. See the License for the specific language\r\n\t * governing permissions and limitations under the License.\r\n\t *\r\n\t */\r\n\r\n\tfunction virtual_scroll () {\r\n\t  const self = this;\r\n\t  const orig_canLoad = self.canLoad;\r\n\t  const orig_clearActiveOption = self.clearActiveOption;\r\n\t  const orig_loadCallback = self.loadCallback;\r\n\t  var pagination = {};\r\n\t  var dropdown_content;\r\n\t  var loading_more = false;\r\n\t  var load_more_opt;\r\n\t  var default_values = [];\r\n\t  if (!self.settings.shouldLoadMore) {\r\n\t    // return true if additional results should be loaded\r\n\t    self.settings.shouldLoadMore = () => {\r\n\t      const scroll_percent = dropdown_content.clientHeight / (dropdown_content.scrollHeight - dropdown_content.scrollTop);\r\n\t      if (scroll_percent > 0.9) {\r\n\t        return true;\r\n\t      }\r\n\t      if (self.activeOption) {\r\n\t        var selectable = self.selectable();\r\n\t        var index = Array.from(selectable).indexOf(self.activeOption);\r\n\t        if (index >= selectable.length - 2) {\r\n\t          return true;\r\n\t        }\r\n\t      }\r\n\t      return false;\r\n\t    };\r\n\t  }\r\n\t  if (!self.settings.firstUrl) {\r\n\t    throw 'virtual_scroll plugin requires a firstUrl() method';\r\n\t  }\r\n\r\n\t  // in order for virtual scrolling to work,\r\n\t  // options need to be ordered the same way they're returned from the remote data source\r\n\t  self.settings.sortField = [{\r\n\t    field: '$order'\r\n\t  }, {\r\n\t    field: '$score'\r\n\t  }];\r\n\r\n\t  // can we load more results for given query?\r\n\t  const canLoadMore = query => {\r\n\t    if (typeof self.settings.maxOptions === 'number' && dropdown_content.children.length >= self.settings.maxOptions) {\r\n\t      return false;\r\n\t    }\r\n\t    if (query in pagination && pagination[query]) {\r\n\t      return true;\r\n\t    }\r\n\t    return false;\r\n\t  };\r\n\t  const clearFilter = (option, value) => {\r\n\t    if (self.items.indexOf(value) >= 0 || default_values.indexOf(value) >= 0) {\r\n\t      return true;\r\n\t    }\r\n\t    return false;\r\n\t  };\r\n\r\n\t  // set the next url that will be\r\n\t  self.setNextUrl = (value, next_url) => {\r\n\t    pagination[value] = next_url;\r\n\t  };\r\n\r\n\t  // getUrl() to be used in settings.load()\r\n\t  self.getUrl = query => {\r\n\t    if (query in pagination) {\r\n\t      const next_url = pagination[query];\r\n\t      pagination[query] = false;\r\n\t      return next_url;\r\n\t    }\r\n\r\n\t    // if the user goes back to a previous query\r\n\t    // we need to load the first page again\r\n\t    self.clearPagination();\r\n\t    return self.settings.firstUrl.call(self, query);\r\n\t  };\r\n\r\n\t  // clear pagination\r\n\t  self.clearPagination = () => {\r\n\t    pagination = {};\r\n\t  };\r\n\r\n\t  // don't clear the active option (and cause unwanted dropdown scroll)\r\n\t  // while loading more results\r\n\t  self.hook('instead', 'clearActiveOption', () => {\r\n\t    if (loading_more) {\r\n\t      return;\r\n\t    }\r\n\t    return orig_clearActiveOption.call(self);\r\n\t  });\r\n\r\n\t  // override the canLoad method\r\n\t  self.hook('instead', 'canLoad', query => {\r\n\t    // first time the query has been seen\r\n\t    if (!(query in pagination)) {\r\n\t      return orig_canLoad.call(self, query);\r\n\t    }\r\n\t    return canLoadMore(query);\r\n\t  });\r\n\r\n\t  // wrap the load\r\n\t  self.hook('instead', 'loadCallback', (options, optgroups) => {\r\n\t    if (!loading_more) {\r\n\t      self.clearOptions(clearFilter);\r\n\t    } else if (load_more_opt) {\r\n\t      const first_option = options[0];\r\n\t      if (first_option !== undefined) {\r\n\t        load_more_opt.dataset.value = first_option[self.settings.valueField];\r\n\t      }\r\n\t    }\r\n\t    orig_loadCallback.call(self, options, optgroups);\r\n\t    loading_more = false;\r\n\t  });\r\n\r\n\t  // add templates to dropdown\r\n\t  //\tloading_more if we have another url in the queue\r\n\t  //\tno_more_results if we don't have another url in the queue\r\n\t  self.hook('after', 'refreshOptions', () => {\r\n\t    const query = self.lastValue;\r\n\t    var option;\r\n\t    if (canLoadMore(query)) {\r\n\t      option = self.render('loading_more', {\r\n\t        query: query\r\n\t      });\r\n\t      if (option) {\r\n\t        option.setAttribute('data-selectable', ''); // so that navigating dropdown with [down] keypresses can navigate to this node\r\n\t        load_more_opt = option;\r\n\t      }\r\n\t    } else if (query in pagination && !dropdown_content.querySelector('.no-results')) {\r\n\t      option = self.render('no_more_results', {\r\n\t        query: query\r\n\t      });\r\n\t    }\r\n\t    if (option) {\r\n\t      addClasses(option, self.settings.optionClass);\r\n\t      dropdown_content.append(option);\r\n\t    }\r\n\t  });\r\n\r\n\t  // add scroll listener and default templates\r\n\t  self.on('initialize', () => {\r\n\t    default_values = Object.keys(self.options);\r\n\t    dropdown_content = self.dropdown_content;\r\n\r\n\t    // default templates\r\n\t    self.settings.render = Object.assign({}, {\r\n\t      loading_more: () => {\r\n\t        return `<div class=\"loading-more-results\">Loading more results ... </div>`;\r\n\t      },\r\n\t      no_more_results: () => {\r\n\t        return `<div class=\"no-more-results\">No more results</div>`;\r\n\t      }\r\n\t    }, self.settings.render);\r\n\r\n\t    // watch dropdown content scroll position\r\n\t    dropdown_content.addEventListener('scroll', () => {\r\n\t      if (!self.settings.shouldLoadMore.call(self)) {\r\n\t        return;\r\n\t      }\r\n\r\n\t      // !important: this will get checked again in load() but we still need to check here otherwise loading_more will be set to true\r\n\t      if (!canLoadMore(self.lastValue)) {\r\n\t        return;\r\n\t      }\r\n\r\n\t      // don't call load() too much\r\n\t      if (loading_more) return;\r\n\t      loading_more = true;\r\n\t      self.load.call(self, self.lastValue);\r\n\t    });\r\n\t  });\r\n\t}\r\n\r\n\tTomSelect.define('change_listener', change_listener);\r\n\tTomSelect.define('checkbox_options', checkbox_options);\r\n\tTomSelect.define('clear_button', clear_button);\r\n\tTomSelect.define('drag_drop', drag_drop);\r\n\tTomSelect.define('dropdown_header', dropdown_header);\r\n\tTomSelect.define('caret_position', caret_position);\r\n\tTomSelect.define('dropdown_input', dropdown_input);\r\n\tTomSelect.define('input_autogrow', input_autogrow);\r\n\tTomSelect.define('no_backspace_delete', no_backspace_delete);\r\n\tTomSelect.define('no_active_items', no_active_items);\r\n\tTomSelect.define('optgroup_columns', optgroup_columns);\r\n\tTomSelect.define('remove_button', remove_button);\r\n\tTomSelect.define('restore_on_backspace', restore_on_backspace);\r\n\tTomSelect.define('virtual_scroll', virtual_scroll);\r\n\r\n\treturn TomSelect;\r\n\r\n}));\r\nvar tomSelect=function(el,opts){return new TomSelect(el,opts);} \r\n//# sourceMappingURL=tom-select.complete.js.map"],"names":["global","factory","exports","module","define","amd","globalThis","self","TomSelect","this","forEvents","events","callback","split","forEach","event","MicroEvent","constructor","_events","on","fct","event_array","push","off","n","arguments","length","undefined","splice","indexOf","trigger","args","apply","arrayToPattern","chars","filter","Boolean","reduce","longest","value","Math","max","unicodeLength","join","sequencePattern","array","Set","size","let","pattern","prev_char_count","prev_pattern","char","i","setToPattern","toArray","escape_regex","str","replace","p","Array","from","allSubstrings","input","result","start","substring","subresult","tmp","slice","charAt","unshift","code_points","unicode_map","multi_char_reg","latin_convert","latin","latin_condensed","/","0","a","aa","ae","ao","au","av","ay","b","c","d","e","f","g","h","j","k","l","m","o","oe","oi","oo","ou","q","r","s","t","th","tz","u","v","vy","w","y","z","hv","unicode","convert_pat","RegExp","Object","keys","normalize","form","asciifold","_asciifold","toLowerCase","generateSets","unicode_sets","addMatching","folded","to_add","folded_set","patt","match","add","code_point_min","code_point_max","composed","String","fromCharCode","yield","code_point","generateMap","multi_char","set","sort","multi_char_patt","substringsToPattern","min_replacement","map","sub_pat","mapSequence","strings","chars_replaced","sequencesToPattern","sequences","all","sequence","seq","len","substrs","inSequences","needle_seq","end","needle_parts","parts","filtered","part","needle_part","substr","Sequence","min","last","clone","position","last_piece","JSON","parse","stringify","last_part","pop","last_substr","clone_last_len","getPattern","match_str","overlapping","old_seq","added_types","has","new_seq","getAttr","obj","name","getAttrNesting","names","shift","scoreValue","token","weight","pos","regex","search","score","string","propToArray","key","isArray","iterate$1","object","hasOwnProperty","Sifter","items","settings","diacritics","tokenize","query","respect_word_boundaries","weights","tokens","field_regex","words","word","field_match","field","getScoreFunction","options","prepareSearch","_getScoreFunction","token_count","fields","field_count","getAttrFn","scoreObject","data","sum","conjunction","getSortFunction","_getSortFunction","implicit_score","sort_flds","sort_empty","bind","get_field","id","fld","direction","sort_fld","optsUser","assign","trim","total","nesting","fn_score","item","_","fn_sort","limit","iterate","getDom","tpl","jquery","HTMLElement","isHtmlString","document","createElement","innerHTML","content","firstChild","querySelector","arg","triggerEvent","dom_el","event_name","createEvent","initEvent","dispatchEvent","applyCSS","css","style","addClasses","elmts","classes","norm_classes","classesArray","castAsArray","el","cls","classList","removeClasses","remove","_classes","concat","parentMatch","target","selector","wrapper","contains","matches","parentNode","getTail","list","nodeIndex","amongst","nodeName","previousElementSibling","setAttr","attrs","val","attr","removeAttribute","setAttribute","replaceNode","existing","replacement","replaceChild","highlight","element","highlightRecursive","node","spannode","nodeType","className","middlebit","splitText","index","middleclone","cloneNode","appendChild","childNodes","test","tagName","KEY_SHORTCUT","navigator","userAgent","defaults","optgroups","plugins","delimiter","splitOn","persist","create","createOnBlur","createFilter","openOnFocus","shouldOpen","maxOptions","maxItems","hideSelected","duplicates","addPrecedence","selectOnTab","preload","allowEmptyOption","refreshThrottle","loadThrottle","loadingClass","dataAttr","optgroupField","valueField","labelField","disabledField","optgroupLabelField","optgroupValueField","lockOptgroupOrder","sortField","searchField","searchConjunction","mode","wrapperClass","controlClass","dropdownClass","dropdownContentClass","itemClass","optionClass","dropdownParent","controlInput","copyClassesToDropdown","placeholder","hidePlaceholder","shouldLoad","render","hash_key","get_hash","escape_html","debounce_events","types","fn","type","event_args","preventDefault","evt","stop","stopPropagation","addEvent","addEventListener","isKeyDown","key_name","altKey","ctrlKey","shiftKey","metaKey","getId","existing_id","getAttribute","addSlashes","append","parent","getSettings","settings_user","data_raw","attr_data","field_label","field_value","field_disabled","field_optgroup","field_optgroup_label","field_optgroup_value","tag_name","settings_element","option","textContent","init_select","optionsMap","group_count","$order","readData","dataset","json","addOption","group","option_data","arr","disabled","$option","selected","hasAttribute","children","child","optgroup","optgroup_data","opt","values","Interface","instance_i","super","requested","loaded","initializePlugins","queue","plugin","require","loadPlugin","Error","input_arg","user_settings","control_input","dropdown","control","dropdown_content","focus_node","order","tabIndex","is_select_tag","rtl","inputId","_destroy","sifter","isOpen","isDisabled","isReadOnly","isRequired","isInvalid","isValid","isLocked","isFocused","isInputHidden","isSetup","ignoreFocus","ignoreHover","hasOptions","currentResults","lastValue","caretPos","loading","loadedSearches","activeOption","activeItems","userOptions","refreshTimeout","tomselect","dir","window","getComputedStyle","getPropertyValue","required","setupCallbacks","setupTemplates","_render","inputMode","setup","delay","timeout","passive_event","passive","listboxId","control_id","role","aria-haspopup","aria-expanded","aria-controls","label","label_click","focus","doc_mousedown","for","label_id","aria-labelledby","width","classes_plugins","multiple","load","clearTimeout","setTimeout","call","target_match","onOptionHover","capture","onOptionSelect","onItemSelect","onClick","onKeyDown","onKeyPress","onInput","onBlur","onFocus","onPaste","composedPath","blur","inputState","win_scroll","positionDropdown","removeEventListener","revertSettings","insertAdjacentElement","sync","refreshState","updateOriginalInput","refreshItems","close","disable","readOnly","setReadOnly","enable","onChange","setupOptions","addOptions","registerOptionGroup","optgroup_header","escape","option_create","no_results","not_loading","callbacks","initialize","change","item_add","item_remove","item_select","clear","option_add","option_remove","option_clear","optgroup_add","optgroup_remove","optgroup_clear","dropdown_open","dropdown_close","get_settings","setValue","lastQuery","clearActiveItems","onMouseDown","pastedText","inputValue","splitInput","piece","addItem","createItem","character","keyCode","which","prev","selectAll","open","next","getAdjacent","setActiveOption","canSelect","activeElement","advanceSelection","deleteSelection","_onInput","refreshOptions","wasFocused","deactivate","hasFocus","setActiveItem","setCaret","parentElement","closeAfterSelect","canLoad","loadCallback","clearActiveOption","setTextboxValue","getValue","silent","addItems","setMaxItems","eventName","swap","getLastActive","begin","prototype","setActiveItemClass","removeActiveItem","last_active","idx","scroll","aria-activedescendant","aria-selected","scrollToOption","behavior","height_menu","scrollTop","height_item","clientHeight","offsetHeight","getBoundingClientRect","top","scrollBehavior","controlChildren","toggle","offsetWidth","getSearchOptions","calculateScore","hashed","triggerDropdown","html","has_create_option","active_group","groups","groups_order","same_query","results","active_option","show_dropdown","closest","opt_value","opt_hash","option_el","getOption","includes","self_optgroup","group_order_i","group_fragment","order_group","fragment","createDocumentFragment","$id","toString","group_order","group_options","group_html","group_heading","header","elements","querySelectorAll","tok","add_template","template","insertBefore","canCreate","active_index","selectable","user_created","dat","registerOption","addOptionGroup","hashed_id","removeOptionGroup","clearCache","clearOptionGroups","updateOption","value_old","value_new","data_old","getItem","uncacheValue","option_new","index_item","item_new","removeOption","removeItem","clearOptions","boundFilter","clearFilter","$div","last_item","x","isPending","wasFull","isFull","insertAtCaret","caret","lock","created","unlock","output","refreshValidityState","wrap_classList","validity","valid","opts","empty_option","has_selected","AddSelected","visibility","display","rect","left","context","scrollY","scrollX","tail","selection","selectionStart","selectionEnd","rm_items","rm_item","shouldDelete","onDelete","adjacent","nextElementSibling","moveCaret","new_pos","setLocked","setDisabled","destroy","templateName","aria-disabled","data-selectable","data-group","data-disabled","data-value","data-ts-item","hook","when","method","new_fn","orig_method","result_new","orig_onOptionSelect","cbOptions","checkedClassNames","uncheckedClassNames","UpdateCheckbox","checkbox","HTMLInputElement","UpdateChecked","toCheck","checked","orig_render_option","rendered","prepend","title","button","orig_lock","orig_unlock","sortable","drag_item","orig_render_item","draggable","dragOver","moveitem","targetitem","dragitem","referenceNode","newNode","_referenceNode$parent","nextSibling","_referenceNode$parent2","_drag_item","headerClass","titleRowClass","labelClass","closeClass","close_link","div","orig_onBlur","relatedTarget","preventScroll","test_input","cssText","style_name","resize","clientWidth","orig_deleteSelection","orig_keydown","previousSibling","close_button","text","orig_canLoad","orig_clearActiveOption","orig_loadCallback","load_more_opt","pagination","loading_more","default_values","shouldLoadMore","scrollHeight","firstUrl","canLoadMore","setNextUrl","next_url","getUrl","clearPagination","first_option","no_more_results","tomSelect"],"mappings":"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"}