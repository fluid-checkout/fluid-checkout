{"version":3,"file":"../checkout-233.min.js","sources":["checkout-233.js"],"sourcesContent":["/**\n * Checkout Script\n * \n * Replaces the original WooCommerce `checkout.js`.\n */\n\n/* global wc_checkout_params */\njQuery( function( $ ) {\n\n\t// wc_checkout_params is required to continue, ensure the object exists\n\tif ( typeof wc_checkout_params === 'undefined' ) {\n\t\treturn false;\n\t}\n\n\t// CHANGE: Create flag to allow or block updating the checkout\n\twindow.can_update_checkout = true;\n\n\t// CHANGE: Add flag to up prevent users from leaving the page when there is unsaved data\n\tvar _updateBeforeUnload = false;\n\n\t// CHANGE: Add default settings object\n\tvar _settings = {\n\t\tformRowSelector:                              '.form-row',\n\t\tcheckoutPlaceOrderSelector:                   '#place_order, .fc-place-order-button',\n\t\tcheckoutTermsSelector:                        '.fc-terms-checkbox',\n\t\tcheckoutUpdateFieldsSelector:                 '.address-field input.input-text, .update_totals_on_change input.input-text',\n\t\tcheckoutLoadingInputSelector:                 '.loading_indicator_on_change input.input-text',\n\t\tfocusedFieldSkipFragmentReplaceSelector:      'input[type=\"text\"], input[type=\"color\"], input[type=\"date\"], input[type=\"datetime\"], input[type=\"datetime-local\"], input[type=\"email\"], input[type=\"file\"], input[type=\"image\"], input[type=\"month\"], input[type=\"number\"], input[type=\"password\"], input[type=\"search\"], input[type=\"tel\"], input[type=\"time\"], input[type=\"url\"], input[type=\"week\"], select, textarea, .fc-select2-field',\n\t\tphoneFieldSelector:                           'input[type=\"tel\"], [data-phone-field], input.js-phone-field, .js-phone-field input',\n\t\tloginButtonSelector:                          '.fc-contact-login__action',\n\t\temailFieldSelector:                           'form.woocommerce-checkout input[name=\"billing_email\"]',\n\t\tusernameFieldSelector:                        '.fc-login-form__inner input[name=\"username\"]',\n\n\t\tloadingClass:                                 'fc-loading',\n\n\t\tcheckoutPlaceOrderApplyLoadingClass:          'yes',\n\t\tcheckoutUpdateBeforeUnload:                   'yes',\n\t};\n\t// CHANGE: END - Add default settings object\n\n\t// CHANGE: Add auxiliar function to merge objects\n\t/*!\n\t* Merge two or more objects together.\n\t* (c) 2017 Chris Ferdinandi, MIT License, https://gomakethings.com\n\t* @param   {Boolean}  deep     If true, do a deep (or recursive) merge [optional]\n\t* @param   {Object}   objects  The objects to merge together\n\t* @returns {Object}            Merged values of defaults and options\n\t*/\n\tvar extend = function () {\n\t\t// Variables\n\t\tvar extended = {};\n\t\tvar deep = false;\n\t\tvar i = 0;\n\n\t\t// Check if a deep merge\n\t\tif ( Object.prototype.toString.call( arguments[0] ) === '[object Boolean]' ) {\n\t\t\tdeep = arguments[0];\n\t\t\ti++;\n\t\t}\n\n\t\t// Merge the object into the extended object\n\t\tvar merge = function (obj) {\n\t\t\tfor (var prop in obj) {\n\t\t\t\tif (obj.hasOwnProperty(prop)) {\n\t\t\t\t\t// If property is an object, merge properties\n\t\t\t\t\tif (deep && Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\t\t\t\t\t\textended[prop] = extend(extended[prop], obj[prop]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\textended[prop] = obj[prop];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t// Loop through each object and conduct a merge\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tvar obj = arguments[i];\n\t\t\tmerge(obj);\n\t\t}\n\n\t\treturn extended;\n    };\n\t// CHANGE: END - Add auxiliar function to merge objects\n\n\t$.blockUI.defaults.overlayCSS.cursor = 'default';\n\n\tconst ajax = options => {\n\t\tconst controller = new AbortController();\n\n\t\twindow.fetch( options.url, {\n\t\t\tmethod: options.type,\n\t\t\theaders: { 'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8' },\n\t\t\tbody: options.data,\n\t\t\tsignal: controller.signal\n\t\t} )\n\t\t\t.then( response => {\n\t\t\t\tresponse.text().then( text => {\n\t\t\t\t\tif ( !response.ok ) {\n\t\t\t\t\t\tconst error = new Error( response.statusText );\n\t\t\t\t\t\terror.responseText = text; // Needed for when wc_checkout_params.debug_mode is enabled\n\t\t\t\t\t\tthrow error;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( options.dataType === 'html' ) {\n\t\t\t\t\t\toptions.success( text );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst json = JSON.parse( ajax.dataFilter( text, 'json' ) );\n\t\t\t\t\toptions.success( json );\n\t\t\t\t} );\n\t\t\t} )\n\t\t\t.catch( error => options.error && options.error( error.responseText, 'error', error.message ) );\n\n\t\treturn controller;\n\t};\n\tajax.dataFilter = ( raw_response, dataType ) => raw_response;\n\n\tvar wc_checkout_form = {\n\t\tupdateTimer: false,\n\t\tdirtyInput: false,\n\t\tselectedPaymentMethod: false,\n\t\txhr: false,\n\t\t$order_review: $( '#order_review' ),\n\t\t$checkout_form: $( 'form.checkout' ),\n\t\tinit: function() {\n\t\t\t// CHANGE: Merge default settings object with values from the server settings object\n\t\t\t_settings = extend( true, _settings, window.fcSettings );\n\n\t\t\t$( document.body ).on( 'update_checkout', this.update_checkout );\n\t\t\t$( document.body ).on( 'init_checkout', this.init_checkout );\n\n\t\t\t// Set autocomplete attributes\n\t\t\t$( document.body ).on( 'init_checkout', this.set_autocomplete_attribute_from_data );\n\t\t\t$( document.body ).on( 'updated_checkout', this.set_autocomplete_attribute_from_data );\n\n\t\t\t// Payment methods\n\t\t\tthis.$checkout_form.on( 'click', 'input[name=\"payment_method\"]', this.payment_method_selected );\n\n\t\t\tif ( $( document.body ).hasClass( 'woocommerce-order-pay' ) ) {\n\t\t\t\tthis.$order_review.on( 'click', 'input[name=\"payment_method\"]', this.payment_method_selected );\n\t\t\t\tthis.$order_review.on( 'submit', this.submitOrder );\n\t\t\t\tthis.$order_review.attr( 'novalidate', 'novalidate' );\n\t\t\t}\n\n\t\t\t// Prevent HTML5 validation which can conflict.\n\t\t\tthis.$checkout_form.attr( 'novalidate', 'novalidate' );\n\n\t\t\t// Form submission\n\t\t\tthis.$checkout_form.on( 'submit', this.submit );\n\n\t\t\t// Inline validation\n\t\t\tthis.$checkout_form.on( 'input validate change', '.input-text, select, input:checkbox', this.validate_field );\n\n\t\t\t// Manual trigger\n\t\t\tthis.$checkout_form.on( 'update', this.trigger_update_checkout );\n\n\t\t\t// Inputs/selects which update totals\n\t\t\t// CHANGE: Removed selector `#ship-to-different-address input`\n\t\t\tthis.$checkout_form.on( 'change', 'select.shipping_method, input[name^=\"shipping_method\"], .update_totals_on_change select, .update_totals_on_change input[type=\"radio\"], .update_totals_on_change input[type=\"checkbox\"]', this.trigger_update_checkout ); // eslint-disable-line max-len\n\t\t\tthis.$checkout_form.on( 'change', '.address-field select', this.input_changed );\n\n\t\t\t// CHANGE: Move CSS selector for fields that trigger update checkout when value is changed\n\t\t\tthis.$checkout_form.on( 'change', _settings.checkoutUpdateFieldsSelector, this.maybe_input_changed ); // eslint-disable-line max-len\n\t\t\tthis.$checkout_form.on( 'keydown', _settings.checkoutUpdateFieldsSelector, this.queue_update_checkout ); // eslint-disable-line max-len\n\n\t\t\t// Address fields\n\t\t\t// CHANGE: Removed shipping to different address checkout `change` listener\n\n\t\t\t// CHANGE: Update checkout totals to save data to session when user switches tabs, apps, goes to homescreen, etc.\n\t\t\tdocument.addEventListener( 'visibilitychange', this.maybe_update_checkout_visibility_change );\n\n\t\t\t// CHANGE: Maybe prevent leaving the page if there are unsaved changes, and trigger `update_checkout` to save the data.\n\t\t\tif ( 'yes' === _settings.checkoutUpdateBeforeUnload ) {\n\t\t\t\tthis.$checkout_form.on( 'change, input', 'select, input, textarea', this.maybe_prevent_unload );\n\t\t\t}\n\n\t\t\t// CHANGE: Update checkout when \"billing same as shipping\" checked state changes\n\t\t\tthis.$checkout_form.on( 'change', '#billing_same_as_shipping', this.billing_same_shipping_changed );\n\n\t\t\t// CHANGE: Trigger reinitialization functions after checkout is updated\n\t\t\t$( document.body ).on( 'updated_checkout', this.maybe_reinitialize_collapsible_blocks );\n\t\t\t$( document.body ).on( 'updated_checkout', this.maybe_reinitialize_flyout_blocks );\n\n\t\t\t// CHANGE: Add event listener to sync terms checkbox state\n\t\t\tthis.$checkout_form.on( 'change', _settings.checkoutTermsSelector, this.terms_checked_changed );\n\n\t\t\t// Trigger events\n\t\t\t// CHANGE: Removed shipping to different address checkout `change` trigger\n\t\t\tthis.init_payment_methods();\n\n\t\t\t// Update on page load\n\t\t\tif ( wc_checkout_params.is_checkout === '1' ) {\n\t\t\t\t$( document.body ).trigger( 'init_checkout' );\n\t\t\t}\n\t\t\tif ( wc_checkout_params.option_guest_checkout === 'yes' ) {\n\t\t\t\t// CHANGE: Use native `change` event instead jQuery to handle create account checkbox toggle\n\t\t\t\tdocument.addEventListener( 'change', this.toggle_create_account, true );\n\t\t\t}\n\n\t\t\t// CHANGE: Add handler for login form modal initialization\n\t\t\tdocument.addEventListener( 'click', this.maybe_copy_email_to_login_form, true );\n\t\t},\n\t\t// CHANGE: Update checkout when \"billing same as shipping\" checked state changes\n\t\tbilling_same_shipping_changed: function( e ) {\n\t\t\tif ( window.CollapsibleBlock ) {\n\t\t\t\tvar checkbox = document.querySelector( '#billing_same_as_shipping' );\n\t\t\t\tvar fieldsWrapper = document.querySelector( '#woocommerce-billing-fields__field-wrapper' );\n\n\t\t\t\t// Toggle state\n\t\t\t\tif ( ! checkbox.checked ) {\n\t\t\t\t\tCollapsibleBlock.expand( fieldsWrapper );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tCollapsibleBlock.collapse( fieldsWrapper );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t$( document.body ).trigger( 'update_checkout' );\n\t\t},\n\t\t// CHANGE: Reinitialize collapsible blocks after checkout update\n\t\tmaybe_reinitialize_collapsible_blocks: function() {\n\t\t\t// Bail if collapsible blocks are not available\n\t\t\tif ( ! window.CollapsibleBlock ) { return; }\n\n\t\t\t// Try to initialize collapsible blocks if not yet initialized\n\t\t\tCollapsibleBlock.init( window.fcSettings ? fcSettings.collapsibleBlock : null );\n\n\t\t\tvar collapsibleBlocks = document.querySelectorAll( '[data-collapsible]' );\n\t\t\tfor ( var i = 0; i < collapsibleBlocks.length; i++ ) {\n\t\t\t\tvar collapsibleBlock = collapsibleBlocks[i];\n\n\t\t\t\t// Maybe initialize the collapsible block\n\t\t\t\tif ( ! CollapsibleBlock.getInstance( collapsibleBlock ) ) {\n\t\t\t\t\tCollapsibleBlock.initializeElement( collapsibleBlock );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t// CHANGE: Reinitialize flyout blocks after checkout update\n\t\tmaybe_reinitialize_flyout_blocks: function() {\n\t\t\t// Bail if flyout blocks are not available\n\t\t\tif ( ! window.FlyoutBlock ) { return; }\n\n\t\t\tFlyoutBlock.initTriggers();\n\t\t},\n\t\t// CHANGE: Update checkout when page gets hidden or visible again\n\t\tmaybe_update_checkout_visibility_change: function() {\n\t\t\tif ( 'hidden' == document.visibilityState || 'visible' == document.visibilityState ) {\n\t\t\t\t$( document.body ).trigger( 'update_checkout' );\n\t\t\t}\n\t\t},\n\t\t// CHANGE: Prompt user that they might lose data when closing tab or leaving the current page after they change some values in the checkout form\n\t\tmaybe_prevent_unload: function( e ) {\n\t\t\t// Ignore some fields\n\t\t\tif ( e && e.target.closest( '.payment_box, input#createaccount' ) ) { return; }\n\n\t\t\tif ( ! _updateBeforeUnload ) {\n\n\t\t\t\tvar preventUnload = function( e ) {\n\t\t\t\t\t// Prompt user if there is unsaved data\n\t\t\t\t\tif ( _updateBeforeUnload ) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.returnValue = '';\n\n\t\t\t\t\t\t// Proceed to update the checkout totals if the user cancel the event\n\t\t\t\t\t\t$( document.body ).trigger( 'update_checkout' );\n\n\t\t\t\t\t\t// Reset flag to update on `beforeunload`\n\t\t\t\t\t\t_updateBeforeUnload = false;\n\t\t\t\t\t\twindow.removeEventListener( 'beforeunload', preventUnload );\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\twindow.addEventListener( 'beforeunload', preventUnload );\n\t\t\t\t_updateBeforeUnload = true;\n\t\t\t}\n\t\t},\n\t\tinit_payment_methods: function() {\n\t\t\tvar $payment_methods = $( '.woocommerce-checkout' ).find( 'input[name=\"payment_method\"]' );\n\n\t\t\t// If there is one method, we can hide the radio input\n\t\t\tif ( 1 === $payment_methods.length ) {\n\t\t\t\t$payment_methods.eq(0).hide();\n\t\t\t}\n\n\t\t\t// If there was a previously selected method, check that one.\n\t\t\tif ( wc_checkout_form.selectedPaymentMethod ) {\n\t\t\t\t$( '#' + wc_checkout_form.selectedPaymentMethod ).prop( 'checked', true );\n\t\t\t}\n\n\t\t\t// If there are none selected, select the first.\n\t\t\tif ( 0 === $payment_methods.filter( ':checked' ).length ) {\n\t\t\t\t$payment_methods.eq(0).prop( 'checked', true );\n\t\t\t}\n\n\t\t\t// Get name of new selected method.\n\t\t\tvar checkedPaymentMethod = $payment_methods.filter( ':checked' ).eq(0).prop( 'id' );\n\n\t\t\tif ( $payment_methods.length > 1 ) {\n\t\t\t\t// Hide open descriptions.\n\t\t\t\t$( 'div.payment_box:not(\".' + checkedPaymentMethod + '\")' ).filter( ':visible' ).slideUp( 0 );\n\t\t\t}\n\n\t\t\t// Trigger click event for selected method\n\t\t\t$payment_methods.filter( ':checked' ).eq(0).trigger( 'click' );\n\t\t},\n\t\tget_payment_method: function() {\n\t\t\treturn wc_checkout_form.$checkout_form.find( 'input[name=\"payment_method\"]:checked' ).val();\n\t\t},\n\t\tpayment_method_selected: function( e ) {\n\t\t\te.stopPropagation();\n\n\t\t\tif ( $( '.payment_methods input.input-radio' ).length > 1 ) {\n\t\t\t\tvar target_payment_box = $( 'div.payment_box.' + $( this ).attr( 'ID' ) ),\n\t\t\t\t\tis_checked         = $( this ).is( ':checked' );\n\n\t\t\t\tif ( is_checked && ! target_payment_box.is( ':visible' ) ) {\n\t\t\t\t\t$( 'div.payment_box' ).filter( ':visible' ).slideUp( 230 );\n\n\t\t\t\t\tif ( is_checked ) {\n\t\t\t\t\t\ttarget_payment_box.slideDown( 230 );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t$( 'div.payment_box' ).show();\n\t\t\t}\n\n\t\t\tif ( $( this ).data( 'order_button_text' ) ) {\n\t\t\t\t// CHANGE: replaced the place order button css selector with an extended custom selector\n\t\t\t\t$( _settings.checkoutPlaceOrderSelector ).text( $( this ).data( 'order_button_text' ) );\n\t\t\t} else {\n\t\t\t\t// CHANGE: replaced the place order button css selector with an extended custom selector\n\t\t\t\t$( _settings.checkoutPlaceOrderSelector ).text( $( _settings.checkoutPlaceOrderSelector ).data( 'value' ) );\n\t\t\t}\n\n\t\t\tvar selectedPaymentMethod = $( '.woocommerce-checkout input[name=\"payment_method\"]:checked' ).attr( 'id' );\n\n\t\t\tif ( selectedPaymentMethod !== wc_checkout_form.selectedPaymentMethod ) {\n\t\t\t\t$( document.body ).trigger( 'payment_method_selected' );\n\t\t\t}\n\n\t\t\t// CHANGE: Add body class for selected payment method\n\t\t\tdocument.body.classList.remove( 'has-payment-method-selected--' + wc_checkout_form.selectedPaymentMethod );\n\t\t\tdocument.body.classList.add( 'has-payment-method-selected--' + selectedPaymentMethod );\n\n\t\t\twc_checkout_form.selectedPaymentMethod = selectedPaymentMethod;\n\t\t},\n\t\t// CHANGE: Add `e` parameter needed for checking target element\n\t\ttoggle_create_account: function( e ) {\n\t\t\t// CHANGE: Use collapsible block instead of jQuery to show/hide accoung fields section\n\t\t\t// Bail if not target element\n\t\t\tif ( ! e.target || ! e.target.matches( 'input#createaccount' ) ) { return; }\n\n\t\t\t// Bail if collapsible block not available\n\t\t\tif ( ! window.CollapsibleBlock ) { return; }\n\n\t\t\tvar checkbox = document.querySelector( 'input#createaccount' );\n\t\t\tvar createAccountBlock = document.querySelector( 'div.create-account' );\n\n\t\t\t// Toggle state\n\t\t\tif ( checkbox.checked ) {\n\t\t\t\tCollapsibleBlock.expand( createAccountBlock );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tCollapsibleBlock.collapse( createAccountBlock );\n\t\t\t}\n\t\t\t// CHANGE: END - Use collapsible block instead of jQuery to show/hide accoung fields section\n\t\t},\n\t\t// CHANGE: Add function to copy email field value to the login form username field\n\t\tmaybe_copy_email_to_login_form: function( e ) {\n\t\t\t// CHANGE: Use collapsible block instead of jQuery to show/hide accoung fields section\n\t\t\t// Bail if not target element\n\t\t\tif ( ! e.target || ! e.target.closest( _settings.loginButtonSelector ) ) { return; }\n\n\t\t\tvar billingEmailField = document.querySelector( _settings.emailFieldSelector );\n\t\t\tvar usernameField = document.querySelector( _settings.usernameFieldSelector );\n\t\t\t\n\t\t\t// Maybe copy email to username field\n\t\t\tif ( billingEmailField && usernameField ) {\n\t\t\t\tusernameField.value = billingEmailField.value;\n\t\t\t}\n\t\t},\n\t\t// CHANGE: END - Add function to copy email field value to the login form username field\n\t\tinit_checkout: function() {\n\t\t\t$( document.body ).trigger( 'update_checkout' );\n\t\t},\n\t\tmaybe_input_changed: function( e ) {\n\t\t\tif ( wc_checkout_form.dirtyInput ) {\n\t\t\t\twc_checkout_form.input_changed( e );\n\t\t\t}\n\t\t},\n\t\t// CHANGE: Add function to set the autocomplete attribute values form data attributes. This fixes issue with lost user data when refreshing the page while using the Firefox Browser.\n\t\tset_autocomplete_attribute_from_data: function( e ) {\n\t\t\tvar $fields = $( 'form.checkout' ).find( 'input, select, textarea' );\n\t\t\t$fields.each( function() {\n\t\t\t\tif ( $( this ).attr( 'data-autocomplete' ) ) {\n\t\t\t\t\t$( this ).attr( 'autocomplete', $( this ).attr( 'data-autocomplete' ) );\n\t\t\t\t}\n\t\t\t} );\n\t\t},\n\t\t// CHANGE: Add function to sync the terms checkbox state\n\t\tterms_checked_changed: function( e ) {\n\t\t\tvar termsCheckBoxChecked = $( e.target ).prop( 'checked' );\n\t\t\t$( _settings.checkoutTermsSelector ).prop( 'checked', termsCheckBoxChecked );\n\t\t},\n\t\t// CHANGE: Maybe add loading class to the form row\n\t\tmaybe_set_form_row_loading: function( e ) {\n\t\t\tif ( e.target && e.target.matches( _settings.checkoutLoadingInputSelector ) ) {\n\t\t\t\tvar formRow = e.target.closest( _settings.formRowSelector );\n\t\t\t\tif ( formRow ) {\n\t\t\t\t\tformRow.classList.add( _settings.loadingClass );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t// CHANGE: END - Maybe add loading class to the form row\n\t\tinput_changed: function( e ) {\n\t\t\twc_checkout_form.dirtyInput = e.target;\n\t\t\twc_checkout_form.maybe_update_checkout();\n\t\t\twc_checkout_form.maybe_set_form_row_loading( e );\n\t\t},\n\t\tqueue_update_checkout: function( e ) {\n\t\t\tvar code = e.keyCode || e.which || 0;\n\n\t\t\t// CHANGE: Also skip `update_checkout` when pressing other controls keys such as \"Shift\", \"Control\", \"Command\", \"Alt\" and \"Arrows\"\n\t\t\tif ( code === 9 || code === 16 || code === 17 || code === 18 || code === 91 || code === 92 || code === 37 || code === 38 || code === 39 || code === 40 ) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\twc_checkout_form.dirtyInput = this;\n\t\t\twc_checkout_form.reset_update_checkout_timer();\n\t\t\twc_checkout_form.updateTimer = setTimeout( wc_checkout_form.maybe_update_checkout, '1000' );\n\t\t\twc_checkout_form.maybe_set_form_row_loading( e );\n\t\t},\n\t\ttrigger_update_checkout: function() {\n\t\t\twc_checkout_form.reset_update_checkout_timer();\n\t\t\twc_checkout_form.dirtyInput = false;\n\t\t\t$( document.body ).trigger( 'update_checkout' );\n\t\t},\n\t\tmaybe_update_checkout: function() {\n\t\t\tvar update_totals = true;\n\n\t\t\tif ( $( wc_checkout_form.dirtyInput ).length ) {\n\t\t\t\tvar $required_inputs = $( wc_checkout_form.dirtyInput ).closest( 'div' ).find( '.address-field.validate-required' );\n\n\t\t\t\tif ( $required_inputs.length ) {\n\t\t\t\t\t$required_inputs.each( function() {\n\t\t\t\t\t\tif ( $( this ).find( 'input.input-text' ).val() === '' ) {\n\t\t\t\t\t\t\tupdate_totals = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( update_totals ) {\n\t\t\t\twc_checkout_form.trigger_update_checkout();\n\t\t\t}\n\t\t},\n\t\t// CHANGE: Removed shipping to different address checkout `change` listener handler function\n\t\treset_update_checkout_timer: function() {\n\t\t\tclearTimeout( wc_checkout_form.updateTimer );\n\t\t},\n\t\tis_valid_json: function( raw_json ) {\n\t\t\ttry {\n\t\t\t\tvar json = JSON.parse( raw_json );\n\n\t\t\t\treturn ( json && 'object' === typeof json );\n\t\t\t} catch ( e ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tvalidate_field: function( e ) {\n\t\t\tvar $this             = $( this ),\n\t\t\t\t$parent           = $this.closest( '.form-row' ),\n\t\t\t\tvalidated         = true,\n\t\t\t\tvalidate_required = $parent.is( '.validate-required' ),\n\t\t\t\tvalidate_email    = $parent.is( '.validate-email' ),\n\t\t\t\tvalidate_phone    = $parent.is( '.validate-phone' ),\n\t\t\t\tpattern           = '',\n\t\t\t\tevent_type        = e.type;\n\n\t\t\tif ( 'input' === event_type ) {\n\t\t\t\t$parent.removeClass( 'woocommerce-invalid woocommerce-invalid-required-field woocommerce-invalid-email woocommerce-invalid-phone woocommerce-validated' ); // eslint-disable-line max-len\n\t\t\t}\n\n\t\t\tif ( 'validate' === event_type || 'change' === event_type ) {\n\n\t\t\t\tif ( validate_required ) {\n\t\t\t\t\tif ( 'checkbox' === $this.attr( 'type' ) && ! $this.is( ':checked' ) ) {\n\t\t\t\t\t\t$parent.removeClass( 'woocommerce-validated' ).addClass( 'woocommerce-invalid woocommerce-invalid-required-field' );\n\t\t\t\t\t\tvalidated = false;\n\t\t\t\t\t} else if ( $this.val() === '' ) {\n\t\t\t\t\t\t$parent.removeClass( 'woocommerce-validated' ).addClass( 'woocommerce-invalid woocommerce-invalid-required-field' );\n\t\t\t\t\t\tvalidated = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( validate_email ) {\n\t\t\t\t\tif ( $this.val() ) {\n\t\t\t\t\t\t/* https://stackoverflow.com/questions/2855865/jquery-validate-e-mail-address-regex */\n\t\t\t\t\t\tpattern = new RegExp( /^([a-z\\d!#$%&'*+\\-\\/=?^_`{|}~\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]+(\\.[a-z\\d!#$%&'*+\\-\\/=?^_`{|}~\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]+)*|\"((([ \\t]*\\r\\n)?[ \\t]+)?([\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f\\x21\\x23-\\x5b\\x5d-\\x7e\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]))*(([ \\t]*\\r\\n)?[ \\t]+)?\")@(([a-z\\d\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]|[a-z\\d\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF][a-z\\d\\-._~\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]*[a-z\\d\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])\\.)+([a-z\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]|[a-z\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF][a-z\\d\\-._~\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]*[0-9a-z\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])\\.?$/i ); // eslint-disable-line max-len\n\n\t\t\t\t\t\tif ( ! pattern.test( $this.val() ) ) {\n\t\t\t\t\t\t\t$parent.removeClass( 'woocommerce-validated' ).addClass( 'woocommerce-invalid woocommerce-invalid-email woocommerce-invalid-phone' ); // eslint-disable-line max-len\n\t\t\t\t\t\t\tvalidated = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( validate_phone ) {\n\t\t\t\t\tpattern = new RegExp( /[\\s\\#0-9_\\-\\+\\/\\(\\)\\.]/g );\n\n\t\t\t\t\tif ( 0 < $this.val().replace( pattern, '' ).length ) {\n\t\t\t\t\t\t$parent.removeClass( 'woocommerce-validated' ).addClass( 'woocommerce-invalid woocommerce-invalid-phone' );\n\t\t\t\t\t\tvalidated = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( validated ) {\n\t\t\t\t\t$parent.removeClass( 'woocommerce-invalid woocommerce-invalid-required-field woocommerce-invalid-email woocommerce-invalid-phone' ).addClass( 'woocommerce-validated' ); // eslint-disable-line max-len\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tupdate_checkout: function( event, args ) {\n\t\t\t// Small timeout to prevent multiple requests when several fields update at the same time\n\t\t\twc_checkout_form.reset_update_checkout_timer();\n\t\t\twc_checkout_form.updateTimer = setTimeout( wc_checkout_form.update_checkout_action, '5', args );\n\t\t},\n\t\t// CHANGE: Add function to re-focus and keep value of the element that was previously focused before submitting an ajax request\n\t\tmaybe_refocus_element: function( currentFocusedElement, currentValue ) {\n\t\t\t// Bail if no element to focus\n\t\t\tif ( null === currentFocusedElement ) { return; }\n\n\t\t\trequestAnimationFrame( function() {\n\t\t\t\tvar elementToFocus;\n\n\t\t\t\t// Try findind the `select2` focusable element\n\t\t\t\tif ( currentFocusedElement.matches( '.fc-select2-field' ) ) {\n\t\t\t\t\telementToFocus = document.querySelector( '.form-row[id=\"' + currentFocusedElement.id + '\"] .select2-selection' );\n\t\t\t\t}\n\t\t\t\t// Try findind the the current focused element after updating updated element by ID\n\t\t\t\telse if ( currentFocusedElement.id ) {\n\t\t\t\t\telementToFocus = document.getElementById( currentFocusedElement.id );\n\t\t\t\t}\n\t\t\t\t// Try findind the updated element by classes\n\t\t\t\telse if ( currentFocusedElement.getAttribute( 'name' ) ) {\n\t\t\t\t\tvar nameAttr = currentFocusedElement.getAttribute( 'name' );\n\t\t\t\t\telementToFocus = document.querySelector( '[name=\"'+nameAttr+'\"]' );\n\t\t\t\t}\n\n\t\t\t\t// Try setting focus if element is found\n\t\t\t\tif ( elementToFocus && elementToFocus !== currentFocusedElement ) {\n\t\t\t\t\telementToFocus.focus();\n\n\t\t\t\t\t// Try to set current value to the focused element\n\t\t\t\t\tif ( null !== currentValue && currentValue !== elementToFocus.value ) {\n\t\t\t\t\t\telementToFocus.value = currentValue;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Set keyboard track position back to that previously to update\n\t\t\t\t\tsetTimeout( function(){\n\t\t\t\t\t\t// Try to set the same track position\n\t\t\t\t\t\tif( null !== elementToFocus.selectionStart && null !== elementToFocus.selectionEnd ) {\n\t\t\t\t\t\t\tif ( currentFocusedElement.selectionStart && currentFocusedElement.selectionEnd ) {\n\t\t\t\t\t\t\t\telementToFocus.selectionStart = currentFocusedElement.selectionStart;\n\t\t\t\t\t\t\t\telementToFocus.selectionEnd = currentFocusedElement.selectionEnd;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// Otherwise try set the track position to the end of the field\n\t\t\t\t\t\t\t// @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/setSelectionRange\n\t\t\t\t\t\t\t// @see https://html.spec.whatwg.org/multipage/input.html#concept-input-apply\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\telementToFocus.selectionStart = elementToFocus.selectionEnd = Number.MAX_SAFE_INTEGER || 10000;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Try to select the entire content of the field\n\t\t\t\t\t\t// @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/select\n\t\t\t\t\t\t// @see https://html.spec.whatwg.org/multipage/input.html#concept-input-apply\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\ttry { elementToFocus.select(); }\n\t\t\t\t\t\t\tcatch { /* Do nothing */ }\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 0 );\n\t\t\t\t}\n\t\t\t} );\n\t\t},\n\t\tupdate_checkout_action: function( args ) {\n\t\t\t// CHANGE: Check flag that allows or block updating the checkout\n\t\t\tif ( ! window.can_update_checkout ) { return; }\n\n\t\t\tif ( wc_checkout_form.controller ) {\n\t\t\t\twc_checkout_form.controller.abort();\n\t\t\t}\n\n\t\t\tvar $form = $( 'form.checkout' );\n\t\t\tif ( $form.length === 0 ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\targs = typeof args !== 'undefined' ? args : {\n\t\t\t\tupdate_shipping_method: true\n\t\t\t};\n\n\t\t\tvar country\t\t\t = $( '#billing_country' ).val(),\n\t\t\t\tstate\t\t\t = $( '#billing_state' ).val(),\n\t\t\t\tpostcode\t\t = $( ':input#billing_postcode' ).val(),\n\t\t\t\tcity\t\t\t = $( '#billing_city' ).val(),\n\t\t\t\taddress\t\t\t = $( ':input#billing_address_1' ).val(),\n\t\t\t\taddress_2\t\t = $( ':input#billing_address_2' ).val(),\n\t\t\t\t// CHANGE: Always get shipping address values from shipping fields\n\t\t\t\ts_country\t\t = $( '#shipping_country' ).val(),\n\t\t\t\ts_state\t\t\t = $( '#shipping_state' ).val(),\n\t\t\t\ts_postcode\t\t = $( ':input#shipping_postcode' ).val(),\n\t\t\t\ts_city\t\t\t = $( '#shipping_city' ).val(),\n\t\t\t\ts_address\t\t = $( ':input#shipping_address_1' ).val(),\n\t\t\t\ts_address_2\t\t = $( ':input#shipping_address_2' ).val(),\n\t\t\t\t// END - CHANGE: Always get shipping address values from shipping fields\n\t\t\t\t$required_inputs = $( wc_checkout_form.$checkout_form ).find( '.address-field.validate-required:visible' ),\n\t\t\t\thas_full_address = true;\n\n\t\t\tif ( $required_inputs.length ) {\n\t\t\t\t$required_inputs.each( function() {\n\t\t\t\t\tif ( $( this ).find( ':input' ).val() === '' ) {\n\t\t\t\t\t\thas_full_address = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// CHANGE: Removed if handling of different shipping address checkbox, always get shipping address values from shipping fields (see above)\n\n\t\t\tvar data = {\n\t\t\t\tsecurity        : wc_checkout_params.update_order_review_nonce,\n\t\t\t\tpayment_method  : wc_checkout_form.get_payment_method(),\n\t\t\t\tcountry         : country,\n\t\t\t\tstate           : state,\n\t\t\t\tpostcode        : postcode,\n\t\t\t\tcity            : city,\n\t\t\t\taddress         : address,\n\t\t\t\taddress_2       : address_2,\n\t\t\t\ts_country       : s_country,\n\t\t\t\ts_state         : s_state,\n\t\t\t\ts_postcode      : s_postcode,\n\t\t\t\ts_city          : s_city,\n\t\t\t\ts_address       : s_address,\n\t\t\t\ts_address_2     : s_address_2,\n\t\t\t\thas_full_address: has_full_address,\n\t\t\t\tpost_data       : new URLSearchParams( new FormData( $form[0] ) ).toString()\n\t\t\t};\n\n\t\t\tif ( false !== args.update_shipping_method ) {\n\t\t\t\tvar shipping_methods = {};\n\n\t\t\t\t// eslint-disable-next-line max-len\n\t\t\t\t$( 'select.shipping_method, input[name^=\"shipping_method\"][type=\"radio\"]:checked, input[name^=\"shipping_method\"][type=\"hidden\"]' ).each( function() {\n\t\t\t\t\tshipping_methods[ $( this ).data( 'index' ) ] = $( this ).val();\n\t\t\t\t} );\n\n\t\t\t\t// Flatten shipping_methods for use in URLSearchParams()\n\t\t\t\tfor ( var k in shipping_methods ) {\n\t\t\t\t\tdata[ 'shipping_method[' + k + ']' ] = shipping_methods[ k ];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// CHANGE: Also block the shipping methods section when updating\n\t\t\t$( '.woocommerce-checkout-payment, .woocommerce-checkout-review-order-table .fc-shipping-method__packages' ).block({\n\t\t\t\tmessage: null,\n\t\t\t\toverlayCSS: {\n\t\t\t\t\tbackground: '#fff',\n\t\t\t\t\topacity: 0.6\n\t\t\t\t}\n\t\t\t});\n\n\t\t\twc_checkout_form.controller = ajax({\n\t\t\t\ttype:\t\t'POST',\n\t\t\t\turl:\t\twc_checkout_params.wc_ajax_url.toString().replace( '%%endpoint%%', 'update_order_review' ),\n\t\t\t\tdata:\t\tnew URLSearchParams( data ).toString(),\n\t\t\t\tsuccess:\tfunction( data ) {\n\n\t\t\t\t\t// Reload the page if requested\n\t\t\t\t\tif ( data && true === data.reload ) {\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Remove any notices added previously\n\t\t\t\t\t$( '.woocommerce-NoticeGroup-updateOrderReview' ).remove();\n\n\t\t\t\t\t// CHANGE: replaced the terms checkbox css selector\n\t\t\t\t\tvar termsCheckBoxChecked = $( _settings.checkoutTermsSelector ).prop( 'checked' );\n\n\t\t\t\t\t// Save payment details to a temporary object\n\t\t\t\t\tvar paymentDetails = {};\n\t\t\t\t\t$( '.payment_box :input' ).each( function() {\n\t\t\t\t\t\tvar ID = $( this ).attr( 'id' );\n\n\t\t\t\t\t\tif ( ID ) {\n\t\t\t\t\t\t\tif ( $.inArray( $( this ).attr( 'type' ), [ 'checkbox', 'radio' ] ) !== -1 ) {\n\t\t\t\t\t\t\t\tpaymentDetails[ ID ] = $( this ).prop( 'checked' );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tpaymentDetails[ ID ] = $( this ).val();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// CHANGE: Get current element with focus, will re-set focus after updating the fragments\n\t\t\t\t\tvar currentFocusedElement = document.activeElement;\n\t\t\t\t\tvar currentValue = document.activeElement.value;\n\n\t\t\t\t\t// Maybe set current element with focus to the form row for `select2` fields\n\t\t\t\t\tvar currentFocusedFormRow = currentFocusedElement.closest( '.fc-select2-field' );\n\t\t\t\t\tif ( currentFocusedFormRow ) {\n\t\t\t\t\t\t// Remove focus from current element as it will be replaced\n\t\t\t\t\t\t// This fixes an issue where `select2` fields would not work properly\n\t\t\t\t\t\t// after checkout is updated while focus is on a `select2` field\n\t\t\t\t\t\tif ( currentFocusedElement ) { currentFocusedElement.blur(); }\n\n\t\t\t\t\t\tcurrentFocusedElement = currentFocusedFormRow;\n\t\t\t\t\t}\n\t\t\t\t\t// CHANGE: END - Get current element with focus, will re-set focus after updating the fragments\n\n\t\t\t\t\t// Always update the fragments\n\t\t\t\t\tif ( data && data.fragments ) {\n\t\t\t\t\t\t// CHANGE: Try to remove select2 components from existing fields before replacing fragments\n\t\t\t\t\t\t$( 'select.country_select, select.state_select' ).each( function() {\n\t\t\t\t\t\t\tvar field = $( this );\n\t\t\t\t\t\t\tif ( field.hasClass( 'select2-hidden-accessible' ) ) { // Field has `select2` initialized\n\t\t\t\t\t\t\t\tif ( typeof field.selectWoo === 'function' ) { field.selectWoo( 'destroy' ); }\n\t\t\t\t\t\t\t\telse if ( typeof field.select2 === 'function' ) { field.select2( 'destroy' ); }\n\t\t\t\t\t\t\t\tfield.off( 'select2:select' );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t\t// CHANGE: END - Try to remove select2 components from existing fields before replacing fragments\n\n\t\t\t\t\t\t// CHANGE: Try to remove intl-tel-input components from existing fields before replacing fragments\n\t\t\t\t\t\tif ( window.intlTelInput && window.intlTelInputGlobals ) {\n\t\t\t\t\t\t\tvar allPhoneFields = document.querySelectorAll( _settings.phoneFieldSelector );\n\t\t\t\t\t\t\tfor ( var i = 0; i < allPhoneFields.length; i++ ) {\n\t\t\t\t\t\t\t\tvar field = allPhoneFields[i];\n\t\t\t\t\t\t\t\tvar phoneField = window.intlTelInputGlobals.getInstance( field );\n\t\t\t\t\t\t\t\tif ( phoneField ) {\n\t\t\t\t\t\t\t\t\tvar preservedValue = phoneField.getNumber();\n\t\t\t\t\t\t\t\t\tphoneField.destroy();\n\t\t\t\t\t\t\t\t\tfield.value = preservedValue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// CHANGE: END - Try to remove intl-tel-input components from existing fields before replacing fragments\n\n\t\t\t\t\t\t$.each( data.fragments, function ( key, value ) {\n\t\t\t\t\t\t\t// CHANGE: Declare local variables needed for some checks before replacing the fragment\n\t\t\t\t\t\t\tvar fragmentToReplace = document.querySelector( key );\n\t\t\t\t\t\t\tvar replaceFragment = true;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// CHANGE: Maybe set to skip fragment with the focus within it. This avoids unexpected closing of mobile keyboard and lost of focus when updating fragments.\n\t\t\t\t\t\t\tif ( fragmentToReplace && currentFocusedElement.closest( key ) && currentFocusedElement.closest( _settings.focusedFieldSkipFragmentReplaceSelector ) ) {\n\t\t\t\t\t\t\t\treplaceFragment = false;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// CHANGE: Allow fragments to be replaced every time even when their contents are equal the existing elements in the DOM\n\t\t\t\t\t\t\tif ( value && -1 !== value.toString().indexOf( 'fc-fragment-always-replace' ) ) {\n\t\t\t\t\t\t\t\treplaceFragment = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif ( replaceFragment && ( ! wc_checkout_form.fragments || wc_checkout_form.fragments[ key ] !== value ) ) {\n\t\t\t\t\t\t\t\t$( key ).replaceWith( value );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t$( key ).unblock();\n\t\t\t\t\t\t} );\n\t\t\t\t\t\twc_checkout_form.fragments = data.fragments;\n\t\t\t\t\t}\n\n\t\t\t\t\t// CHANGE: Re-set focus to the element with focus previously to updating fragments\n\t\t\t\t\twc_checkout_form.maybe_refocus_element( currentFocusedElement, currentValue );\n\n\t\t\t\t\t// Recheck the terms and conditions box, if needed\n\t\t\t\t\tif ( termsCheckBoxChecked ) {\n\t\t\t\t\t\t// CHANGE: replaced the terms checkbox css selector\n\t\t\t\t\t\t$( _settings.checkoutTermsSelector ).prop( 'checked', true );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Fill in the payment details if possible without overwriting data if set.\n\t\t\t\t\tif ( ! $.isEmptyObject( paymentDetails ) ) {\n\t\t\t\t\t\t$( '.payment_box :input' ).each( function() {\n\t\t\t\t\t\t\tvar ID = $( this ).attr( 'id' );\n\t\t\t\t\t\t\tif ( ID ) {\n\t\t\t\t\t\t\t\tif ( $.inArray( $( this ).attr( 'type' ), [ 'checkbox', 'radio' ] ) !== -1 ) {\n\t\t\t\t\t\t\t\t\t$( this ).prop( 'checked', paymentDetails[ ID ] ).trigger( 'change' );\n\t\t\t\t\t\t\t\t} else if ( $.inArray( $( this ).attr( 'type' ), [ 'select' ] ) !== -1 ) {\n\t\t\t\t\t\t\t\t\t$( this ).val( paymentDetails[ ID ] ).trigger( 'change' );\n\t\t\t\t\t\t\t\t} else if ( null !== $( this ).val() && 0 === $( this ).val().length ) {\n\t\t\t\t\t\t\t\t\t$( this ).val( paymentDetails[ ID ] ).trigger( 'change' );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// Check for error\n\t\t\t\t\tif ( data && 'failure' === data.result ) {\n\n\t\t\t\t\t\t// Remove notices from all sources\n\t\t\t\t\t\t$( '.woocommerce-error, .woocommerce-message' ).remove();\n\n\t\t\t\t\t\t// Add new errors returned by this event\n\t\t\t\t\t\tif ( data.messages ) {\n\t\t\t\t\t\t\t$form.prepend( '<div class=\"woocommerce-NoticeGroup woocommerce-NoticeGroup-updateOrderReview\">' + data.messages + '</div>' ); // eslint-disable-line max-len\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$form.prepend( data );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Lose focus for all fields\n\t\t\t\t\t\t$form.find( '.input-text, select, input:checkbox' ).trigger( 'validate' ).trigger( 'blur' );\n\n\t\t\t\t\t\twc_checkout_form.scroll_to_notices();\n\t\t\t\t\t}\n\n\t\t\t\t\t// Re-init methods\n\t\t\t\t\twc_checkout_form.init_payment_methods();\n\n\t\t\t\t\t// CHANGE: Set to not prompt user before leaving the page\n\t\t\t\t\t_updateBeforeUnload = false;\n\n\t\t\t\t\t// Fire updated_checkout event.\n\t\t\t\t\t$( document.body ).trigger( 'updated_checkout', [ data ] );\n\t\t\t\t},\n\t\t\t\t// CHANGE: Maybe remove loading class from form rows when completing the ajax request\n\t\t\t\tcomplete: function() {\n\t\t\t\t\tvar maybeLoadingFields = document.querySelectorAll( _settings.checkoutLoadingInputSelector );\n\t\t\t\t\tfor ( var i = 0; i < maybeLoadingFields.length; i++ ) {\n\t\t\t\t\t\tvar input = maybeLoadingFields[ i ];\n\t\t\t\t\t\tvar formRow = input.closest( _settings.formRowSelector );\n\t\t\t\t\t\tif ( formRow ) {\n\t\t\t\t\t\t\tformRow.classList.remove( _settings.loadingClass );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// CHANGE: END - Maybe remove loading class from form rows when completing the ajax request\n\n\t\t\t});\n\t\t},\n\t\thandleUnloadEvent: function( e ) {\n\t\t\t// Modern browsers have their own standard generic messages that they will display.\n\t\t\t// Confirm, alert, prompt or custom message are not allowed during the unload event\n\t\t\t// Browsers will display their own standard messages\n\n\t\t\t// Check if the browser is Internet Explorer\n\t\t\tif((navigator.userAgent.indexOf('MSIE') !== -1 ) || (!!document.documentMode)) {\n\t\t\t\t// IE handles unload events differently than modern browsers\n\t\t\t\te.preventDefault();\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tattachUnloadEventsOnSubmit: function() {\n\t\t\t$( window ).on('beforeunload', this.handleUnloadEvent);\n\t\t},\n\t\tdetachUnloadEventsOnSubmit: function() {\n\t\t\t$( window ).off('beforeunload', this.handleUnloadEvent);\n\t\t},\n\t\tblockOnSubmit: function( $form ) {\n\t\t\tvar isBlocked = $form.data( 'blockUI.isBlocked' );\n\n\t\t\tif ( 1 !== isBlocked ) {\n\t\t\t\t$form.block({\n\t\t\t\t\tmessage: null,\n\t\t\t\t\toverlayCSS: {\n\t\t\t\t\t\tbackground: '#fff',\n\t\t\t\t\t\topacity: 0.6\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tsubmitOrder: function() {\n\t\t\twc_checkout_form.blockOnSubmit( $( this ) );\n\t\t},\n\t\tsubmit: function() {\n\t\t\twc_checkout_form.reset_update_checkout_timer();\n\t\t\tvar $form = $( this );\n\n\t\t\tif ( $form.is( '.processing' ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// CHANGE: Reset flag to update on `beforeunload`\n\t\t\t_updateBeforeUnload = false;\n\n\t\t\t// Trigger a handler to let gateways manipulate the checkout if needed\n\t\t\t// eslint-disable-next-line max-len\n\t\t\tif ( $form.triggerHandler( 'checkout_place_order' ) !== false && $form.triggerHandler( 'checkout_place_order_' + wc_checkout_form.get_payment_method() ) !== false ) {\n\n\t\t\t\t$form.addClass( 'processing' );\n\n\t\t\t\t// CHANGE: Disable place order button\n\t\t\t\tvar currentFocusedElement = document.activeElement;\n\t\t\t\t$( _settings.checkoutPlaceOrderSelector ).attr( 'disabled', 'disabled' );\n\t\t\t\t$( _settings.checkoutPlaceOrderSelector ).addClass( 'disabled' );\n\t\t\t\tif ( 'yes' === _settings.checkoutPlaceOrderApplyLoadingClass ) {\n\t\t\t\t\t$( _settings.checkoutPlaceOrderSelector ).addClass( _settings.loadingClass );\n\t\t\t\t}\n\t\t\t\t// END - Disable place order button\n\n\t\t\t\t// CHANGE: Block checkout update requests\n\t\t\t\twindow.can_update_checkout = false;\n\n\t\t\t\twc_checkout_form.blockOnSubmit( $form );\n\n\t\t\t\t// Attach event to block reloading the page when the form has been submitted\n\t\t\t\twc_checkout_form.attachUnloadEventsOnSubmit();\n\n\t\t\t\t// ajax.dataFilter affects all ajax() calls, but we use it to ensure JSON is valid once returned.\n\t\t\t\tajax.dataFilter = function( raw_response, dataType ) {\n\t\t\t\t\t// We only want to work with JSON\n\t\t\t\t\tif ( 'json' !== dataType ) {\n\t\t\t\t\t\treturn raw_response;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( wc_checkout_form.is_valid_json( raw_response ) ) {\n\t\t\t\t\t\treturn raw_response;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Attempt to fix the malformed JSON\n\t\t\t\t\t\tvar maybe_valid_json = raw_response.match( /{\"result.*}/ );\n\n\t\t\t\t\t\tif ( null === maybe_valid_json ) {\n\t\t\t\t\t\t\tconsole.log( 'Unable to fix malformed JSON' );\n\t\t\t\t\t\t} else if ( wc_checkout_form.is_valid_json( maybe_valid_json[0] ) ) {\n\t\t\t\t\t\t\tconsole.log( 'Fixed malformed JSON. Original:' );\n\t\t\t\t\t\t\tconsole.log( raw_response );\n\t\t\t\t\t\t\traw_response = maybe_valid_json[0];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconsole.log( 'Unable to fix malformed JSON' );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn raw_response;\n\t\t\t\t};\n\n\t\t\t\tajax({\n\t\t\t\t\ttype:\t\t'POST',\n\t\t\t\t\turl:\t\twc_checkout_params.checkout_url,\n\t\t\t\t\tdata:\t\tnew URLSearchParams( new FormData( $form[0] ) ).toString(),\n\t\t\t\t\tdataType:   'json',\n\t\t\t\t\tsuccess:\tfunction( result ) {\n\t\t\t\t\t\t// Detach the unload handler that prevents a reload / redirect\n\t\t\t\t\t\twc_checkout_form.detachUnloadEventsOnSubmit();\n\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif ( 'success' === result.result && $form.triggerHandler( 'checkout_place_order_success', result ) !== false ) {\n\t\t\t\t\t\t\t\tif ( -1 === result.redirect.indexOf( 'https://' ) || -1 === result.redirect.indexOf( 'http://' ) ) {\n\t\t\t\t\t\t\t\t\twindow.location = result.redirect;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\twindow.location = decodeURI( result.redirect );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if ( 'failure' === result.result ) {\n\t\t\t\t\t\t\t\tthrow 'Result failure';\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthrow 'Invalid response';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch( err ) {\n\t\t\t\t\t\t\t// Reload page\n\t\t\t\t\t\t\tif ( true === result.reload ) {\n\t\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// CHANGE: Block checkout update requests\n\t\t\t\t\t\t\twindow.can_update_checkout = true;\n\n\t\t\t\t\t\t\t// CHANGE: Unblock the place order button\n\t\t\t\t\t\t\tif ( 'yes' === _settings.checkoutPlaceOrderApplyLoadingClass ) {\n\t\t\t\t\t\t\t\t$( _settings.checkoutPlaceOrderSelector ).removeClass( _settings.loadingClass );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t$( _settings.checkoutPlaceOrderSelector ).removeAttr( 'disabled' );\n\t\t\t\t\t\t\t$( _settings.checkoutPlaceOrderSelector ).removeClass( 'disabled' );\n\t\t\t\t\t\t\twc_checkout_form.maybe_refocus_element( currentFocusedElement );\n\t\t\t\t\t\t\t// END - Unblock the place order button\n\n\t\t\t\t\t\t\t// Trigger update in case we need a fresh nonce\n\t\t\t\t\t\t\tif ( true === result.refresh ) {\n\t\t\t\t\t\t\t\t$( document.body ).trigger( 'update_checkout' );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Add new errors\n\t\t\t\t\t\t\tif ( result.messages ) {\n\t\t\t\t\t\t\t\twc_checkout_form.submit_error( result.messages );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\twc_checkout_form.submit_error( '<div class=\"woocommerce-error\">' + wc_checkout_params.i18n_checkout_error + '</div>' ); // eslint-disable-line max-len\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\terror:\tfunction( responseText, textStatus, errorThrown ) {\n\t\t\t\t\t\t// Detach the unload handler that prevents a reload / redirect\n\t\t\t\t\t\twc_checkout_form.detachUnloadEventsOnSubmit();\n\n\t\t\t\t\t\twc_checkout_form.submit_error(\n\t\t\t\t\t\t\t'<div class=\"woocommerce-error\">' +\n\t\t\t\t\t\t\t( errorThrown || wc_checkout_params.i18n_checkout_error ) +\n\t\t\t\t\t\t\t'</div>'\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\tsubmit_error: function( error_message ) {\n\t\t\t$( '.woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message' ).remove();\n\t\t\twc_checkout_form.$checkout_form.prepend( '<div class=\"woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout\">' + error_message + '</div>' ); // eslint-disable-line max-len\n\t\t\twc_checkout_form.$checkout_form.removeClass( 'processing' ).unblock();\n\t\t\t// CHANGE: Unblock the place order button\n\t\t\t$( _settings.checkoutPlaceOrderSelector ).removeAttr( 'disabled' );\n\t\t\t$( _settings.checkoutPlaceOrderSelector ).removeClass( 'disabled' );\n\t\t\t// END - Unblock the place order button\n\t\t\twc_checkout_form.$checkout_form.find( '.input-text, select, input:checkbox' ).trigger( 'validate' ).trigger( 'blur' );\n\t\t\twc_checkout_form.scroll_to_notices();\n\t\t\t$( document.body ).trigger( 'checkout_error' , [ error_message ] );\n\t\t},\n\t\tscroll_to_notices: function() {\n\t\t\tvar scrollElement           = $( '.woocommerce-NoticeGroup-updateOrderReview, .woocommerce-NoticeGroup-checkout' );\n\n\t\t\tif ( ! scrollElement.length ) {\n\t\t\t\tscrollElement = $( 'form.checkout' );\n\t\t\t}\n\t\t\t$.scroll_to_notices( scrollElement );\n\t\t}\n\t};\n\n\tvar wc_checkout_coupons = {\n\t\tinit: function() {\n\t\t\t$( document.body ).on( 'click', 'a.showcoupon', this.show_coupon_form );\n\t\t\t$( document.body ).on( 'click', '.woocommerce-remove-coupon', this.remove_coupon );\n\t\t\t$( 'form.checkout_coupon' ).hide().on( 'submit', this.submit );\n\t\t},\n\t\tshow_coupon_form: function() {\n\t\t\t$( '.checkout_coupon' ).slideToggle( 400, function() {\n\t\t\t\t$( '.checkout_coupon' ).find( ':input:eq(0)' ).trigger( 'focus' );\n\t\t\t});\n\t\t\treturn false;\n\t\t},\n\t\tsubmit: function() {\n\t\t\tvar $form = $( this );\n\n\t\t\tif ( $form.is( '.processing' ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t$form.addClass( 'processing' ).block({\n\t\t\t\tmessage: null,\n\t\t\t\toverlayCSS: {\n\t\t\t\t\tbackground: '#fff',\n\t\t\t\t\topacity: 0.6\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tvar data = {\n\t\t\t\tsecurity:\t\twc_checkout_params.apply_coupon_nonce,\n\t\t\t\tcoupon_code:\t$form.find( 'input[name=\"coupon_code\"]' ).val()\n\t\t\t};\n\n\t\t\tajax({\n\t\t\t\ttype:\t\t'POST',\n\t\t\t\turl:\t\twc_checkout_params.wc_ajax_url.toString().replace( '%%endpoint%%', 'apply_coupon' ),\n\t\t\t\tdata:\t\tnew URLSearchParams( data ).toString(),\n\t\t\t\tsuccess:\tfunction( code ) {\n\t\t\t\t\t$( '.woocommerce-error, .woocommerce-message' ).remove();\n\t\t\t\t\t$form.removeClass( 'processing' ).unblock();\n\n\t\t\t\t\tif ( code ) {\n\t\t\t\t\t\t$form.before( code );\n\t\t\t\t\t\t$form.slideUp();\n\n\t\t\t\t\t\t$( document.body ).trigger( 'applied_coupon_in_checkout', [ data.coupon_code ] );\n\t\t\t\t\t\t$( document.body ).trigger( 'update_checkout', { update_shipping_method: false } );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdataType: 'html'\n\t\t\t});\n\n\t\t\treturn false;\n\t\t},\n\t\tremove_coupon: function( e ) {\n\t\t\t// CHANGE: Bail when Fluid Checkout integrated coupon code feature is enabled\n\t\t\tif ( _settings.checkoutCoupons && 'yes' === _settings.checkoutCoupons.isEnabled ) { return; }\n\n\t\t\te.preventDefault();\n\n\t\t\tvar container = $( this ).parents( '.woocommerce-checkout-review-order' ),\n\t\t\t\tcoupon    = $( this ).data( 'coupon' );\n\n\t\t\tcontainer.addClass( 'processing' ).block({\n\t\t\t\tmessage: null,\n\t\t\t\toverlayCSS: {\n\t\t\t\t\tbackground: '#fff',\n\t\t\t\t\topacity: 0.6\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tvar data = {\n\t\t\t\tsecurity: wc_checkout_params.remove_coupon_nonce,\n\t\t\t\tcoupon:   coupon\n\t\t\t};\n\n\t\t\tajax({\n\t\t\t\ttype:    'POST',\n\t\t\t\turl:     wc_checkout_params.wc_ajax_url.toString().replace( '%%endpoint%%', 'remove_coupon' ),\n\t\t\t\tdata:    new URLSearchParams( data ).toString(),\n\t\t\t\tsuccess: function( code ) {\n\t\t\t\t\t$( '.woocommerce-error, .woocommerce-message' ).remove();\n\t\t\t\t\tcontainer.removeClass( 'processing' ).unblock();\n\n\t\t\t\t\tif ( code ) {\n\t\t\t\t\t\t$( 'form.woocommerce-checkout' ).before( code );\n\n\t\t\t\t\t\t$( document.body ).trigger( 'removed_coupon_in_checkout', [ data.coupon ] );\n\t\t\t\t\t\t$( document.body ).trigger( 'update_checkout', { update_shipping_method: false } );\n\n\t\t\t\t\t\t// Remove coupon code from coupon field\n\t\t\t\t\t\t$( 'form.checkout_coupon' ).find( 'input[name=\"coupon_code\"]' ).val( '' );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\terror: function ( responseText ) {\n\t\t\t\t\tif ( wc_checkout_params.debug_mode ) {\n\t\t\t\t\t\t/* jshint devel: true */\n\t\t\t\t\t\tconsole.log( responseText );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdataType: 'html'\n\t\t\t});\n\t\t}\n\t};\n\n\tvar wc_checkout_login_form = {\n\t\tinit: function() {\n\t\t\t$( document.body ).on( 'click', 'a.showlogin', this.show_login_form );\n\t\t},\n\t\tshow_login_form: function() {\n\t\t\t$( 'form.login, form.woocommerce-form--login' ).slideToggle();\n\t\t\treturn false;\n\t\t}\n\t};\n\n\tvar wc_terms_toggle = {\n\t\tinit: function() {\n\t\t\t$( document.body ).on( 'click', 'a.woocommerce-terms-and-conditions-link', this.toggle_terms );\n\t\t},\n\n\t\ttoggle_terms: function() {\n\t\t\tif ( $( '.woocommerce-terms-and-conditions' ).length ) {\n\t\t\t\t$( '.woocommerce-terms-and-conditions' ).slideToggle( function() {\n\t\t\t\t\tvar link_toggle = $( '.woocommerce-terms-and-conditions-link' );\n\n\t\t\t\t\tif ( $( '.woocommerce-terms-and-conditions' ).is( ':visible' ) ) {\n\t\t\t\t\t\tlink_toggle.addClass( 'woocommerce-terms-and-conditions-link--open' );\n\t\t\t\t\t\tlink_toggle.removeClass( 'woocommerce-terms-and-conditions-link--closed' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlink_toggle.removeClass( 'woocommerce-terms-and-conditions-link--open' );\n\t\t\t\t\t\tlink_toggle.addClass( 'woocommerce-terms-and-conditions-link--closed' );\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t};\n\n\twc_checkout_form.init();\n\twc_checkout_coupons.init();\n\twc_checkout_login_form.init();\n\twc_terms_toggle.init();\n});\n"],"names":["jQuery","$","wc_checkout_params","extend","extended","deep","i","Object","prototype","toString","call","arguments","length","prop","obj","hasOwnProperty","_updateBeforeUnload","window","can_update_checkout","_settings","formRowSelector","checkoutPlaceOrderSelector","checkoutTermsSelector","checkoutUpdateFieldsSelector","checkoutLoadingInputSelector","focusedFieldSkipFragmentReplaceSelector","phoneFieldSelector","loginButtonSelector","emailFieldSelector","usernameFieldSelector","loadingClass","checkoutPlaceOrderApplyLoadingClass","checkoutUpdateBeforeUnload","blockUI","defaults","overlayCSS","cursor","ajax","options","controller","AbortController","fetch","url","method","type","headers","Content-Type","body","data","signal","then","response","text","ok","error","Error","statusText","responseText","dataType","json","JSON","parse","dataFilter","success","catch","message","wc_checkout_form","updateTimer","raw_response","dirtyInput","selectedPaymentMethod","xhr","$order_review","$checkout_form","init","fcSettings","document","on","this","update_checkout","init_checkout","set_autocomplete_attribute_from_data","payment_method_selected","hasClass","submitOrder","attr","submit","validate_field","trigger_update_checkout","input_changed","maybe_input_changed","queue_update_checkout","addEventListener","maybe_update_checkout_visibility_change","maybe_prevent_unload","billing_same_shipping_changed","maybe_reinitialize_collapsible_blocks","maybe_reinitialize_flyout_blocks","terms_checked_changed","init_payment_methods","is_checkout","trigger","option_guest_checkout","toggle_create_account","maybe_copy_email_to_login_form","e","checkbox","fieldsWrapper","CollapsibleBlock","querySelector","checked","collapse","expand","collapsibleBlock","collapsibleBlocks","querySelectorAll","getInstance","initializeElement","FlyoutBlock","initTriggers","visibilityState","preventUnload","target","closest","preventDefault","returnValue","removeEventListener","$payment_methods","find","checkedPaymentMethod","eq","hide","filter","slideUp","get_payment_method","val","stopPropagation","target_payment_box","is_checked","is","slideDown","show","classList","remove","add","createAccountBlock","matches","usernameField","billingEmailField","value","each","termsCheckBoxChecked","maybe_set_form_row_loading","formRow","maybe_update_checkout","code","keyCode","which","reset_update_checkout_timer","setTimeout","$required_inputs","update_totals","clearTimeout","is_valid_json","raw_json","$this","$parent","validated","validate_required","validate_email","validate_phone","pattern","event_type","removeClass","addClass","RegExp","test","replace","event","args","update_checkout_action","maybe_refocus_element","currentFocusedElement","currentValue","requestAnimationFrame","nameAttr","elementToFocus","id","getElementById","getAttribute","focus","selectionStart","selectionEnd","Number","MAX_SAFE_INTEGER","select","abort","$form","update_shipping_method","country","state","postcode","city","address","address_2","s_country","s_state","s_postcode","s_city","s_address","s_address_2","has_full_address","security","update_order_review_nonce","payment_method","post_data","URLSearchParams","FormData","k","shipping_methods","block","background","opacity","wc_ajax_url","reload","location","paymentDetails","ID","inArray","activeElement","currentFocusedFormRow","blur","fragments","field","selectWoo","select2","off","intlTelInput","intlTelInputGlobals","allPhoneFields","preservedValue","phoneField","getNumber","destroy","key","replaceFragment","indexOf","replaceWith","unblock","isEmptyObject","result","messages","prepend","scroll_to_notices","complete","maybeLoadingFields","handleUnloadEvent","navigator","userAgent","documentMode","attachUnloadEventsOnSubmit","detachUnloadEventsOnSubmit","blockOnSubmit","triggerHandler","maybe_valid_json","match","console","log","checkout_url","redirect","decodeURI","err","removeAttr","refresh","submit_error","i18n_checkout_error","textStatus","errorThrown","error_message","scrollElement","wc_checkout_coupons","show_coupon_form","remove_coupon","slideToggle","apply_coupon_nonce","coupon_code","before","container","checkoutCoupons","isEnabled","parents","coupon","remove_coupon_nonce","debug_mode","wc_checkout_login_form","show_login_form","wc_terms_toggle","toggle_terms","link_toggle"],"mappings":"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"}