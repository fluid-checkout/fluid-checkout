{"version":3,"file":"../checkout-230-beta-5.min.js","sources":["checkout-230-beta-5.js"],"sourcesContent":["/**\r\n * Checkout Script\r\n * \r\n * Replaces the original WooCommerce `checkout.js`.\r\n */\r\n\r\n/* global wc_checkout_params */\r\njQuery( function( $ ) {\r\n\r\n\t// wc_checkout_params is required to continue, ensure the object exists\r\n\tif ( typeof wc_checkout_params === 'undefined' ) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// CHANGE: Create flag to allow or block updating the checkout\r\n\twindow.can_update_checkout = true;\r\n\r\n\t$.blockUI.defaults.overlayCSS.cursor = 'default';\r\n\r\n\t// CHANGE: Add flag to up prevent users from leaving the page when there is unsaved data\r\n\tvar _updateBeforeUnload = false;\r\n\r\n\t// CHANGE: Add default settings object\r\n\tvar _settings = {\r\n\t\tcheckoutPlaceOrderSelector: '#place_order, .fc-place-order-button',\r\n\t\tcheckoutTermsSelector: '.fc-terms-checkbox',\r\n\t\tcheckoutUpdateFieldsSelector: '.address-field input.input-text, .update_totals_on_change input.input-text',\r\n\t\tcheckoutUpdateBeforeUnload: 'yes',\r\n\r\n\t\tfocusedFieldSkipFragmentReplaceSelector: 'input[type=\"text\"], input[type=\"color\"], input[type=\"date\"], input[type=\"datetime\"], input[type=\"datetime-local\"], input[type=\"email\"], input[type=\"file\"], input[type=\"image\"], input[type=\"month\"], input[type=\"number\"], input[type=\"password\"], input[type=\"search\"], input[type=\"tel\"], input[type=\"time\"], input[type=\"url\"], input[type=\"week\"], select, textarea, .fc-select2-field',\r\n\r\n\t\tphoneFieldSelector: 'input[type=\"tel\"], [data-phone-field], input.js-phone-field, .js-phone-field input',\r\n\t};\r\n\r\n\t// CHANGE: Add auxiliar function to merge objects\r\n\t/*!\r\n\t* Merge two or more objects together.\r\n\t* (c) 2017 Chris Ferdinandi, MIT License, https://gomakethings.com\r\n\t* @param   {Boolean}  deep     If true, do a deep (or recursive) merge [optional]\r\n\t* @param   {Object}   objects  The objects to merge together\r\n\t* @returns {Object}            Merged values of defaults and options\r\n\t*/\r\n\tvar extend = function () {\r\n\t\t// Variables\r\n\t\tvar extended = {};\r\n\t\tvar deep = false;\r\n\t\tvar i = 0;\r\n\r\n\t\t// Check if a deep merge\r\n\t\tif ( Object.prototype.toString.call( arguments[0] ) === '[object Boolean]' ) {\r\n\t\t\tdeep = arguments[0];\r\n\t\t\ti++;\r\n\t\t}\r\n\r\n\t\t// Merge the object into the extended object\r\n\t\tvar merge = function (obj) {\r\n\t\t\tfor (var prop in obj) {\r\n\t\t\t\tif (obj.hasOwnProperty(prop)) {\r\n\t\t\t\t\t// If property is an object, merge properties\r\n\t\t\t\t\tif (deep && Object.prototype.toString.call(obj[prop]) === '[object Object]') {\r\n\t\t\t\t\t\textended[prop] = extend(extended[prop], obj[prop]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\textended[prop] = obj[prop];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// Loop through each object and conduct a merge\r\n\t\tfor (; i < arguments.length; i++) {\r\n\t\t\tvar obj = arguments[i];\r\n\t\t\tmerge(obj);\r\n\t\t}\r\n\r\n\t\treturn extended;\r\n    };\r\n\r\n\tvar wc_checkout_form = {\r\n\t\tupdateTimer: false,\r\n\t\tdirtyInput: false,\r\n\t\tselectedPaymentMethod: false,\r\n\t\txhr: false,\r\n\t\t$order_review: $( '#order_review' ),\r\n\t\t$checkout_form: $( 'form.checkout' ),\r\n\t\tinit: function() {\r\n\t\t\t// CHANGE: Merge default settings object with values from the server settings object\r\n\t\t\t_settings = extend( true, _settings, window.fcSettings );\r\n\r\n\t\t\t$( document.body ).on( 'update_checkout', this.update_checkout );\r\n\t\t\t$( document.body ).on( 'init_checkout', this.init_checkout );\r\n\r\n\t\t\t// Set autocomplete attributes\r\n\t\t\t$( document.body ).on( 'init_checkout', this.set_autocomplete_attribute_from_data );\r\n\t\t\t$( document.body ).on( 'updated_checkout', this.set_autocomplete_attribute_from_data );\r\n\r\n\t\t\t// Payment methods\r\n\t\t\tthis.$checkout_form.on( 'click', 'input[name=\"payment_method\"]', this.payment_method_selected );\r\n\r\n\t\t\tif ( $( document.body ).hasClass( 'woocommerce-order-pay' ) ) {\r\n\t\t\t\tthis.$order_review.on( 'click', 'input[name=\"payment_method\"]', this.payment_method_selected );\r\n\t\t\t\tthis.$order_review.on( 'submit', this.submitOrder );\r\n\t\t\t\tthis.$order_review.attr( 'novalidate', 'novalidate' );\r\n\t\t\t}\r\n\r\n\t\t\t// Prevent HTML5 validation which can conflict.\r\n\t\t\tthis.$checkout_form.attr( 'novalidate', 'novalidate' );\r\n\r\n\t\t\t// Form submission\r\n\t\t\tthis.$checkout_form.on( 'submit', this.submit );\r\n\r\n\t\t\t// Inline validation\r\n\t\t\tthis.$checkout_form.on( 'input validate change', '.input-text, select, input:checkbox', this.validate_field );\r\n\r\n\t\t\t// Manual trigger\r\n\t\t\tthis.$checkout_form.on( 'update', this.trigger_update_checkout );\r\n\r\n\t\t\t// Inputs/selects which update totals\r\n\t\t\t// CHANGE: Removed selector `#ship-to-different-address input`\r\n\t\t\tthis.$checkout_form.on( 'change', 'select.shipping_method, input[name^=\"shipping_method\"], .update_totals_on_change select, .update_totals_on_change input[type=\"radio\"], .update_totals_on_change input[type=\"checkbox\"]', this.trigger_update_checkout ); // eslint-disable-line max-len\r\n\t\t\tthis.$checkout_form.on( 'change', '.address-field select', this.input_changed );\r\n\r\n\t\t\t// CHANGE: Move CSS selector for fields that trigger update checkout when value is changed\r\n\t\t\tthis.$checkout_form.on( 'change', _settings.checkoutUpdateFieldsSelector, this.maybe_input_changed ); // eslint-disable-line max-len\r\n\t\t\tthis.$checkout_form.on( 'keydown', _settings.checkoutUpdateFieldsSelector, this.queue_update_checkout ); // eslint-disable-line max-len\r\n\r\n\t\t\t// Address fields\r\n\t\t\t// CHANGE: Removed shipping to different address checkout `change` listener\r\n\r\n\t\t\t// CHANGE: Update checkout totals to save data to session when user switches tabs, apps, goes to homescreen, etc.\r\n\t\t\tdocument.addEventListener( 'visibilitychange', this.maybe_update_checkout_visibility_change );\r\n\r\n\t\t\t// CHANGE: Maybe prevent leaving the page if there are unsaved changes, and trigger `update_checkout` to save the data.\r\n\t\t\tif ( 'yes' === _settings.checkoutUpdateBeforeUnload ) {\r\n\t\t\t\tthis.$checkout_form.on( 'change, input', 'select, input, textarea', this.maybe_prevent_unload );\r\n\t\t\t}\r\n\r\n\t\t\t// CHANGE: Update checkout when \"billing same as shipping\" checked state changes\r\n\t\t\tthis.$checkout_form.on( 'change', '#billing_same_as_shipping', this.billing_same_shipping_changed );\r\n\t\t\t$( document.body ).on( 'updated_checkout', this.maybe_reinitialize_collapsible_blocks );\r\n\r\n\t\t\t// CHANGE: Add event listener to sync terms checkbox state\r\n\t\t\tthis.$checkout_form.on( 'change', _settings.checkoutTermsSelector, this.terms_checked_changed );\r\n\r\n\t\t\t// Trigger events\r\n\t\t\t// CHANGE: Removed shipping to different address checkout `change` trigger\r\n\t\t\tthis.init_payment_methods();\r\n\r\n\t\t\t// Update on page load\r\n\t\t\tif ( wc_checkout_params.is_checkout === '1' ) {\r\n\t\t\t\t$( document.body ).trigger( 'init_checkout' );\r\n\t\t\t}\r\n\t\t\tif ( wc_checkout_params.option_guest_checkout === 'yes' ) {\r\n\t\t\t\t$( 'input#createaccount' ).on( 'change', this.toggle_create_account ).trigger( 'change' );\r\n\t\t\t}\r\n\t\t},\r\n\t\t// CHANGE: Update checkout when \"billing same as shipping\" checked state changes\r\n\t\tbilling_same_shipping_changed: function( e ) {\r\n\t\t\tif ( window.CollapsibleBlock ) {\r\n\t\t\t\tvar checkbox = document.querySelector( '#billing_same_as_shipping' );\r\n\t\t\t\tvar fieldsWrapper = document.querySelector( '#woocommerce-billing-fields__field-wrapper' );\r\n\r\n\t\t\t\t// Toggle state\r\n\t\t\t\tif ( ! checkbox.checked ) {\r\n\t\t\t\t\tCollapsibleBlock.expand( fieldsWrapper );\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tCollapsibleBlock.collapse( fieldsWrapper );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t$( document.body ).trigger( 'update_checkout' );\r\n\t\t},\r\n\t\t// CHANGE: Reinitialize billing fields collapsible block after checkout update\r\n\t\tmaybe_reinitialize_collapsible_blocks: function() {\r\n\t\t\tif ( window.CollapsibleBlock ) {\r\n\t\t\t\t// Try to initialize collapsible blocks if not yet initialized\r\n\t\t\t\tCollapsibleBlock.init( window.fcSettings ? fcSettings.collapsibleBlock : null );\r\n\r\n\t\t\t\tvar collapsibleBlocks = document.querySelectorAll( '[data-collapsible]' );\r\n\t\t\t\tfor ( var i = 0; i < collapsibleBlocks.length; i++ ) {\r\n\t\t\t\t\tvar collapsibleBlock = collapsibleBlocks[i];\r\n\r\n\t\t\t\t\t// Maybe initialize the collapsible block\r\n\t\t\t\t\tif ( ! CollapsibleBlock.getInstance( collapsibleBlock ) ) {\r\n\t\t\t\t\t\tCollapsibleBlock.initializeElement( collapsibleBlock );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t// CHANGE: Update checkout when page gets hidden or visible again\r\n\t\tmaybe_update_checkout_visibility_change: function() {\r\n\t\t\tif ( 'hidden' == document.visibilityState || 'visible' == document.visibilityState ) {\r\n\t\t\t\t$( document.body ).trigger( 'update_checkout' );\r\n\t\t\t}\r\n\t\t},\r\n\t\t// CHANGE: Prompt user that they might lose data when closing tab or leaving the current page after they change some values in the checkout form\r\n\t\tmaybe_prevent_unload: function( e ) {\r\n\t\t\t// Ignore some fields\r\n\t\t\tif ( e && e.target.closest( '.payment_box, input#createaccount' ) ) { return; }\r\n\r\n\t\t\tif ( ! _updateBeforeUnload ) {\r\n\r\n\t\t\t\tvar preventUnload = function( e ) {\r\n\t\t\t\t\t// Prompt user if there is unsaved data\r\n\t\t\t\t\tif ( _updateBeforeUnload ) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\te.returnValue = '';\r\n\r\n\t\t\t\t\t\t// Proceed to update the checkout totals if the user cancel the event\r\n\t\t\t\t\t\t$( document.body ).trigger( 'update_checkout' );\r\n\r\n\t\t\t\t\t\t// Reset flag to update on `beforeunload`\r\n\t\t\t\t\t\t_updateBeforeUnload = false;\r\n\t\t\t\t\t\twindow.removeEventListener( 'beforeunload', preventUnload );\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\twindow.addEventListener( 'beforeunload', preventUnload );\r\n\t\t\t\t_updateBeforeUnload = true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tinit_payment_methods: function() {\r\n\t\t\tvar $payment_methods = $( '.woocommerce-checkout' ).find( 'input[name=\"payment_method\"]' );\r\n\r\n\t\t\t// If there is one method, we can hide the radio input\r\n\t\t\tif ( 1 === $payment_methods.length ) {\r\n\t\t\t\t$payment_methods.eq(0).hide();\r\n\t\t\t}\r\n\r\n\t\t\t// If there was a previously selected method, check that one.\r\n\t\t\tif ( wc_checkout_form.selectedPaymentMethod ) {\r\n\t\t\t\t$( '#' + wc_checkout_form.selectedPaymentMethod ).prop( 'checked', true );\r\n\t\t\t}\r\n\r\n\t\t\t// If there are none selected, select the first.\r\n\t\t\tif ( 0 === $payment_methods.filter( ':checked' ).length ) {\r\n\t\t\t\t$payment_methods.eq(0).prop( 'checked', true );\r\n\t\t\t}\r\n\r\n\t\t\t// Get name of new selected method.\r\n\t\t\tvar checkedPaymentMethod = $payment_methods.filter( ':checked' ).eq(0).prop( 'id' );\r\n\r\n\t\t\tif ( $payment_methods.length > 1 ) {\r\n\t\t\t\t// Hide open descriptions.\r\n\t\t\t\t$( 'div.payment_box:not(\".' + checkedPaymentMethod + '\")' ).filter( ':visible' ).slideUp( 0 );\r\n\t\t\t}\r\n\r\n\t\t\t// Trigger click event for selected method\r\n\t\t\t$payment_methods.filter( ':checked' ).eq(0).trigger( 'click' );\r\n\t\t},\r\n\t\tget_payment_method: function() {\r\n\t\t\treturn wc_checkout_form.$checkout_form.find( 'input[name=\"payment_method\"]:checked' ).val();\r\n\t\t},\r\n\t\tpayment_method_selected: function( e ) {\r\n\t\t\te.stopPropagation();\r\n\r\n\t\t\tif ( $( '.payment_methods input.input-radio' ).length > 1 ) {\r\n\t\t\t\tvar target_payment_box = $( 'div.payment_box.' + $( this ).attr( 'ID' ) ),\r\n\t\t\t\t\tis_checked         = $( this ).is( ':checked' );\r\n\r\n\t\t\t\tif ( is_checked && ! target_payment_box.is( ':visible' ) ) {\r\n\t\t\t\t\t$( 'div.payment_box' ).filter( ':visible' ).slideUp( 230 );\r\n\r\n\t\t\t\t\tif ( is_checked ) {\r\n\t\t\t\t\t\ttarget_payment_box.slideDown( 230 );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t$( 'div.payment_box' ).show();\r\n\t\t\t}\r\n\r\n\t\t\tif ( $( this ).data( 'order_button_text' ) ) {\r\n\t\t\t\t// CHANGE: replaced the place order button css selector with an extended custom selector\r\n\t\t\t\t$( _settings.checkoutPlaceOrderSelector ).text( $( this ).data( 'order_button_text' ) );\r\n\t\t\t} else {\r\n\t\t\t\t// CHANGE: replaced the place order button css selector with an extended custom selector\r\n\t\t\t\t$( _settings.checkoutPlaceOrderSelector ).text( $( _settings.checkoutPlaceOrderSelector ).data( 'value' ) );\r\n\t\t\t}\r\n\r\n\t\t\tvar selectedPaymentMethod = $( '.woocommerce-checkout input[name=\"payment_method\"]:checked' ).attr( 'id' );\r\n\r\n\t\t\tif ( selectedPaymentMethod !== wc_checkout_form.selectedPaymentMethod ) {\r\n\t\t\t\t$( document.body ).trigger( 'payment_method_selected' );\r\n\t\t\t}\r\n\r\n\t\t\t// CHANGE: Add body class for selected payment method\r\n\t\t\tdocument.body.classList.remove( 'has-payment-method-selected--' + wc_checkout_form.selectedPaymentMethod );\r\n\t\t\tdocument.body.classList.add( 'has-payment-method-selected--' + selectedPaymentMethod );\r\n\r\n\t\t\twc_checkout_form.selectedPaymentMethod = selectedPaymentMethod;\r\n\t\t},\r\n\t\ttoggle_create_account: function() {\r\n\t\t\t$( 'div.create-account' ).hide();\r\n\r\n\t\t\tif ( $( this ).is( ':checked' ) ) {\r\n\t\t\t\t// Ensure password is not pre-populated.\r\n\t\t\t\t$( '#account_password' ).val( '' ).trigger( 'change' );\r\n\t\t\t\t$( 'div.create-account' ).slideDown();\r\n\t\t\t}\r\n\t\t},\r\n\t\tinit_checkout: function() {\r\n\t\t\t$( document.body ).trigger( 'update_checkout' );\r\n\t\t},\r\n\t\tmaybe_input_changed: function( e ) {\r\n\t\t\tif ( wc_checkout_form.dirtyInput ) {\r\n\t\t\t\twc_checkout_form.input_changed( e );\r\n\t\t\t}\r\n\t\t},\r\n\t\t// CHANGE: Add function to set the autocomplete attribute values form data attributes. This fixes issue with lost user data when refreshing the page while using the Firefox Browser.\r\n\t\tset_autocomplete_attribute_from_data: function( e ) {\r\n\t\t\tvar $fields = $( 'form.checkout' ).find( 'input, select, textarea' );\r\n\t\t\t$fields.each( function() {\r\n\t\t\t\tif ( $( this ).attr( 'data-autocomplete' ) ) {\r\n\t\t\t\t\t$( this ).attr( 'autocomplete', $( this ).attr( 'data-autocomplete' ) );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t},\r\n\t\t// CHANGE: Add function to sync the terms checkbox state\r\n\t\tterms_checked_changed: function( e ) {\r\n\t\t\tvar termsCheckBoxChecked = $( e.target ).prop( 'checked' );\r\n\t\t\t$( _settings.checkoutTermsSelector ).prop( 'checked', termsCheckBoxChecked );\r\n\t\t},\r\n\t\tinput_changed: function( e ) {\r\n\t\t\twc_checkout_form.dirtyInput = e.target;\r\n\t\t\twc_checkout_form.maybe_update_checkout();\r\n\t\t},\r\n\t\tqueue_update_checkout: function( e ) {\r\n\t\t\tvar code = e.keyCode || e.which || 0;\r\n\r\n\t\t\t// CHANGE: Also skip `update_checkout` when pressing other controls keys such as \"Shift\", \"Control\", \"Command\", \"Alt\" and \"Arrows\"\r\n\t\t\tif ( code === 9 || code === 16 || code === 17 || code === 18 || code === 91 || code === 92 || code === 37 || code === 38 || code === 39 || code === 40 ) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\twc_checkout_form.dirtyInput = this;\r\n\t\t\twc_checkout_form.reset_update_checkout_timer();\r\n\t\t\twc_checkout_form.updateTimer = setTimeout( wc_checkout_form.maybe_update_checkout, '1000' );\r\n\t\t},\r\n\t\ttrigger_update_checkout: function() {\r\n\t\t\twc_checkout_form.reset_update_checkout_timer();\r\n\t\t\twc_checkout_form.dirtyInput = false;\r\n\t\t\t$( document.body ).trigger( 'update_checkout' );\r\n\t\t},\r\n\t\tmaybe_update_checkout: function() {\r\n\t\t\tvar update_totals = true;\r\n\r\n\t\t\tif ( $( wc_checkout_form.dirtyInput ).length ) {\r\n\t\t\t\tvar $required_inputs = $( wc_checkout_form.dirtyInput ).closest( 'div' ).find( '.address-field.validate-required' );\r\n\r\n\t\t\t\tif ( $required_inputs.length ) {\r\n\t\t\t\t\t$required_inputs.each( function() {\r\n\t\t\t\t\t\tif ( $( this ).find( 'input.input-text' ).val() === '' ) {\r\n\t\t\t\t\t\t\tupdate_totals = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif ( update_totals ) {\r\n\t\t\t\twc_checkout_form.trigger_update_checkout();\r\n\t\t\t}\r\n\t\t},\r\n\t\t// CHANGE: Removed shipping to different address checkout `change` listener handler function\r\n\t\treset_update_checkout_timer: function() {\r\n\t\t\tclearTimeout( wc_checkout_form.updateTimer );\r\n\t\t},\r\n\t\tis_valid_json: function( raw_json ) {\r\n\t\t\ttry {\r\n\t\t\t\tvar json = JSON.parse( raw_json );\r\n\r\n\t\t\t\treturn ( json && 'object' === typeof json );\r\n\t\t\t} catch ( e ) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tvalidate_field: function( e ) {\r\n\t\t\tvar $this             = $( this ),\r\n\t\t\t\t$parent           = $this.closest( '.form-row' ),\r\n\t\t\t\tvalidated         = true,\r\n\t\t\t\tvalidate_required = $parent.is( '.validate-required' ),\r\n\t\t\t\tvalidate_email    = $parent.is( '.validate-email' ),\r\n\t\t\t\tvalidate_phone    = $parent.is( '.validate-phone' ),\r\n\t\t\t\tpattern           = '',\r\n\t\t\t\tevent_type        = e.type;\r\n\r\n\t\t\tif ( 'input' === event_type ) {\r\n\t\t\t\t$parent.removeClass( 'woocommerce-invalid woocommerce-invalid-required-field woocommerce-invalid-email woocommerce-invalid-phone woocommerce-validated' ); // eslint-disable-line max-len\r\n\t\t\t}\r\n\r\n\t\t\tif ( 'validate' === event_type || 'change' === event_type ) {\r\n\r\n\t\t\t\tif ( validate_required ) {\r\n\t\t\t\t\tif ( 'checkbox' === $this.attr( 'type' ) && ! $this.is( ':checked' ) ) {\r\n\t\t\t\t\t\t$parent.removeClass( 'woocommerce-validated' ).addClass( 'woocommerce-invalid woocommerce-invalid-required-field' );\r\n\t\t\t\t\t\tvalidated = false;\r\n\t\t\t\t\t} else if ( $this.val() === '' ) {\r\n\t\t\t\t\t\t$parent.removeClass( 'woocommerce-validated' ).addClass( 'woocommerce-invalid woocommerce-invalid-required-field' );\r\n\t\t\t\t\t\tvalidated = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( validate_email ) {\r\n\t\t\t\t\tif ( $this.val() ) {\r\n\t\t\t\t\t\t/* https://stackoverflow.com/questions/2855865/jquery-validate-e-mail-address-regex */\r\n\t\t\t\t\t\tpattern = new RegExp( /^([a-z\\d!#$%&'*+\\-\\/=?^_`{|}~\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]+(\\.[a-z\\d!#$%&'*+\\-\\/=?^_`{|}~\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]+)*|\"((([ \\t]*\\r\\n)?[ \\t]+)?([\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f\\x21\\x23-\\x5b\\x5d-\\x7e\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]))*(([ \\t]*\\r\\n)?[ \\t]+)?\")@(([a-z\\d\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]|[a-z\\d\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF][a-z\\d\\-._~\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]*[a-z\\d\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])\\.)+([a-z\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]|[a-z\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF][a-z\\d\\-._~\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]*[0-9a-z\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])\\.?$/i ); // eslint-disable-line max-len\r\n\r\n\t\t\t\t\t\tif ( ! pattern.test( $this.val() ) ) {\r\n\t\t\t\t\t\t\t$parent.removeClass( 'woocommerce-validated' ).addClass( 'woocommerce-invalid woocommerce-invalid-email woocommerce-invalid-phone' ); // eslint-disable-line max-len\r\n\t\t\t\t\t\t\tvalidated = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( validate_phone ) {\r\n\t\t\t\t\tpattern = new RegExp( /[\\s\\#0-9_\\-\\+\\/\\(\\)\\.]/g );\r\n\r\n\t\t\t\t\tif ( 0 < $this.val().replace( pattern, '' ).length ) {\r\n\t\t\t\t\t\t$parent.removeClass( 'woocommerce-validated' ).addClass( 'woocommerce-invalid woocommerce-invalid-phone' );\r\n\t\t\t\t\t\tvalidated = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( validated ) {\r\n\t\t\t\t\t$parent.removeClass( 'woocommerce-invalid woocommerce-invalid-required-field woocommerce-invalid-email woocommerce-invalid-phone' ).addClass( 'woocommerce-validated' ); // eslint-disable-line max-len\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tupdate_checkout: function( event, args ) {\r\n\t\t\t// Small timeout to prevent multiple requests when several fields update at the same time\r\n\t\t\twc_checkout_form.reset_update_checkout_timer();\r\n\t\t\twc_checkout_form.updateTimer = setTimeout( wc_checkout_form.update_checkout_action, '5', args );\r\n\t\t},\r\n\t\t// CHANGE: Add function to re-focus and keep value of the element that was previously focused before submitting an ajax request\r\n\t\tmaybe_refocus_element: function( currentFocusedElement, currentValue ) {\r\n\t\t\t// Bail if no element to focus\r\n\t\t\tif ( null === currentFocusedElement ) { return; }\r\n\r\n\t\t\trequestAnimationFrame( function() {\r\n\t\t\t\tvar elementToFocus;\r\n\r\n\t\t\t\t// Try findind the `select2` focusable element\r\n\t\t\t\tif ( currentFocusedElement.matches( '.fc-select2-field' ) ) {\r\n\t\t\t\t\telementToFocus = document.querySelector( '.form-row[id=\"' + currentFocusedElement.id + '\"] .select2-selection' );\r\n\t\t\t\t}\r\n\t\t\t\t// Try findind the the current focused element after updating updated element by ID\r\n\t\t\t\telse if ( currentFocusedElement.id ) {\r\n\t\t\t\t\telementToFocus = document.getElementById( currentFocusedElement.id );\r\n\t\t\t\t}\r\n\t\t\t\t// Try findind the updated element by classes\r\n\t\t\t\telse if ( currentFocusedElement.getAttribute( 'name' ) ) {\r\n\t\t\t\t\tvar nameAttr = currentFocusedElement.getAttribute( 'name' );\r\n\t\t\t\t\telementToFocus = document.querySelector( '[name=\"'+nameAttr+'\"]' );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Try setting focus if element is found\r\n\t\t\t\tif ( elementToFocus && elementToFocus !== currentFocusedElement ) {\r\n\t\t\t\t\telementToFocus.focus();\r\n\r\n\t\t\t\t\t// Try to set current value to the focused element\r\n\t\t\t\t\tif ( null !== currentValue && currentValue !== elementToFocus.value ) {\r\n\t\t\t\t\t\telementToFocus.value = currentValue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Set keyboard track position back to that previously to update\r\n\t\t\t\t\tsetTimeout( function(){\r\n\t\t\t\t\t\t// Try to set the same track position\r\n\t\t\t\t\t\tif( null !== elementToFocus.selectionStart && null !== elementToFocus.selectionEnd ) {\r\n\t\t\t\t\t\t\tif ( currentFocusedElement.selectionStart && currentFocusedElement.selectionEnd ) {\r\n\t\t\t\t\t\t\t\telementToFocus.selectionStart = currentFocusedElement.selectionStart;\r\n\t\t\t\t\t\t\t\telementToFocus.selectionEnd = currentFocusedElement.selectionEnd;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// Otherwise try set the track position to the end of the field\r\n\t\t\t\t\t\t\t// @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/setSelectionRange\r\n\t\t\t\t\t\t\t// @see https://html.spec.whatwg.org/multipage/input.html#concept-input-apply\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\telementToFocus.selectionStart = elementToFocus.selectionEnd = Number.MAX_SAFE_INTEGER || 10000;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Try to select the entire content of the field\r\n\t\t\t\t\t\t// @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/select\r\n\t\t\t\t\t\t// @see https://html.spec.whatwg.org/multipage/input.html#concept-input-apply\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\ttry { elementToFocus.select(); }\r\n\t\t\t\t\t\t\tcatch { /* Do nothing */ }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 0 );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t},\r\n\t\tupdate_checkout_action: function( args ) {\r\n\t\t\t// CHANGE: Check flag that allows or block updating the checkout\r\n\t\t\tif ( ! window.can_update_checkout ) { return; }\r\n\r\n\t\t\tif ( wc_checkout_form.xhr ) {\r\n\t\t\t\twc_checkout_form.xhr.abort();\r\n\t\t\t}\r\n\r\n\t\t\tif ( $( 'form.checkout' ).length === 0 ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\targs = typeof args !== 'undefined' ? args : {\r\n\t\t\t\tupdate_shipping_method: true\r\n\t\t\t};\r\n\r\n\t\t\tvar country\t\t\t = $( '#billing_country' ).val(),\r\n\t\t\t\tstate\t\t\t = $( '#billing_state' ).val(),\r\n\t\t\t\tpostcode\t\t = $( ':input#billing_postcode' ).val(),\r\n\t\t\t\tcity\t\t\t = $( '#billing_city' ).val(),\r\n\t\t\t\taddress\t\t\t = $( ':input#billing_address_1' ).val(),\r\n\t\t\t\taddress_2\t\t = $( ':input#billing_address_2' ).val(),\r\n\t\t\t\t// CHANGE: Always get shipping address values from shipping fields\r\n\t\t\t\ts_country\t\t = $( '#shipping_country' ).val(),\r\n\t\t\t\ts_state\t\t\t = $( '#shipping_state' ).val(),\r\n\t\t\t\ts_postcode\t\t = $( ':input#shipping_postcode' ).val(),\r\n\t\t\t\ts_city\t\t\t = $( '#shipping_city' ).val(),\r\n\t\t\t\ts_address\t\t = $( ':input#shipping_address_1' ).val(),\r\n\t\t\t\ts_address_2\t\t = $( ':input#shipping_address_2' ).val(),\r\n\t\t\t\t// END - CHANGE: Always get shipping address values from shipping fields\r\n\t\t\t\t$required_inputs = $( wc_checkout_form.$checkout_form ).find( '.address-field.validate-required:visible' ),\r\n\t\t\t\thas_full_address = true;\r\n\r\n\t\t\tif ( $required_inputs.length ) {\r\n\t\t\t\t$required_inputs.each( function() {\r\n\t\t\t\t\tif ( $( this ).find( ':input' ).val() === '' ) {\r\n\t\t\t\t\t\thas_full_address = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// CHANGE: Removed if handling of different shipping address checkbox, always get shipping address values from shipping fields (see above)\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tsecurity        : wc_checkout_params.update_order_review_nonce,\r\n\t\t\t\tpayment_method  : wc_checkout_form.get_payment_method(),\r\n\t\t\t\tcountry         : country,\r\n\t\t\t\tstate           : state,\r\n\t\t\t\tpostcode        : postcode,\r\n\t\t\t\tcity            : city,\r\n\t\t\t\taddress         : address,\r\n\t\t\t\taddress_2       : address_2,\r\n\t\t\t\ts_country       : s_country,\r\n\t\t\t\ts_state         : s_state,\r\n\t\t\t\ts_postcode      : s_postcode,\r\n\t\t\t\ts_city          : s_city,\r\n\t\t\t\ts_address       : s_address,\r\n\t\t\t\ts_address_2     : s_address_2,\r\n\t\t\t\thas_full_address: has_full_address,\r\n\t\t\t\tpost_data       : $( 'form.checkout' ).serialize()\r\n\t\t\t};\r\n\r\n\t\t\tif ( false !== args.update_shipping_method ) {\r\n\t\t\t\tvar shipping_methods = {};\r\n\r\n\t\t\t\t// eslint-disable-next-line max-len\r\n\t\t\t\t$( 'select.shipping_method, input[name^=\"shipping_method\"][type=\"radio\"]:checked, input[name^=\"shipping_method\"][type=\"hidden\"]' ).each( function() {\r\n\t\t\t\t\tshipping_methods[ $( this ).data( 'index' ) ] = $( this ).val();\r\n\t\t\t\t} );\r\n\r\n\t\t\t\tdata.shipping_method = shipping_methods;\r\n\t\t\t}\r\n\r\n\t\t\t// CHANGE: Also block the shipping methods section when updating\r\n\t\t\t$( '.woocommerce-checkout-payment, .woocommerce-checkout-review-order-table .fc-shipping-method__packages' ).block({\r\n\t\t\t\tmessage: null,\r\n\t\t\t\toverlayCSS: {\r\n\t\t\t\t\tbackground: '#fff',\r\n\t\t\t\t\topacity: 0.6\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\twc_checkout_form.xhr = $.ajax({\r\n\t\t\t\ttype:\t\t'POST',\r\n\t\t\t\turl:\t\twc_checkout_params.wc_ajax_url.toString().replace( '%%endpoint%%', 'update_order_review' ),\r\n\t\t\t\tdata:\t\tdata,\r\n\t\t\t\tsuccess:\tfunction( data ) {\r\n\r\n\t\t\t\t\t// Reload the page if requested\r\n\t\t\t\t\tif ( data && true === data.reload ) {\r\n\t\t\t\t\t\twindow.location.reload();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Remove any notices added previously\r\n\t\t\t\t\t$( '.woocommerce-NoticeGroup-updateOrderReview' ).remove();\r\n\r\n\t\t\t\t\t// CHANGE: replaced the terms checkbox css selector\r\n\t\t\t\t\tvar termsCheckBoxChecked = $( _settings.checkoutTermsSelector ).prop( 'checked' );\r\n\r\n\t\t\t\t\t// Save payment details to a temporary object\r\n\t\t\t\t\tvar paymentDetails = {};\r\n\t\t\t\t\t$( '.payment_box :input' ).each( function() {\r\n\t\t\t\t\t\tvar ID = $( this ).attr( 'id' );\r\n\r\n\t\t\t\t\t\tif ( ID ) {\r\n\t\t\t\t\t\t\tif ( $.inArray( $( this ).attr( 'type' ), [ 'checkbox', 'radio' ] ) !== -1 ) {\r\n\t\t\t\t\t\t\t\tpaymentDetails[ ID ] = $( this ).prop( 'checked' );\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tpaymentDetails[ ID ] = $( this ).val();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// CHANGE: Get current element with focus, will re-set focus after updating the fragments\r\n\t\t\t\t\tvar currentFocusedElement = document.activeElement;\r\n\t\t\t\t\tvar currentValue = document.activeElement.value;\r\n\r\n\t\t\t\t\t// Maybe set current element with focus to the form row for `select2` fields\r\n\t\t\t\t\tvar currentFocusedFormRow = currentFocusedElement.closest( '.fc-select2-field' );\r\n\t\t\t\t\tif ( currentFocusedFormRow ) {\r\n\t\t\t\t\t\t// Remove focus from current element as it will be replaced\r\n\t\t\t\t\t\t// This fixes an issue where `select2` fields would not work properly\r\n\t\t\t\t\t\t// after checkout is updated while focus is on a `select2` field\r\n\t\t\t\t\t\tif ( currentFocusedElement ) { currentFocusedElement.blur(); }\r\n\r\n\t\t\t\t\t\tcurrentFocusedElement = currentFocusedFormRow;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// CHANGE: END - Get current element with focus, will re-set focus after updating the fragments\r\n\r\n\t\t\t\t\t// Always update the fragments\r\n\t\t\t\t\tif ( data && data.fragments ) {\r\n\t\t\t\t\t\t// CHANGE: Try to remove select2 components from existing fields before replacing fragments\r\n\t\t\t\t\t\t$( 'select.country_select, select.state_select' ).each( function() {\r\n\t\t\t\t\t\t\tvar field = $( this );\r\n\t\t\t\t\t\t\tif ( field.hasClass( 'select2-hidden-accessible' ) ) { // Field has `select2` initialized\r\n\t\t\t\t\t\t\t\tif ( typeof field.selectWoo === 'function' ) { field.selectWoo( 'destroy' ); }\r\n\t\t\t\t\t\t\t\telse if ( typeof field.select2 === 'function' ) { field.select2( 'destroy' ); }\r\n\t\t\t\t\t\t\t\tfield.off( 'select2:select' );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t// CHANGE: END - Try to remove select2 components from existing fields before replacing fragments\r\n\r\n\t\t\t\t\t\t// CHANGE: Try to remove intl-tel-input components from existing fields before replacing fragments\r\n\t\t\t\t\t\tif ( window.intlTelInput && window.intlTelInputGlobals ) {\r\n\t\t\t\t\t\t\tvar allPhoneFields = document.querySelectorAll( _settings.phoneFieldSelector );\r\n\t\t\t\t\t\t\tfor ( var i = 0; i < allPhoneFields.length; i++ ) {\r\n\t\t\t\t\t\t\t\tvar field = allPhoneFields[i];\r\n\t\t\t\t\t\t\t\tvar phoneField = window.intlTelInputGlobals.getInstance( field );\r\n\t\t\t\t\t\t\t\tif ( phoneField ) {\r\n\t\t\t\t\t\t\t\t\tvar preservedValue = phoneField.getNumber();\r\n\t\t\t\t\t\t\t\t\tphoneField.destroy();\r\n\t\t\t\t\t\t\t\t\tfield.value = preservedValue;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// CHANGE: END - Try to remove intl-tel-input components from existing fields before replacing fragments\r\n\r\n\t\t\t\t\t\t$.each( data.fragments, function ( key, value ) {\r\n\t\t\t\t\t\t\t// CHANGE: Declare local variables needed for some checks before replacing the fragment\r\n\t\t\t\t\t\t\tvar fragmentToReplace = document.querySelector( key );\r\n\t\t\t\t\t\t\tvar replaceFragment = true;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// CHANGE: Maybe set to skip fragment with the focus within it. This avoids unexpected closing of mobile keyboard and lost of focus when updating fragments.\r\n\t\t\t\t\t\t\tif ( fragmentToReplace && currentFocusedElement.closest( key ) && currentFocusedElement.closest( _settings.focusedFieldSkipFragmentReplaceSelector ) ) {\r\n\t\t\t\t\t\t\t\treplaceFragment = false;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// CHANGE: Allow fragments to be replaced every time even when their contents are equal the existing elements in the DOM\r\n\t\t\t\t\t\t\tif ( value && -1 !== value.toString().indexOf( 'fc-fragment-always-replace' ) ) {\r\n\t\t\t\t\t\t\t\treplaceFragment = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif ( replaceFragment && ( ! wc_checkout_form.fragments || wc_checkout_form.fragments[ key ] !== value ) ) {\r\n\t\t\t\t\t\t\t\t$( key ).replaceWith( value );\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t$( key ).unblock();\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t\twc_checkout_form.fragments = data.fragments;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// CHANGE: Re-set focus to the element with focus previously to updating fragments\r\n\t\t\t\t\twc_checkout_form.maybe_refocus_element( currentFocusedElement, currentValue );\r\n\r\n\t\t\t\t\t// Recheck the terms and conditions box, if needed\r\n\t\t\t\t\tif ( termsCheckBoxChecked ) {\r\n\t\t\t\t\t\t// CHANGE: replaced the terms checkbox css selector\r\n\t\t\t\t\t\t$( _settings.checkoutTermsSelector ).prop( 'checked', true );\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Fill in the payment details if possible without overwriting data if set.\r\n\t\t\t\t\tif ( ! $.isEmptyObject( paymentDetails ) ) {\r\n\t\t\t\t\t\t$( '.payment_box :input' ).each( function() {\r\n\t\t\t\t\t\t\tvar ID = $( this ).attr( 'id' );\r\n\t\t\t\t\t\t\tif ( ID ) {\r\n\t\t\t\t\t\t\t\tif ( $.inArray( $( this ).attr( 'type' ), [ 'checkbox', 'radio' ] ) !== -1 ) {\r\n\t\t\t\t\t\t\t\t\t$( this ).prop( 'checked', paymentDetails[ ID ] ).trigger( 'change' );\r\n\t\t\t\t\t\t\t\t} else if ( $.inArray( $( this ).attr( 'type' ), [ 'select' ] ) !== -1 ) {\r\n\t\t\t\t\t\t\t\t\t$( this ).val( paymentDetails[ ID ] ).trigger( 'change' );\r\n\t\t\t\t\t\t\t\t} else if ( null !== $( this ).val() && 0 === $( this ).val().length ) {\r\n\t\t\t\t\t\t\t\t\t$( this ).val( paymentDetails[ ID ] ).trigger( 'change' );\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Check for error\r\n\t\t\t\t\tif ( data && 'failure' === data.result ) {\r\n\r\n\t\t\t\t\t\tvar $form = $( 'form.checkout' );\r\n\r\n\t\t\t\t\t\t// Remove notices from all sources\r\n\t\t\t\t\t\t$( '.woocommerce-error, .woocommerce-message' ).remove();\r\n\r\n\t\t\t\t\t\t// Add new errors returned by this event\r\n\t\t\t\t\t\tif ( data.messages ) {\r\n\t\t\t\t\t\t\t$form.prepend( '<div class=\"woocommerce-NoticeGroup woocommerce-NoticeGroup-updateOrderReview\">' + data.messages + '</div>' ); // eslint-disable-line max-len\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$form.prepend( data );\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Lose focus for all fields\r\n\t\t\t\t\t\t$form.find( '.input-text, select, input:checkbox' ).trigger( 'validate' ).trigger( 'blur' );\r\n\r\n\t\t\t\t\t\twc_checkout_form.scroll_to_notices();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Re-init methods\r\n\t\t\t\t\twc_checkout_form.init_payment_methods();\r\n\r\n\t\t\t\t\t// CHANGE: Set to not prompt user before leaving the page\r\n\t\t\t\t\t_updateBeforeUnload = false;\r\n\r\n\t\t\t\t\t// Fire updated_checkout event.\r\n\t\t\t\t\t$( document.body ).trigger( 'updated_checkout', [ data ] );\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\t\t},\r\n\t\thandleUnloadEvent: function( e ) {\r\n\t\t\t// Modern browsers have their own standard generic messages that they will display.\r\n\t\t\t// Confirm, alert, prompt or custom message are not allowed during the unload event\r\n\t\t\t// Browsers will display their own standard messages\r\n\r\n\t\t\t// Check if the browser is Internet Explorer\r\n\t\t\tif((navigator.userAgent.indexOf('MSIE') !== -1 ) || (!!document.documentMode)) {\r\n\t\t\t\t// IE handles unload events differently than modern browsers\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tattachUnloadEventsOnSubmit: function() {\r\n\t\t\t$( window ).on('beforeunload', this.handleUnloadEvent);\r\n\t\t},\r\n\t\tdetachUnloadEventsOnSubmit: function() {\r\n\t\t\t$( window ).off('beforeunload', this.handleUnloadEvent);\r\n\t\t},\r\n\t\tblockOnSubmit: function( $form ) {\r\n\t\t\tvar isBlocked = $form.data( 'blockUI.isBlocked' );\r\n\r\n\t\t\tif ( 1 !== isBlocked ) {\r\n\t\t\t\t$form.block({\r\n\t\t\t\t\tmessage: null,\r\n\t\t\t\t\toverlayCSS: {\r\n\t\t\t\t\t\tbackground: '#fff',\r\n\t\t\t\t\t\topacity: 0.6\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tsubmitOrder: function() {\r\n\t\t\twc_checkout_form.blockOnSubmit( $( this ) );\r\n\t\t},\r\n\t\tsubmit: function() {\r\n\t\t\twc_checkout_form.reset_update_checkout_timer();\r\n\t\t\tvar $form = $( this );\r\n\r\n\t\t\tif ( $form.is( '.processing' ) ) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t// CHANGE: Reset flag to update on `beforeunload`\r\n\t\t\t_updateBeforeUnload = false;\r\n\r\n\t\t\t// Trigger a handler to let gateways manipulate the checkout if needed\r\n\t\t\t// eslint-disable-next-line max-len\r\n\t\t\tif ( $form.triggerHandler( 'checkout_place_order' ) !== false && $form.triggerHandler( 'checkout_place_order_' + wc_checkout_form.get_payment_method() ) !== false ) {\r\n\r\n\t\t\t\t$form.addClass( 'processing' );\r\n\r\n\t\t\t\t// CHANGE: Disable place order button\r\n\t\t\t\tvar currentFocusedElement = document.activeElement;\r\n\t\t\t\t$( _settings.checkoutPlaceOrderSelector ).attr( 'disabled', 'disabled' );\r\n\t\t\t\t$( _settings.checkoutPlaceOrderSelector ).addClass( 'disabled' );\r\n\t\t\t\t// END - Disable place order button\r\n\r\n\t\t\t\twc_checkout_form.blockOnSubmit( $form );\r\n\r\n\t\t\t\t// Attach event to block reloading the page when the form has been submitted\r\n\t\t\t\twc_checkout_form.attachUnloadEventsOnSubmit();\r\n\r\n\t\t\t\t// ajaxSetup is global, but we use it to ensure JSON is valid once returned.\r\n\t\t\t\t$.ajaxSetup( {\r\n\t\t\t\t\tdataFilter: function( raw_response, dataType ) {\r\n\t\t\t\t\t\t// We only want to work with JSON\r\n\t\t\t\t\t\tif ( 'json' !== dataType ) {\r\n\t\t\t\t\t\t\treturn raw_response;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( wc_checkout_form.is_valid_json( raw_response ) ) {\r\n\t\t\t\t\t\t\treturn raw_response;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Attempt to fix the malformed JSON\r\n\t\t\t\t\t\t\tvar maybe_valid_json = raw_response.match( /{\"result.*}/ );\r\n\r\n\t\t\t\t\t\t\tif ( null === maybe_valid_json ) {\r\n\t\t\t\t\t\t\t\tconsole.log( 'Unable to fix malformed JSON' );\r\n\t\t\t\t\t\t\t} else if ( wc_checkout_form.is_valid_json( maybe_valid_json[0] ) ) {\r\n\t\t\t\t\t\t\t\tconsole.log( 'Fixed malformed JSON. Original:' );\r\n\t\t\t\t\t\t\t\tconsole.log( raw_response );\r\n\t\t\t\t\t\t\t\traw_response = maybe_valid_json[0];\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tconsole.log( 'Unable to fix malformed JSON' );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn raw_response;\r\n\t\t\t\t\t}\r\n\t\t\t\t} );\r\n\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\ttype:\t\t'POST',\r\n\t\t\t\t\turl:\t\twc_checkout_params.checkout_url,\r\n\t\t\t\t\tdata:\t\t$form.serialize(),\r\n\t\t\t\t\tdataType:   'json',\r\n\t\t\t\t\tsuccess:\tfunction( result ) {\r\n\t\t\t\t\t\t// Detach the unload handler that prevents a reload / redirect\r\n\t\t\t\t\t\twc_checkout_form.detachUnloadEventsOnSubmit();\r\n\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tif ( 'success' === result.result && $form.triggerHandler( 'checkout_place_order_success', result ) !== false ) {\r\n\t\t\t\t\t\t\t\tif ( -1 === result.redirect.indexOf( 'https://' ) || -1 === result.redirect.indexOf( 'http://' ) ) {\r\n\t\t\t\t\t\t\t\t\twindow.location = result.redirect;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\twindow.location = decodeURI( result.redirect );\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else if ( 'failure' === result.result ) {\r\n\t\t\t\t\t\t\t\tthrow 'Result failure';\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthrow 'Invalid response';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} catch( err ) {\r\n\t\t\t\t\t\t\t// Reload page\r\n\t\t\t\t\t\t\tif ( true === result.reload ) {\r\n\t\t\t\t\t\t\t\twindow.location.reload();\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// CHANGE: Unblock the place order button\r\n\t\t\t\t\t\t\t$( _settings.checkoutPlaceOrderSelector ).removeAttr( 'disabled' );\r\n\t\t\t\t\t\t\t$( _settings.checkoutPlaceOrderSelector ).removeClass( 'disabled' );\r\n\t\t\t\t\t\t\twc_checkout_form.maybe_refocus_element( currentFocusedElement );\r\n\t\t\t\t\t\t\t// END - Unblock the place order button\r\n\r\n\t\t\t\t\t\t\t// Trigger update in case we need a fresh nonce\r\n\t\t\t\t\t\t\tif ( true === result.refresh ) {\r\n\t\t\t\t\t\t\t\t$( document.body ).trigger( 'update_checkout' );\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// Add new errors\r\n\t\t\t\t\t\t\tif ( result.messages ) {\r\n\t\t\t\t\t\t\t\twc_checkout_form.submit_error( result.messages );\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\twc_checkout_form.submit_error( '<div class=\"woocommerce-error\">' + wc_checkout_params.i18n_checkout_error + '</div>' ); // eslint-disable-line max-len\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror:\tfunction( jqXHR, textStatus, errorThrown ) {\r\n\t\t\t\t\t\t// Detach the unload handler that prevents a reload / redirect\r\n\t\t\t\t\t\twc_checkout_form.detachUnloadEventsOnSubmit();\r\n\r\n\t\t\t\t\t\twc_checkout_form.submit_error(\r\n\t\t\t\t\t\t\t'<div class=\"woocommerce-error\">' +\r\n\t\t\t\t\t\t\t( errorThrown || wc_checkout_params.i18n_checkout_error ) +\r\n\t\t\t\t\t\t\t'</div>'\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tsubmit_error: function( error_message ) {\r\n\t\t\t$( '.woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message' ).remove();\r\n\t\t\twc_checkout_form.$checkout_form.prepend( '<div class=\"woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout\">' + error_message + '</div>' ); // eslint-disable-line max-len\r\n\t\t\twc_checkout_form.$checkout_form.removeClass( 'processing' ).unblock();\r\n\t\t\t// CHANGE: Unblock the place order button\r\n\t\t\t$( _settings.checkoutPlaceOrderSelector ).removeAttr( 'disabled' );\r\n\t\t\t$( _settings.checkoutPlaceOrderSelector ).removeClass( 'disabled' );\r\n\t\t\t// END - Unblock the place order button\r\n\t\t\twc_checkout_form.$checkout_form.find( '.input-text, select, input:checkbox' ).trigger( 'validate' ).trigger( 'blur' );\r\n\t\t\twc_checkout_form.scroll_to_notices();\r\n\t\t\t$( document.body ).trigger( 'checkout_error' , [ error_message ] );\r\n\t\t},\r\n\t\tscroll_to_notices: function() {\r\n\t\t\tvar scrollElement           = $( '.woocommerce-NoticeGroup-updateOrderReview, .woocommerce-NoticeGroup-checkout' );\r\n\r\n\t\t\tif ( ! scrollElement.length ) {\r\n\t\t\t\tscrollElement = $( 'form.checkout' );\r\n\t\t\t}\r\n\t\t\t$.scroll_to_notices( scrollElement );\r\n\t\t}\r\n\t};\r\n\r\n\tvar wc_checkout_coupons = {\r\n\t\tinit: function() {\r\n\t\t\t$( document.body ).on( 'click', 'a.showcoupon', this.show_coupon_form );\r\n\t\t\t$( document.body ).on( 'click', '.woocommerce-remove-coupon', this.remove_coupon );\r\n\t\t\t$( 'form.checkout_coupon' ).hide().on( 'submit', this.submit );\r\n\t\t},\r\n\t\tshow_coupon_form: function() {\r\n\t\t\t$( '.checkout_coupon' ).slideToggle( 400, function() {\r\n\t\t\t\t$( '.checkout_coupon' ).find( ':input:eq(0)' ).trigger( 'focus' );\r\n\t\t\t});\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tsubmit: function() {\r\n\t\t\tvar $form = $( this );\r\n\r\n\t\t\tif ( $form.is( '.processing' ) ) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t$form.addClass( 'processing' ).block({\r\n\t\t\t\tmessage: null,\r\n\t\t\t\toverlayCSS: {\r\n\t\t\t\t\tbackground: '#fff',\r\n\t\t\t\t\topacity: 0.6\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tsecurity:\t\twc_checkout_params.apply_coupon_nonce,\r\n\t\t\t\tcoupon_code:\t$form.find( 'input[name=\"coupon_code\"]' ).val()\r\n\t\t\t};\r\n\r\n\t\t\t$.ajax({\r\n\t\t\t\ttype:\t\t'POST',\r\n\t\t\t\turl:\t\twc_checkout_params.wc_ajax_url.toString().replace( '%%endpoint%%', 'apply_coupon' ),\r\n\t\t\t\tdata:\t\tdata,\r\n\t\t\t\tsuccess:\tfunction( code ) {\r\n\t\t\t\t\t$( '.woocommerce-error, .woocommerce-message' ).remove();\r\n\t\t\t\t\t$form.removeClass( 'processing' ).unblock();\r\n\r\n\t\t\t\t\tif ( code ) {\r\n\t\t\t\t\t\t$form.before( code );\r\n\t\t\t\t\t\t$form.slideUp();\r\n\r\n\t\t\t\t\t\t$( document.body ).trigger( 'applied_coupon_in_checkout', [ data.coupon_code ] );\r\n\t\t\t\t\t\t$( document.body ).trigger( 'update_checkout', { update_shipping_method: false } );\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tdataType: 'html'\r\n\t\t\t});\r\n\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tremove_coupon: function( e ) {\r\n\t\t\t// CHANGE: Bail when Fluid Checkout integrated coupon code feature is enabled\r\n\t\t\tif ( _settings.checkoutCoupons && 'yes' === _settings.checkoutCoupons.isEnabled ) { return; }\r\n\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tvar container = $( this ).parents( '.woocommerce-checkout-review-order' ),\r\n\t\t\t\tcoupon    = $( this ).data( 'coupon' );\r\n\r\n\t\t\tcontainer.addClass( 'processing' ).block({\r\n\t\t\t\tmessage: null,\r\n\t\t\t\toverlayCSS: {\r\n\t\t\t\t\tbackground: '#fff',\r\n\t\t\t\t\topacity: 0.6\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tsecurity: wc_checkout_params.remove_coupon_nonce,\r\n\t\t\t\tcoupon:   coupon\r\n\t\t\t};\r\n\r\n\t\t\t$.ajax({\r\n\t\t\t\ttype:    'POST',\r\n\t\t\t\turl:     wc_checkout_params.wc_ajax_url.toString().replace( '%%endpoint%%', 'remove_coupon' ),\r\n\t\t\t\tdata:    data,\r\n\t\t\t\tsuccess: function( code ) {\r\n\t\t\t\t\t$( '.woocommerce-error, .woocommerce-message' ).remove();\r\n\t\t\t\t\tcontainer.removeClass( 'processing' ).unblock();\r\n\r\n\t\t\t\t\tif ( code ) {\r\n\t\t\t\t\t\t$( 'form.woocommerce-checkout' ).before( code );\r\n\r\n\t\t\t\t\t\t$( document.body ).trigger( 'removed_coupon_in_checkout', [ data.coupon ] );\r\n\t\t\t\t\t\t$( document.body ).trigger( 'update_checkout', { update_shipping_method: false } );\r\n\r\n\t\t\t\t\t\t// Remove coupon code from coupon field\r\n\t\t\t\t\t\t$( 'form.checkout_coupon' ).find( 'input[name=\"coupon_code\"]' ).val( '' );\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: function ( jqXHR ) {\r\n\t\t\t\t\tif ( wc_checkout_params.debug_mode ) {\r\n\t\t\t\t\t\t/* jshint devel: true */\r\n\t\t\t\t\t\tconsole.log( jqXHR.responseText );\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tdataType: 'html'\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tvar wc_checkout_login_form = {\r\n\t\tinit: function() {\r\n\t\t\t$( document.body ).on( 'click', 'a.showlogin', this.show_login_form );\r\n\t\t},\r\n\t\tshow_login_form: function() {\r\n\t\t\t$( 'form.login, form.woocommerce-form--login' ).slideToggle();\r\n\t\t\treturn false;\r\n\t\t}\r\n\t};\r\n\r\n\tvar wc_terms_toggle = {\r\n\t\tinit: function() {\r\n\t\t\t$( document.body ).on( 'click', 'a.woocommerce-terms-and-conditions-link', this.toggle_terms );\r\n\t\t},\r\n\r\n\t\ttoggle_terms: function() {\r\n\t\t\tif ( $( '.woocommerce-terms-and-conditions' ).length ) {\r\n\t\t\t\t$( '.woocommerce-terms-and-conditions' ).slideToggle( function() {\r\n\t\t\t\t\tvar link_toggle = $( '.woocommerce-terms-and-conditions-link' );\r\n\r\n\t\t\t\t\tif ( $( '.woocommerce-terms-and-conditions' ).is( ':visible' ) ) {\r\n\t\t\t\t\t\tlink_toggle.addClass( 'woocommerce-terms-and-conditions-link--open' );\r\n\t\t\t\t\t\tlink_toggle.removeClass( 'woocommerce-terms-and-conditions-link--closed' );\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlink_toggle.removeClass( 'woocommerce-terms-and-conditions-link--open' );\r\n\t\t\t\t\t\tlink_toggle.addClass( 'woocommerce-terms-and-conditions-link--closed' );\r\n\t\t\t\t\t}\r\n\t\t\t\t} );\r\n\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\twc_checkout_form.init();\r\n\twc_checkout_coupons.init();\r\n\twc_checkout_login_form.init();\r\n\twc_terms_toggle.init();\r\n});\r\n"],"names":["jQuery","$","wc_checkout_params","window","can_update_checkout","extend","extended","deep","i","Object","prototype","toString","call","arguments","length","prop","obj","hasOwnProperty","_updateBeforeUnload","blockUI","defaults","overlayCSS","cursor","_settings","checkoutPlaceOrderSelector","checkoutTermsSelector","checkoutUpdateFieldsSelector","checkoutUpdateBeforeUnload","focusedFieldSkipFragmentReplaceSelector","phoneFieldSelector","wc_checkout_form","updateTimer","dirtyInput","selectedPaymentMethod","xhr","$order_review","$checkout_form","init","fcSettings","document","body","on","this","update_checkout","init_checkout","set_autocomplete_attribute_from_data","payment_method_selected","hasClass","submitOrder","attr","submit","validate_field","trigger_update_checkout","input_changed","maybe_input_changed","queue_update_checkout","addEventListener","maybe_update_checkout_visibility_change","maybe_prevent_unload","billing_same_shipping_changed","maybe_reinitialize_collapsible_blocks","terms_checked_changed","init_payment_methods","is_checkout","trigger","option_guest_checkout","toggle_create_account","e","checkbox","fieldsWrapper","CollapsibleBlock","querySelector","checked","collapse","expand","collapsibleBlock","collapsibleBlocks","querySelectorAll","getInstance","initializeElement","visibilityState","preventUnload","target","closest","preventDefault","returnValue","removeEventListener","$payment_methods","find","checkedPaymentMethod","eq","hide","filter","slideUp","get_payment_method","val","stopPropagation","target_payment_box","is_checked","is","slideDown","show","data","text","classList","remove","add","each","termsCheckBoxChecked","maybe_update_checkout","code","keyCode","which","reset_update_checkout_timer","setTimeout","$required_inputs","update_totals","clearTimeout","is_valid_json","raw_json","json","JSON","parse","$this","$parent","validated","validate_required","validate_email","validate_phone","pattern","event_type","type","removeClass","addClass","RegExp","test","replace","event","args","update_checkout_action","maybe_refocus_element","currentFocusedElement","currentValue","requestAnimationFrame","nameAttr","elementToFocus","matches","id","getElementById","getAttribute","focus","value","selectionStart","selectionEnd","Number","MAX_SAFE_INTEGER","select","country","state","postcode","city","address","address_2","s_country","s_state","s_postcode","s_city","s_address","s_address_2","has_full_address","shipping_methods","abort","update_shipping_method","security","update_order_review_nonce","payment_method","post_data","serialize","shipping_method","block","message","background","opacity","ajax","url","wc_ajax_url","success","reload","location","paymentDetails","ID","inArray","activeElement","currentFocusedFormRow","blur","fragments","field","selectWoo","select2","off","intlTelInput","intlTelInputGlobals","allPhoneFields","preservedValue","phoneField","getNumber","destroy","key","replaceFragment","indexOf","replaceWith","unblock","isEmptyObject","result","$form","messages","prepend","scroll_to_notices","handleUnloadEvent","navigator","userAgent","documentMode","attachUnloadEventsOnSubmit","detachUnloadEventsOnSubmit","blockOnSubmit","triggerHandler","ajaxSetup","dataFilter","raw_response","dataType","maybe_valid_json","match","console","log","checkout_url","redirect","decodeURI","err","removeAttr","refresh","submit_error","i18n_checkout_error","error","jqXHR","textStatus","errorThrown","error_message","scrollElement","wc_checkout_coupons","show_coupon_form","remove_coupon","slideToggle","apply_coupon_nonce","coupon_code","before","container","checkoutCoupons","isEnabled","parents","coupon","remove_coupon_nonce","debug_mode","responseText","wc_checkout_login_form","show_login_form","wc_terms_toggle","toggle_terms","link_toggle"],"mappings":"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"}