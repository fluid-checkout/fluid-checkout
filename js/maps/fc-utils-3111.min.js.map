{"version":3,"file":"../fc-utils-3111.min.js","sources":["fc-utils-3111.js"],"sourcesContent":["/**\r\n * Utility resources shared across the scripts of Fluid Checkout.\r\n */\r\n(function (root, factory) {\r\n\tif ( typeof define === 'function' && define.amd ) {\r\n\t\tdefine([], factory(root));\r\n\t} else if ( typeof exports === 'object' ) {\r\n\t\tmodule.exports = factory(root);\r\n\t} else {\r\n\t\troot.FCUtils = factory(root);\r\n\t}\r\n})(typeof global !== 'undefined' ? global : this.window || this.global, function (root) {\r\n\r\n\t'use strict';\r\n\r\n\tvar _publicMethods = { }\r\n\tvar _settings = {\r\n\t\tfocusableElementsSelector:             'a[role=\"button\"], a[href], button:not([disabled]), input:not([disabled]):not([type=\"hidden\"]), textarea:not([disabled]), select:not([disabled]), details, summary, iframe, object, embed, [contenteditable] [tabindex]:not([tabindex=\"-1\"])',\r\n\r\n\t\tscrollOffsetSelector:                  '.fc-checkout-header',\r\n\t\tscrollBehavior:                        'smooth',\r\n\t\tscrollOffset:                          0,\r\n\t\tscrollDelay:                           50,\r\n\r\n\t\tbreakpoints: {\r\n\t\t\tmobile: { minWidth: 0, maxWidth: 549 },\r\n\t\t\tphablet: { minWidth: 550, maxWidth: 749 },\r\n\t\t\ttablet: { minWidth: 750, maxWidth: 999 },\r\n\t\t\tdesktop: { minWidth: 1000, maxWidth: 1279 },\r\n\t\t\tdesktopMedium: { minWidth: 1280, maxWidth: 1499 },\r\n\t\t\tdesktopLarge: { minWidth: 1500, maxWidth: 1999 },\r\n\t\t\tdesktopExtraLarge: { minWidth: 2000, maxWidth: 1000000 },\r\n\t\t},\r\n\r\n\t\tselect2FormRowSelector:                '.form-row.fc-select2-field',\r\n\t\tselect2FocusElementSelector:           '.select2-selection, input[type=\"text\"]',\r\n\t\tselect2OptionsSelector:                '.select2-results__options',\r\n\t\tselect2SelectionSelector:              '.select2-selection__rendered',\r\n\t\t\r\n\t\ttomSelectFormRowSelector:              '.form-row.fc-select2-field',\r\n\t\ttomSelectKeepingClosedClass:           'keeping-closed',\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * PROPERTIES\r\n\t */\r\n\r\n\r\n\r\n\t/**\r\n\t * Mapping of keyboard keys based on and comparable with `event.key` values.\r\n\t */\r\n\t_publicMethods.keyboardKeys = {\r\n\t\tESC: 'Escape',\r\n\t\tENTER: 'Enter',\r\n\t\tSPACE: ' ',\r\n\t\tTAB: 'Tab',\r\n\t\tCAPS: 'CapsLock',\r\n\t\tSHIFT: 'Shift',\r\n\t\tFUNCTION: 'Fn',\r\n\t\tCONTROL: 'Control',\r\n\t\tCOMMAND_OR_WINDOWS: 'Meta', // This is the `Windows` logo key, or the `Command` or `âŒ˜` key on Mac keyboards.\r\n\t\tALT: 'Alt',\r\n\t\tARROW_LEFT: 'ArrowLeft',\r\n\t\tARROW_RIGHT: 'ArrowRight',\r\n\t\tARROW_UP: 'ArrowUp',\r\n\t\tARROW_DOWN: 'ArrowDown',\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Determine which `animationend` event is supported.\r\n\t */\r\n\t_publicMethods.animationEndEvent = window.whichAnimationEnd ? window.whichAnimationEnd() : 'animationend';\r\n\r\n\r\n\r\n\r\n\t/**\r\n\t * METHODS\r\n\t */\r\n\r\n\r\n\r\n\t/**\r\n\t * Set the variables that track the current focused element and its value.\r\n\t */\r\n\tvar getCurrentFocusedElementGlobalVariables = function( setToRelativeSelect2 ) {\r\n\t\t// Set defaults\r\n\t\tif ( setToRelativeSelect2 !== true ) {\r\n\t\t\tsetToRelativeSelect2 = false;\r\n\t\t}\r\n\r\n\t\t// Set current focused element and value\r\n\t\tvar currentfocusedElement = document.activeElement;\r\n\r\n\t\t// Maybe set to relative `select2` field element,\r\n\t\t// if the focus is current on a `select2` field option.\r\n\t\tvar select2Options = currentfocusedElement.closest( _settings.select2OptionsSelector );\r\n\t\tif ( setToRelativeSelect2 && select2Options ) {\r\n\t\t\tvar select2ElementId = select2Options.getAttribute( 'id' ).replace( '-results', '-container' );\r\n\t\t\tcurrentfocusedElement = document.getElementById( select2ElementId );\r\n\t\t}\r\n\r\n\t\t// Maybe set to form row for `select2` fields\r\n\t\tvar currentFocusedFormRow = currentfocusedElement.closest( _settings.select2FormRowSelector );\r\n\t\tif ( currentFocusedFormRow && currentFocusedFormRow.querySelector( _settings.select2SelectionSelector ) ) {\r\n\t\t\t// Remove focus from current element as it will be replaced\r\n\t\t\t// This fixes an issue where `select2` fields would not work properly\r\n\t\t\t// after checkout is updated while focus is on a `select2` field\r\n\t\t\tif ( currentfocusedElement ) { currentfocusedElement.blur(); }\r\n\r\n\t\t\tcurrentfocusedElement = currentFocusedFormRow;\r\n\t\t}\r\n\r\n\t\treturn currentfocusedElement;\r\n\t}\r\n\r\n\r\n\r\n\t/*!\r\n\t* Merge two or more objects together.\r\n\t* (c) 2017 Chris Ferdinandi, MIT License, https://gomakethings.com\r\n\t* @param   {Boolean}  deep     If true, do a deep (or recursive) merge [optional]\r\n\t* @param   {Object}   objects  The objects to merge together\r\n\t* @returns {Object}            Merged values of defaults and options\r\n\t*/\r\n\t_publicMethods.extendObject = function () {\r\n\t\t// Variables\r\n\t\tvar extended = {};\r\n\t\tvar deep = false;\r\n\t\tvar i = 0;\r\n\r\n\t\t// Check if a deep merge\r\n\t\tif ( Object.prototype.toString.call( arguments[0] ) === '[object Boolean]' ) {\r\n\t\t\tdeep = arguments[0];\r\n\t\t\ti++;\r\n\t\t}\r\n\r\n\t\t// Merge the object into the extended object\r\n\t\tvar merge = function (obj) {\r\n\t\t\tfor (var prop in obj) {\r\n\t\t\t\tif (obj.hasOwnProperty(prop)) {\r\n\t\t\t\t\t// If property is an object, merge properties\r\n\t\t\t\t\tif (deep && Object.prototype.toString.call(obj[prop]) === '[object Object]') {\r\n\t\t\t\t\t\textended[prop] = _publicMethods.extendObject(extended[prop], obj[prop]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\textended[prop] = obj[prop];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// Loop through each object and conduct a merge\r\n\t\tfor (; i < arguments.length; i++) {\r\n\t\t\tvar obj = arguments[i];\r\n\t\t\tmerge(obj);\r\n\t\t}\r\n\r\n\t\treturn extended;\r\n\t};\r\n\r\n\r\n\r\n\t/**\r\n\t * Returns a function, that, as long as it continues to be invoked, will not\r\n\t * be triggered. The function will be called after it stops being called for\r\n\t * N milliseconds. If `immediate` is passed, trigger the function on the\r\n\t * leading edge, instead of the trailing.\r\n\t *\r\n\t * @param   {[type]}  func        Function to be executed.\r\n\t * @param   {[type]}  wait        Wait time in milliseconds.\r\n\t * @param   {[type]}  immediate   Trigger the function on the leading edge.\r\n\t *\r\n\t * @return  function              Function to be executed, incapsulated in a timed function.\r\n\t */\r\n\t_publicMethods.debounce = function ( func, wait, immediate ) {\r\n\t\tvar timeout;\r\n\r\n\t\treturn function() {\r\n\t\t\tvar context = this, args = arguments;\r\n\t\t\tvar later = function() {\r\n\t\t\t\ttimeout = null;\r\n\t\t\t\tif (!immediate) func.apply( context, args );\r\n\t\t\t};\r\n\r\n\t\t\tvar callNow = immediate && !timeout;\r\n\t\t\tclearTimeout( timeout );\r\n\t\t\ttimeout = setTimeout( later, wait );\r\n\r\n\t\t\tif ( callNow ) func.apply( context, args );\r\n\t\t};\r\n\t};\r\n\r\n\t/**\r\n\t * Return a function, that, when invoked, will only be triggered at most once\r\n\t * during a given window of time. Normally, the throttled function will run\r\n\t * as much as it can, without ever going more than once per `wait` duration;\r\n\t * \r\n\t * @param   function  fn          Function to be executed.\r\n\t * @param   int       threshhold  Wait time in milliseconds.\r\n\t * @param   object    scope       Scope of the function to be executed.\r\n\t * \r\n\t * @return  function              Function to be executed, incapsulated in a timed function.\r\n\t */\r\n\t_publicMethods.throttle = function( fn, threshhold, scope ) {\r\n\t\tthreshhold || (threshhold = 250);\r\n\t\tvar last,\r\n\t\tdeferTimer;\r\n\t\treturn function () {\r\n\t\t\tvar context = scope || this;\r\n\t\t\r\n\t\t\tvar now = +new Date,\r\n\t\t\t\targs = arguments;\r\n\t\t\tif ( last && now < last + threshhold ) {\r\n\t\t\t\t// hold on to it\r\n\t\t\t\tclearTimeout( deferTimer );\r\n\t\t\t\tdeferTimer = setTimeout( function () {\r\n\t\t\t\t\tlast = now;\r\n\t\t\t\t\tfn.apply( context, args );\r\n\t\t\t\t}, threshhold );\r\n\t\t\t} else {\r\n\t\t\t\tlast = now;\r\n\t\t\t\tfn.apply( context, args );\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Check if the element is considered visible. Does not consider the CSS property `visibility: hidden;`.\r\n\t */\r\n\t_publicMethods.isElementVisible = function( element ) {\r\n\t\treturn !!( element.offsetWidth || element.offsetHeight || element.getClientRects().length );\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Get the current breakpoints matched based on the window width.\r\n\t */\r\n\t_publicMethods.getCurrentBreakpoints = function() {\r\n\t\t// Define variables\r\n\t\tvar windowWidth = window.innerWidth;\r\n\t\tvar breakpointSelectors = Object.entries( _settings.breakpoints );\r\n\t\tvar currentBreakpoints = [];\r\n\r\n\t\t// Iterate through all breakpoints\r\n\t\tfor ( var i = 0; i < breakpointSelectors.length; i++ ) {\r\n\t\t\t// Get variables\r\n\t\t\tvar breakpoint = breakpointSelectors[ i ][ 0 ];\r\n\t\t\tvar values = breakpointSelectors[ i ][ 1 ];\r\n\r\n\t\t\t// Check whether window width is within the breakpoint max width bounds,\r\n\t\t\t// that is, exclude breakpoints which are min width is larger than the\r\n\t\t\t// actual window width.\r\n\t\t\tif ( values.minWidth <= windowWidth ) {\r\n\t\t\t\t// Add breakpoint to the current breakpoints\r\n\t\t\t\tcurrentBreakpoints.push( breakpoint );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Return list with the current breakpoint and smaller breakpoints\r\n\t\treturn currentBreakpoints;\r\n\t}\r\n\r\n\t/**\r\n\t * Check if the current breakpoint matches the specified breakpoint or is smaller than the target breakpoint.\r\n\t * \r\n\t * @param   string   targetBreakpoint  The breakpoint to check against. Accepted values are: `mobile`, `phablet`, `tablet`, `desktop`, `desktopMedium`, `desktopLarge` and `desktopExtraLarge`.\r\n\t */\r\n\t_publicMethods.isCurrentBreakpointOrSmaller = function( targetBreakpoint ) {\r\n\t\t// Get variables\r\n\t\tvar currentBreakpoints = _publicMethods.getCurrentBreakpoints();\r\n\t\tvar targetBreakpointIndex = currentBreakpoints.indexOf( targetBreakpoint );\r\n\t\tvar higherstBreakpointIndex = currentBreakpoints.length - 1;\r\n\r\n\t\t// Return `true` if highest breakpoint matches the target breakpoint\r\n\t\tif ( targetBreakpointIndex == higherstBreakpointIndex ) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t// Iterate through current breakpoints\r\n\t\tfor ( var i = 0; i < currentBreakpoints.length; i++ ) {\r\n\t\t\t// Check whether higherst breakpoint is higher than target\r\n\t\t\t// If so, return `false`.\r\n\t\t\tif ( -1 !== targetBreakpointIndex && i > targetBreakpointIndex ) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Otherwise it is smaller, then return `true`.\r\n\t\treturn true;\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Gets keyboard-focusable elements within a specified element\r\n\t *\r\n\t * @param   HTMLElement  element  The element to search within. Defaults to the `document` root element.\r\n\t *\r\n\t * @return  NodeList              All focusable elements withing the element passed in.\r\n\t */\r\n\t_publicMethods.getFocusableElements = function( element ) {\r\n\t\t// Set element to `document` root if not passed in\r\n\t\tif ( ! element ) { element = document; }\r\n\r\n\t\t// Get elements that are keyboard-focusable, but might be `disabled`\r\n\t\treturn element.querySelectorAll( _settings.focusableElementsSelector );\r\n\t}\r\n\r\n\t/**\r\n\t * Set the variables that track the current focused element and its value.\r\n\t */\r\n\t_publicMethods.setCurrentFocusedElementGlobalVariables = function() {\r\n\t\t// Set current focused element and value\r\n\t\twindow.fcCurrentFocusedElement = getCurrentFocusedElementGlobalVariables();\r\n\t\twindow.fcCurrentFocusedElementValue = window.fcCurrentFocusedElement.value;\r\n\t\twindow.fcCurrentFocusedElementReopenDropdown = false;\r\n\r\n\t\t// Maybe set to reopen dropdown after refocusing\r\n\t\t// Maybe close TomSelect dropdown when refocusing\r\n\t\tif ( fcCurrentFocusedElement.id.includes( '-ts-control' ) ) {\r\n\t\t\t// Get related select field\r\n\t\t\tvar formRow = fcCurrentFocusedElement.closest( _settings.tomSelectFormRowSelector );\r\n\t\t\tvar selectField = formRow && formRow.querySelector( 'select' );\r\n\r\n\t\t\t// Maybe set to reopen dropdown after refocusing\r\n\t\t\tif ( selectField && selectField.tomselect && selectField.tomselect.isOpen ) {\r\n\t\t\t\twindow.fcCurrentFocusedElementReopenDropdown = true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Set the variables that track the current focused element and its value.\r\n\t */\r\n\t_publicMethods.maybeSetCurrentFocusedElementGlobalVariablesRelativeSelect2 = function() {\r\n\t\t// Set current focused element and value,\r\n\t\t// and retrieve relative `select2` field element if focus is on a `select2` field option.\r\n\t\tvar currentFocusedSelect2Element = getCurrentFocusedElementGlobalVariables( true );\r\n\r\n\t\t// Maybe set current focused element to relative `select2` field element\r\n\t\tif ( currentFocusedSelect2Element ) {\r\n\t\t\twindow.fcCurrentFocusedElement = currentFocusedSelect2Element;\r\n\t\t\twindow.fcCurrentFocusedElementValue = window.fcCurrentFocusedElement.value;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Unset the variables that track the current focused element and its value.\r\n\t */\r\n\t_publicMethods.unsetCurrentFocusedElementGlobalVariables = function() {\r\n\t\twindow.fcCurrentFocusedElement = null;\r\n\t\twindow.fcCurrentFocusedElementValue = null;\r\n\t}\r\n\r\n\t/**\r\n\t * Maybe set focus back to the element that was focused before an update.\r\n\t * \r\n\t * @param  {HTMLElement}  currentFocusedElement  The element that was currently focused before an update.\r\n\t * @param  {mixed}        currentValue           The value of the element in focus before an update.\r\n\t */\r\n\t_publicMethods.maybeRefocusElement = function( currentFocusedElement, currentValue ) {\r\n\t\t// Bail if no element to focus\r\n\t\tif ( null == currentFocusedElement ) { return; }\r\n\r\n\t\t// Bail if focus is set to the document body\r\n\t\tif ( document.body === currentFocusedElement ) { return; }\r\n\r\n\t\trequestAnimationFrame( function() {\r\n\t\t\tvar elementToFocus;\r\n\r\n\t\t\t// Try findind the `select2` focusable element\r\n\t\t\tif ( currentFocusedElement.closest( _settings.select2FormRowSelector ) ) {\r\n\t\t\t\tvar formRow = currentFocusedElement.closest( _settings.select2FormRowSelector );\r\n\t\t\t\telementToFocus = formRow.querySelector( _settings.select2FocusElementSelector );\r\n\t\t\t}\r\n\t\t\t// Try findind the updated element by id\r\n\t\t\telse if ( currentFocusedElement.id ) {\r\n\t\t\t\telementToFocus = document.getElementById( currentFocusedElement.id );\r\n\t\t\t}\r\n\t\t\t// Try findind the updated element by name attribute\r\n\t\t\telse if ( currentFocusedElement.getAttribute( 'name' ) ) {\r\n\t\t\t\tvar nameAttr = currentFocusedElement.getAttribute( 'name' );\r\n\t\t\t\telementToFocus = document.querySelector( '[name=\"'+nameAttr+'\"]' );\r\n\t\t\t}\r\n\r\n\t\t\t// Try setting focus if element is found\r\n\t\t\tif ( elementToFocus ) {\r\n\t\t\t\t// Get related select field\r\n\t\t\t\tvar formRow = elementToFocus.closest( _settings.tomSelectFormRowSelector );\r\n\t\t\t\tvar selectField = formRow && formRow.querySelector( 'select' );\r\n\r\n\t\t\t\t// Maybe set class for keeping dropdown closed\r\n\t\t\t\tif ( ! window.fcCurrentFocusedElementReopenDropdown && formRow ) {\r\n\t\t\t\t\tformRow.classList.add( _settings.tomSelectKeepingClosedClass );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Set focus to element\r\n\t\t\t\telementToFocus.focus();\r\n\r\n\t\t\t\t// Try to set current value to the focused element\r\n\t\t\t\tif ( undefined !== currentValue && null !== currentValue && currentValue !== elementToFocus.value ) {\r\n\t\t\t\t\telementToFocus.value = currentValue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Set keyboard track position back to that previously to update\r\n\t\t\t\tsetTimeout( function(){\r\n\t\t\t\t\t// Try to set the same track position\r\n\t\t\t\t\tif ( null !== elementToFocus.selectionStart && null !== elementToFocus.selectionEnd ) {\r\n\t\t\t\t\t\tif ( currentFocusedElement.selectionStart && currentFocusedElement.selectionEnd ) {\r\n\t\t\t\t\t\t\telementToFocus.selectionStart = currentFocusedElement.selectionStart;\r\n\t\t\t\t\t\t\telementToFocus.selectionEnd = currentFocusedElement.selectionEnd;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Otherwise try set the track position to the end of the field\r\n\t\t\t\t\t\t// @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/setSelectionRange\r\n\t\t\t\t\t\t// @see https://html.spec.whatwg.org/multipage/input.html#concept-input-apply\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\telementToFocus.selectionStart = elementToFocus.selectionEnd = 999999;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Maybe close TomSelect dropdown when refocusing\r\n\t\t\t\t\tif ( ! window.fcCurrentFocusedElementReopenDropdown && elementToFocus.id.includes( '-ts-control' ) ) {\r\n\t\t\t\t\t\t// Maybe close TomSelect dropdown\r\n\t\t\t\t\t\tif ( selectField && selectField.tomselect ) {\r\n\t\t\t\t\t\t\tselectField.tomselect.close();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Remove TomSelect class for keeping dropdown closed\r\n\t\t\t\t\tif ( formRow ) {\r\n\t\t\t\t\t\tformRow.classList.remove( _settings.tomSelectKeepingClosedClass );\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 0 );\r\n\t\t\t}\r\n\t\t} );\r\n\t};\r\n\r\n\r\n\r\n\t/**\r\n\t * Get the offset position of the element recursively adding the offset position of parent elements until the `stopElement` (or the `body` element).\r\n\t *\r\n\t * @param   HTMLElement  element      Element to get the offset position for.\r\n\t * @param   HTMLElement  stopElement  Parent element where to stop adding the offset position to the total offset top position of the element.\r\n\t *\r\n\t * @return  int                       Offset position of the element until the `stopElement` or the `body` element.\r\n\t */\r\n\t_publicMethods.getOffsetTop = function( element, stopElement ) {\r\n\t\tvar offsetTop = 0;\r\n\r\n\t\twhile( element ) {\r\n\t\t\t// Reached the stopElement\r\n\t\t\tif ( stopElement && stopElement == element ) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\toffsetTop += element.offsetTop;\r\n\t\t\telement = element.offsetParent;\r\n\t\t}\r\n\t\t\r\n\t\treturn offsetTop;\r\n\t}\r\n\r\n\t/**\r\n\t * Get the scroll offset position for the sticky elements.\r\n\t * \r\n\t * @param   string       includeOffsetSelector  (optional) Selector for the elements to include in the offset position. Pass `0` or `false` to skip this parameter.\r\n\t * @param   int          addedOffsetAmount      (optional) Added offset amount to the scroll position.\r\n\t */\r\n\t_publicMethods.getStickyElementsOffset = function( includeOffsetSelector, addedOffsetAmount ) {\r\n\t\tvar stickyElementsOffset = 0;\r\n\r\n\t\t// Maybe add height of the progress bar to scroll position\r\n\t\ttry {\r\n\t\t\tvar offsetItemsList = null !== includeOffsetSelector && undefined !== includeOffsetSelector ? document.querySelectorAll( includeOffsetSelector ) : [];\r\n\t\t\tif ( offsetItemsList.length > 0 ) {\r\n\t\t\t\tvar offsetItem = offsetItemsList[ 0 ];\r\n\t\t\t\tvar height = offsetItem.getBoundingClientRect().height;\r\n\t\t\t\tstickyElementsOffset += height;\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch ( error ) {\r\n\t\t\t// Do nothing\r\n\t\t}\r\n\r\n\t\t// Maybe add sticky elements height to scroll position\r\n\t\tif ( window.StickyStates ) {\r\n\t\t\tvar maybeStickyElements = document.querySelectorAll( _settings.scrollOffsetSelector );\r\n\t\t\tif ( maybeStickyElements && maybeStickyElements.length > 0 ) {\r\n\t\t\t\tfor ( var i = 0; i < maybeStickyElements.length; i++ ) {\r\n\t\t\t\t\tvar stickyElement = maybeStickyElements[i];\r\n\t\t\t\t\tif ( StickyStates.isStickyPosition( stickyElement ) ) {\r\n\t\t\t\t\t\tvar height = stickyElement.getBoundingClientRect().height;\r\n\t\t\t\t\t\tstickyElementsOffset += height;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Maybe add arbitrary offset amount\r\n\t\tif ( ! isNaN( addedOffsetAmount ) ) {\r\n\t\t\tstickyElementsOffset += addedOffsetAmount;\r\n\t\t}\r\n\r\n\t\treturn stickyElementsOffset;\r\n\t}\r\n\r\n\t/**\r\n\t * Change scroll position to top of the element after the sticky elements.\r\n\t *\r\n\t * @param   HTMLElement  element                The element of to scroll to.\r\n\t * @param   string       includeOffsetSelector  (optional) Selector for the elements to include in the offset position. Pass `0` or `false` to skip this parameter.\r\n\t * @param   int          addedOffsetAmount      (optional) Added offset amount to the scroll position.\r\n\t */\r\n\t_publicMethods.scrollToElement = function( element, includeOffsetSelector, addedOffsetAmount ) {\r\n\t\t// Bail if step element not provided\r\n\t\tif ( ! element ) { return; }\r\n\r\n\t\t// Get the offset position of the element\r\n\t\tvar stickyElementsOffset = _publicMethods.getStickyElementsOffset( includeOffsetSelector, addedOffsetAmount );\r\n\t\tvar elementOffset = _publicMethods.getOffsetTop( element ) + ( _settings.scrollOffset * -1 ) + ( stickyElementsOffset * -1 );\r\n\r\n\t\t// Scroll to the element, considering its offset position.\r\n\t\twindow.setTimeout( function() {\r\n\t\t\twindow.scrollTo( {\r\n\t\t\t\ttop: elementOffset,\r\n\t\t\t\tbehavior: _settings.scrollBehavior,\r\n\t\t\t} );\r\n\t\t}, _settings.scrollDelay );\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Expose public APIs.\r\n\t */\r\n\treturn _publicMethods;\r\n\r\n});\r\n"],"names":["root","factory","define","amd","exports","module","FCUtils","global","this","window","getCurrentFocusedElementGlobalVariables","setToRelativeSelect2","currentfocusedElement","document","activeElement","select2Options","closest","_settings","select2ElementId","getAttribute","replace","getElementById","currentFocusedFormRow","querySelector","blur","_publicMethods","mobile","minWidth","maxWidth","phablet","tablet","desktop","desktopMedium","desktopLarge","desktopExtraLarge","keyboardKeys","ESC","ENTER","SPACE","TAB","CAPS","SHIFT","FUNCTION","CONTROL","COMMAND_OR_WINDOWS","ALT","ARROW_LEFT","ARROW_RIGHT","ARROW_UP","ARROW_DOWN","animationEndEvent","whichAnimationEnd","extendObject","extended","deep","i","Object","prototype","toString","call","arguments","length","prop","obj","hasOwnProperty","debounce","func","wait","immediate","timeout","context","args","callNow","clearTimeout","setTimeout","apply","throttle","fn","threshhold","scope","last","deferTimer","now","Date","isElementVisible","element","offsetWidth","offsetHeight","getClientRects","getCurrentBreakpoints","windowWidth","innerWidth","breakpointSelectors","entries","currentBreakpoints","breakpoint","push","isCurrentBreakpointOrSmaller","targetBreakpoint","targetBreakpointIndex","indexOf","higherstBreakpointIndex","getFocusableElements","querySelectorAll","setCurrentFocusedElementGlobalVariables","selectField","fcCurrentFocusedElement","fcCurrentFocusedElementValue","value","fcCurrentFocusedElementReopenDropdown","id","includes","formRow","tomselect","isOpen","maybeSetCurrentFocusedElementGlobalVariablesRelativeSelect2","currentFocusedSelect2Element","unsetCurrentFocusedElementGlobalVariables","maybeRefocusElement","currentFocusedElement","currentValue","body","requestAnimationFrame","elementToFocus","nameAttr","classList","add","focus","undefined","selectionStart","selectionEnd","close","remove","getOffsetTop","stopElement","offsetTop","offsetParent","getStickyElementsOffset","includeOffsetSelector","addedOffsetAmount","stickyElementsOffset","offsetItemsList","getBoundingClientRect","height","error","StickyStates","maybeStickyElements","stickyElement","isStickyPosition","isNaN","scrollToElement","elementOffset","scrollTo","top","behavior"],"mappings":"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"}