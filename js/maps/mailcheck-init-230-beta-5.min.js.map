{"version":3,"file":"../mailcheck-init-230-beta-5.min.js","sources":["mailcheck-init-230-beta-5.js"],"sourcesContent":["/**\r\n * Handles Mailcheck runs on email fields\r\n */\r\n(function (root, factory) {\r\n\tif ( typeof define === 'function' && define.amd ) {\r\n\t\tdefine([], factory(root));\r\n\t} else if ( typeof exports === 'object' ) {\r\n\t\tmodule.exports = factory(root);\r\n\t} else {\r\n\t\troot.MailcheckInit = factory(root);\r\n\t}\r\n})(typeof global !== 'undefined' ? global : this.window || this.global, function (root) {\r\n\r\n\t'use strict';\r\n\r\n\tvar $ = jQuery;\r\n\r\n\tvar _hasInitialized = false;\r\n\tvar _publicMethods = { }\r\n\tvar _settings = {\r\n\t\tmailFieldSelector: '[data-mailcheck]',\r\n\t\tmailFieldSuggestedClass: 'has-email-suggestion',\r\n\t\tformFieldWrapperSelector: '.form-row',\r\n\t\tsuggestionElementSelector: '[data-mailcheck-suggestion]',\r\n\t\tsuggestionApplySelector: '[data-mailcheck-apply]',\r\n\t\tsuggestionValueAttr: 'data-suggestion-value',\r\n\t\tsuggestedElementTemplate: '<div class=\"fc-mailcheck-suggestion\" data-mailcheck-suggestion>Did you mean <a class=\"mailcheck-suggestion\" href=\"#apply-suggestion\" data-mailcheck-apply data-suggestion-value=\"{suggestion-value}\">{suggestion}</a>?</div>',\r\n\t\tsuggestionTemplate: '{address}@<span class=\"mailcheck-suggestion-domain\">{domain}</span>',\r\n\t}\r\n\tvar _key = {\r\n\t\tENTER: 'Enter',\r\n\t\tSPACE: ' ',\r\n\t}\r\n\tvar _tempTarget = null;\r\n\r\n\r\n\r\n\t/**\r\n\t * METHODS\r\n\t */\r\n\r\n\r\n\r\n\t/*!\r\n\t* Merge two or more objects together.\r\n\t* (c) 2017 Chris Ferdinandi, MIT License, https://gomakethings.com\r\n\t* @param   {Boolean}  deep     If true, do a deep (or recursive) merge [optional]\r\n\t* @param   {Object}   objects  The objects to merge together\r\n\t* @returns {Object}            Merged values of defaults and options\r\n\t*/\r\n\tvar extend = function () {\r\n\t\t// Variables\r\n\t\tvar extended = {};\r\n\t\tvar deep = false;\r\n\t\tvar i = 0;\r\n\r\n\t\t// Check if a deep merge\r\n\t\tif ( Object.prototype.toString.call( arguments[0] ) === '[object Boolean]' ) {\r\n\t\t\tdeep = arguments[0];\r\n\t\t\ti++;\r\n\t\t}\r\n\r\n\t\t// Merge the object into the extended object\r\n\t\tvar merge = function (obj) {\r\n\t\t\tfor (var prop in obj) {\r\n\t\t\t\tif (obj.hasOwnProperty(prop)) {\r\n\t\t\t\t\t// If property is an object, merge properties\r\n\t\t\t\t\tif (deep && Object.prototype.toString.call(obj[prop]) === '[object Object]') {\r\n\t\t\t\t\t\textended[prop] = extend(extended[prop], obj[prop]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\textended[prop] = obj[prop];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// Loop through each object and conduct a merge\r\n\t\tfor (; i < arguments.length; i++) {\r\n\t\t\tvar obj = arguments[i];\r\n\t\t\tmerge(obj);\r\n\t\t}\r\n\r\n\t\treturn extended;\r\n    };\r\n\r\n\r\n\r\n\t/**\r\n\t * Remove Mailcheck suggestions elements\r\n\t */\r\n\tvar removeSuggestions = function() {\r\n\t\tif ( _tempTarget === null ) return;\r\n\t\t\r\n\t\tvar parent = _tempTarget.parentNode;\r\n\t\tvar suggestions = parent.querySelectorAll( _settings.suggestionElementSelector );\r\n\t\t\r\n\t\tfor ( var i = 0; i < suggestions.length; i++ ) {\r\n\t\t\tsuggestions[i].parentNode.removeChild( suggestions[i] );\r\n\t\t}\r\n\r\n\t\t_tempTarget.classList.remove( _settings.mailFieldSuggestedClass );\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Add Mailcheck suggestions elements\r\n\t */\r\n\tvar handleSuggested = function( suggestion ) {\r\n\t\tremoveSuggestions();\r\n\r\n\t\tif ( _tempTarget === null ) return;\r\n\r\n\t\tvar suggestionHtml = _settings.suggestionTemplate.replaceAll( '{address}', suggestion.address ).replaceAll( '{domain}', suggestion.domain );\r\n\t\tvar suggestedElementHtml = _settings.suggestedElementTemplate.replaceAll( '{suggestion}', suggestionHtml ).replaceAll( '{suggestion-value}', suggestion.full );\r\n\r\n\t\t// Create suggestion element and add it after the field\r\n\t\tvar parent = _tempTarget.parentNode;\r\n\t\tvar element = document.createElement( 'div' );\r\n\t\telement.innerHTML = suggestedElementHtml;\r\n\t\tparent.insertBefore( element.firstChild, _tempTarget.nextSibling );\r\n\t\telement = null;\r\n\r\n\t\t_tempTarget.classList.add( _settings.mailFieldSuggestedClass );\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Apply an email suggestion value to the email field\r\n\t */\r\n\tvar applySuggestion = function( suggestionElement ){\r\n\t\t// Bail if there are no suggestions\r\n\t\tif ( suggestionElement === null ) return;\r\n\r\n\t\tvar parentFormRow = suggestionElement.closest( _settings.formFieldWrapperSelector );\r\n\t\t\r\n\t\t// Bail if parent form row not found\r\n\t\tif ( parentFormRow === null ) return;\r\n\r\n\t\tvar targetField = parentFormRow.querySelector( _settings.mailFieldSelector )\r\n\r\n\t\t// Bail if target field not found\r\n\t\tif ( targetField === null ) return;\r\n\r\n\t\t// Apply suggested value\r\n\t\ttargetField.value = suggestionElement.getAttribute( _settings.suggestionValueAttr );\r\n\t\t\r\n\t\t// Remove suggestion message\r\n\t\t_tempTarget = targetField;\r\n\t\tremoveSuggestions();\r\n\t\t_tempTarget = null;\r\n\r\n\t\t// Refocus on the target field\r\n\t\ttargetField.focus();\r\n\r\n\t\t// Revalidate the field\r\n\t\tif ( window.CheckoutValidation ) {\r\n\t\t\tCheckoutValidation.validateField( targetField );\r\n\t\t}\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Handle captured keyup event and route to appropriate function.\r\n\t * @param  {Event} e Event data.\r\n\t */\r\n\tvar handleTriggerEvents = function( e ) {\r\n\t\tif ( Mailcheck !== undefined && e.target.matches( _settings.mailFieldSelector ) ) {\r\n\t\t\t_tempTarget = e.target;\r\n\r\n\t\t\tMailcheck.run( {\r\n\t\t\t\temail: _tempTarget.value,\r\n\t\t\t\tsuggested: handleSuggested,\r\n\t\t\t\tempty: removeSuggestions\r\n\t\t\t} );\r\n\r\n\t\t\t_tempTarget = null;\r\n\t\t}\r\n\t};\r\n\r\n\r\n\r\n\t/**\r\n\t * Handle document clicks and route to the appropriate function.\r\n\t */\r\n\tvar handleClick = function( e ) {\r\n\t\tif ( e.target.closest( _settings.suggestionApplySelector ) ) {\r\n\t\t\te.preventDefault();\r\n\t\t\tapplySuggestion( e.target.closest( _settings.suggestionApplySelector ) );\r\n\t\t}\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Handle keypress event.\r\n\t */\r\n\tvar handleKeyDown = function( e ) {\r\n\t\t// Should do nothing if the default action has been cancelled\r\n\t\tif ( e.defaultPrevented ) { return; }\r\n\r\n\t\t// ENTER or SPACE on apply-suggestion element\r\n\t\tif ( ( e.key == _key.ENTER || e.key == _key.SPACE ) && e.target.closest( _settings.suggestionApplySelector ) ) {\r\n\t\t\t// Simulate click\r\n\t\t\thandleClick( e );\r\n\t\t}\r\n\t};\r\n\r\n\r\n\r\n\t/**\r\n\t * Initialize Mailcheck feature\r\n\t */\r\n\t_publicMethods.init = function( options ) {\r\n\t\tif ( _hasInitialized ) return;\r\n\r\n\t\t// Merge settings\r\n\t\t_settings = extend( true, _settings, options );\r\n\r\n\t\t// Add event listeners\r\n\t\twindow.addEventListener( 'keyup', handleTriggerEvents, true );\r\n\t\twindow.addEventListener( 'click', handleClick, true );\r\n\t\tdocument.addEventListener( 'keydown', handleKeyDown, true );\r\n\r\n\t\t_hasInitialized = true;\r\n\t};\r\n\r\n\t\r\n\t//\r\n\t// Public APIs\r\n\t//\r\n\treturn _publicMethods;\r\n\r\n});\r\n"],"names":["root","factory","define","amd","exports","module","MailcheckInit","global","this","window","jQuery","extend","extended","deep","i","Object","prototype","toString","call","arguments","length","prop","obj","hasOwnProperty","handleSuggested","suggestion","suggestedElementHtml","element","removeSuggestions","_tempTarget","suggestionHtml","_settings","suggestionTemplate","replaceAll","address","domain","suggestedElementTemplate","full","parent","parentNode","document","createElement","innerHTML","insertBefore","firstChild","nextSibling","classList","add","mailFieldSuggestedClass","handleTriggerEvents","e","undefined","Mailcheck","target","matches","mailFieldSelector","run","email","value","suggested","empty","handleClick","targetField","closest","suggestionApplySelector","preventDefault","suggestionElement","parentFormRow","formFieldWrapperSelector","querySelector","getAttribute","suggestionValueAttr","focus","CheckoutValidation","validateField","handleKeyDown","defaultPrevented","key","_key","_hasInitialized","_publicMethods","suggestionElementSelector","suggestions","querySelectorAll","removeChild","remove","init","options","addEventListener"],"mappings":"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"}