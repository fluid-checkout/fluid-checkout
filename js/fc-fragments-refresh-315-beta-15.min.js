!function(e,t){"function"==typeof define&&define.amd?define([],t()):"object"==typeof exports?module.exports=t():e.FCFragmentsRefresh=t()}("undefined"!=typeof global?global:this.window||this.global,function(e){"use strict";function t(e,t){for(var o=document.querySelectorAll(u.sectionSelector),s=0;s<o.length;s++){var n=o[s],a=n.querySelector(u.sectionVisibleStateFieldSelector);a&&"no"===a.value?n.setAttribute(u.sectionVisibleStateAttribute,a.value):n.removeAttribute(u.sectionVisibleStateAttribute)}}function o(){window.FCEnhancedSelect&&FCEnhancedSelect.enhanceFields()}function s(e){e.target&&e.target.matches(u.loadingInputSelector)&&(e=e.target.closest(u.formRowSelector))&&e.classList.add(u.loadingClass)}function n(e){s(e),e.target.matches(u.updateFieldsSelector)&&r()}function a(e){e.defaultPrevented||FCUtils.keyboardKeys.ESC!==e.key&&FCUtils.keyboardKeys.ENTER!==e.key&&FCUtils.keyboardKeys.TAB!==e.key&&FCUtils.keyboardKeys.CAPS!==e.key&&FCUtils.keyboardKeys.SHIFT!==e.key&&FCUtils.keyboardKeys.FUNCTION!==e.key&&FCUtils.keyboardKeys.CONTROL!==e.key&&FCUtils.keyboardKeys.COMMAND_OR_WINDOWS!==e.key&&FCUtils.keyboardKeys.ALT!==e.key&&FCUtils.keyboardKeys.ARROW_LEFT!==e.key&&FCUtils.keyboardKeys.ARROW_RIGHT!==e.key&&FCUtils.keyboardKeys.ARROW_UP!==e.key&&FCUtils.keyboardKeys.ARROW_DOWN!==e.key&&(s(e),e.target.matches(u.updateFieldsSelector))&&r()}var r,l=jQuery,i=null!=l,c=!1,d={},u={bodyClass:"has-fc-fragments-refresh",dataFormSelector:"div.woocommerce form",sectionSelector:".fc-section",messagesWrapperSelector:".woocommerce-notices-wrapper",formRowSelector:".form-row",updateFieldsSelector:".update_totals_on_change input.input-text, .update_totals_on_change select",loadingInputSelector:".loading_indicator_on_change input.input-text",sectionVisibleStateFieldSelector:'.fc-section-visible-state[type="hidden"]',sectionVisibleStateAttribute:"data-section-visible",loadingClass:"fc-loading",uiProcessingClass:"processing",updateFragmentsNonce:"",updateWaitTime:500},f=!1,y={};d.updateFragments=function(){f&&f.abort();var e=FCUtils.extendObject(void 0,{security:u.updateFragmentsNonce,post_data:l(u.dataFormSelector).serialize()});f=l.ajax({type:"POST",url:fcSettings.wcAjaxUrl.toString().replace("%%endpoint%%","fc_update_fragments"),data:e,success:function(e){if(e&&!0===e.reload)window.location.reload();else{FCUtils.setCurrentFocusedElementGlobalVariables(),e&&e.fragments&&(l.each(e.fragments,function(e,t){document.querySelector(e);var o=!0;!(o=t&&-1!==t.toString().indexOf("fc-fragment-always-replace")?!0:o)||y&&y[e]===t||(fcSettings.debugMode&&console.log("Replacing fragment: "+e),l(e).replaceWith(t)),l(e).unblock()}),y=e.fragments),FCUtils.maybeRefocusElement(window.fcCurrentFocusedElement,window.fcCurrentFocusedElementValue);for(var t=document.querySelectorAll(u.loadingInputSelector),o=0;o<t.length;o++){var s=t[o].closest(u.formRowSelector);s&&s.classList.remove(u.loadingClass)}e=document.querySelector(u.messagesWrapperSelector);e&&0<e.children.length&&window.FCUtils&&"function"==typeof FCUtils.scrollToElement&&FCUtils.scrollToElement(e),l(document.body).trigger("fc_fragments_refreshed")}}})},d.blockUI=function(e){l(e).addClass(u.uiProcessingClass).block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},d.unblockUI=function(e){l(e).removeClass(u.uiProcessingClass).unblock()};return d.init=function(e){c||(u=FCUtils.extendObject(u,e),r=FCUtils.debounce(d.updateFragments,u.updateWaitTime),i&&(l(document.body).on("fc_fragment_refresh",r),l(document.body).on("fc_fragments_refreshed",t),l(document.body).on("fc_fragments_refreshed",o)),window.addEventListener("change",n),document.addEventListener("keydown",a,!0),document.body.classList.add(u.bodyClass),c=!0)},d});
//# sourceMappingURL=maps/fc-fragments-refresh-315-beta-15.min.js.map
